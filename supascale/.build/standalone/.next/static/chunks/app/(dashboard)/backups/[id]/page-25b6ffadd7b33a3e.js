(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[568],{35626:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},41905:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>B});var t=a(95155),r=a(12115),c=a(20063),n=a(86948),i=a(3998),l=a(11647),d=a(18653),o=a(1275);a(44070),a(77802),a(19679),a(64858);var u=a(4478);a(20288),a(82844);var m=a(1375),x=a(85710),h=a(20523),j=a(28150),f=a(15870),p=a(35626),g=a(39867),N=a(48314),b=a(71360),y=a(61362),v=a(78874),k=a(26983),w=a(99708),A=a(32320),E=a(52619),C=a.n(E),z=a(64269);let S={full:{label:"Full Backup",icon:m.A,color:"text-brand",description:"Complete backup including database, storage, functions, and config"},database:{label:"Database",icon:x.A,color:"text-success",description:"PostgreSQL database dump"},storage:{label:"Storage",icon:h.A,color:"text-info",description:"All files in Supabase Storage buckets"},functions:{label:"Functions",icon:j.A,color:"text-warning",description:"Edge Functions source code"},config:{label:"Config",icon:f.A,color:"text-foreground-muted",description:"Environment and Docker configuration files"}};function B(e){let{params:s}=e,a=(0,c.useRouter)(),m=(0,o.d)(),[x,h]=(0,r.useState)(null),[j,f]=(0,r.useState)(!0),[E,B]=(0,r.useState)(!1),[F,D]=(0,r.useState)(!1);(0,r.useEffect)(()=>{!async function(){try{let{id:e}=await s,t=await fetch("/api/v1/backups/".concat(e)),r=await t.json();if(!r.success){m.error("Error",r.error||"Failed to fetch backup"),a.push("/backups");return}h(r.data)}catch(e){m.error("Error","Failed to fetch backup details"),a.push("/backups")}finally{f(!1)}}()},[s,a,m]);let R=async()=>{if(x&&confirm("Are you sure you want to delete this backup? This action cannot be undone.")){B(!0);try{let e=await fetch("/api/v1/backups/".concat(x.id),{method:"DELETE"}),s=await e.json();if(!s.success)throw Error(s.error||"Failed to delete backup");m.success("Backup deleted","Backup has been deleted successfully"),a.push("/backups")}catch(s){let e=s instanceof Error?s.message:"Failed to delete backup";m.error("Error",e)}finally{B(!1)}}};if(j)return(0,t.jsx)("div",{className:"flex items-center justify-center py-24",children:(0,t.jsx)(d.y,{size:"lg"})});if(!x)return null;let T=S[x.type],Z=T.icon;return(0,t.jsxs)("div",{className:"space-y-6 px-4 sm:px-6 lg:px-8 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(C(),{href:"/backups",children:(0,t.jsxs)(i.Button,{variant:"ghost",size:"sm",children:[(0,t.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Back"]})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Backup Details"}),(0,t.jsx)("p",{className:"text-foreground-muted",children:x.filename})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["completed"===x.status&&(0,t.jsxs)(t.Fragment,{children:["local"===x.destination&&(0,t.jsxs)(i.Button,{variant:"outline",onClick:()=>{x&&window.open("/api/v1/backups/".concat(x.id,"/download"),"_blank")},children:[(0,t.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Download"]}),(0,t.jsxs)(i.Button,{onClick:()=>D(!0),children:[(0,t.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Restore"]})]}),(0,t.jsxs)(i.Button,{variant:"destructive",onClick:R,disabled:E,children:[E?(0,t.jsx)(d.y,{size:"sm",className:"mr-2"}):(0,t.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),(0,t.jsx)(n.Zp,{children:(0,t.jsxs)(n.Wu,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"h-14 w-14 rounded-lg flex items-center justify-center ".concat("completed"===x.status?"bg-success/10":"failed"===x.status?"bg-error/10":"bg-background-tertiary"),children:"completed"===x.status?(0,t.jsx)(y.A,{className:"h-7 w-7 text-success"}):"failed"===x.status?(0,t.jsx)(v.A,{className:"h-7 w-7 text-error"}):"running"===x.status?(0,t.jsx)(d.y,{size:"md"}):(0,t.jsx)(k.A,{className:"h-7 w-7 text-foreground-muted"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.E,{variant:"completed"===x.status?"success":"failed"===x.status?"error":"running"===x.status?"info":"secondary",children:x.status.charAt(0).toUpperCase()+x.status.slice(1)}),x.encrypted&&(0,t.jsxs)(l.E,{variant:"secondary",children:[(0,t.jsx)(w.A,{className:"h-3 w-3 mr-1"}),"Encrypted"]}),"local"!==x.destination&&(0,t.jsxs)(l.E,{variant:"secondary",children:[(0,t.jsx)(A.A,{className:"h-3 w-3 mr-1"}),"Cloud"]})]}),(0,t.jsxs)("p",{className:"text-sm text-foreground-muted mt-1",children:["Created ",(0,z.mo)(x.createdAt),x.duration&&(0,t.jsxs)(t.Fragment,{children:[" • Took ",Math.round(x.duration/1e3),"s"]})]})]})]}),"failed"===x.status&&x.errorMessage&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-error/10 border border-error/20 rounded-lg text-sm text-error",children:x.errorMessage})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(Z,{className:"h-5 w-5 ".concat(T.color)}),T.label]}),(0,t.jsx)(n.BT,{children:T.description})]}),(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Project"}),(0,t.jsx)("span",{className:"font-medium",children:x.projectName||"Unknown"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Size"}),(0,t.jsx)("span",{className:"font-medium",children:(0,z.z3)(x.size)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Created"}),(0,t.jsx)("span",{className:"font-medium",children:(0,z.Yq)(x.createdAt)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Destination"}),(0,t.jsx)("span",{className:"font-medium",children:"local"===x.destination?"Local Filesystem":"Cloud Storage"})]}),x.checksum&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Checksum"}),(0,t.jsxs)("span",{className:"font-mono text-xs",children:[x.checksum.slice(0,16),"..."]})]})]})]}),x.metadata&&(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{children:"Backup Contents"}),(0,t.jsx)(n.BT,{children:"What's included in this backup"})]}),(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[x.metadata.components&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:x.metadata.components.map(e=>{let s=S[e],a=s.icon;return(0,t.jsxs)(l.E,{variant:"secondary",children:[(0,t.jsx)(a,{className:"h-3 w-3 mr-1"}),s.label]},e)})}),void 0!==x.metadata.databaseSize&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Database Size"}),(0,t.jsx)("span",{className:"font-medium",children:(0,z.z3)(x.metadata.databaseSize)})]}),void 0!==x.metadata.storageSize&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Storage Size"}),(0,t.jsx)("span",{className:"font-medium",children:(0,z.z3)(x.metadata.storageSize)})]}),void 0!==x.metadata.functionsCount&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Functions"}),(0,t.jsxs)("span",{className:"font-medium",children:[x.metadata.functionsCount," functions"]})]}),x.metadata.configFiles&&x.metadata.configFiles.length>0&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-foreground-muted",children:"Config Files"}),(0,t.jsxs)("span",{className:"font-medium",children:[x.metadata.configFiles.length," files"]})]})]})]})]}),x.restoreHistory&&x.restoreHistory.length>0&&(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{children:[(0,t.jsx)(n.ZB,{children:"Restore History"}),(0,t.jsx)(n.BT,{children:"Previous restores from this backup"})]}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)("div",{className:"space-y-3",children:x.restoreHistory.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-background-tertiary rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-8 w-8 rounded flex items-center justify-center ".concat("completed"===e.status?"bg-success/10":"failed"===e.status?"bg-error/10":"bg-background"),children:"completed"===e.status?(0,t.jsx)(y.A,{className:"h-4 w-4 text-success"}):"failed"===e.status?(0,t.jsx)(v.A,{className:"h-4 w-4 text-error"}):(0,t.jsx)(d.y,{size:"sm"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium text-sm",children:["Restored ",e.restoreTypes.join(", ")]}),(0,t.jsxs)("p",{className:"text-xs text-foreground-muted",children:[(0,z.mo)(e.startedAt),e.duration&&(0,t.jsxs)(t.Fragment,{children:[" • ",Math.round(e.duration/1e3),"s"]})]})]})]}),(0,t.jsx)(l.E,{variant:"completed"===e.status?"success":"failed"===e.status?"error":"info",children:e.status})]},e.id))})})]}),x&&(0,t.jsx)(u.RestoreDialog,{backup:x,open:F,onClose:()=>D(!1),onRestoreComplete:()=>{a.refresh()}})]})}},55238:(e,s,a)=>{Promise.resolve().then(a.bind(a,41905))}},e=>{e.O(0,[2903,2619,6780,8441,1255,7358],()=>e(e.s=55238)),_N_E=e.O()}]);