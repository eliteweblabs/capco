"use strict";exports.id=8150,exports.ids=[8150],exports.modules={1420:(a,b,c)=>{c.d(b,{d:()=>g});var d=c(21124),e=c(38301),f=c(44943);let g=(0,e.forwardRef)(({className:a,checked:b,onCheckedChange:c,onChange:e,...g},h)=>(0,d.jsxs)("label",{className:(0,f.cn)("relative inline-flex cursor-pointer items-center",a),children:[(0,d.jsx)("input",{type:"checkbox",role:"switch",className:"peer sr-only",ref:h,checked:b,onChange:a=>{e?.(a),c?.(a.target.checked)},...g}),(0,d.jsx)("div",{className:(0,f.cn)("h-6 w-11 rounded-full transition-colors","bg-background-tertiary border border-border","peer-checked:bg-brand peer-checked:border-brand","peer-focus-visible:ring-2 peer-focus-visible:ring-brand peer-focus-visible:ring-offset-2","peer-disabled:cursor-not-allowed peer-disabled:opacity-50","after:absolute after:left-[2px] after:top-[2px]","after:h-5 after:w-5 after:rounded-full","after:bg-white after:shadow-sm","after:transition-transform","peer-checked:after:translate-x-5")})]}));g.displayName="Switch"},5443:(a,b,c)=>{c.d(b,{DestinationDisplay:()=>m,DestinationSelector:()=>l});var d=c(21124),e=c(38301),f=c(84220),g=c(65828),h=c(11082),i=c(66041),j=c(14263);let k={s3:f.A,gcs:g.A,azure:h.A,local:i.A,r2:f.A,minio:h.A,backblaze:f.A};function l({value:a,onChange:b,disabled:c}){let[f,g]=(0,e.useState)([]),[h,i]=(0,e.useState)(!0);return h?(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Destination"}),(0,d.jsxs)("div",{className:"flex items-center gap-2 text-foreground-muted",children:[(0,d.jsx)(j.A,{className:"h-4 w-4 animate-spin"}),(0,d.jsx)("span",{className:"text-sm",children:"Loading storage providers..."})]})]}):(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Destination"}),(0,d.jsxs)("select",{value:a,onChange:a=>b(a.target.value),disabled:c,className:"w-full h-10 px-3 border border-border rounded-lg bg-background text-sm focus:outline-none focus:ring-2 focus:ring-brand disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,d.jsx)("option",{value:"local",children:"Local Filesystem (Default)"}),f.map(a=>(0,d.jsxs)("option",{value:a.id,children:[a.name," (",a.type.toUpperCase(),")",a.isDefault&&" - Default"]},a.id))]}),(0,d.jsx)("p",{className:"text-xs text-foreground-muted",children:"local"===a?"Backups will be stored on the local filesystem":f.find(b=>b.id===a)?`Backups will be uploaded to ${f.find(b=>b.id===a)?.name}`:"Select a storage destination"})]})}function m({destination:a,providers:b=[]}){if("local"===a)return(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(i.A,{className:"h-4 w-4 text-foreground-muted"}),(0,d.jsx)("span",{children:"Local"})]});let c=b.find(b=>b.id===a);if(c){let a=k[c.type];return(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(a,{className:"h-4 w-4 text-foreground-muted"}),(0,d.jsx)("span",{children:c.name})]})}return(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(f.A,{className:"h-4 w-4 text-foreground-muted"}),(0,d.jsx)("span",{children:"Cloud Storage"})]})}},18646:(a,b,c)=>{c.d(b,{RestoreDialog:()=>y});var d=c(21124),e=c(38301),f=c(40068),g=c(35284),h=c(99187),i=c(62145),j=c(39163),k=c(40179),l=c(65828),m=c(66041),n=c(33464),o=c(94684),p=c(59268),q=c(16945),r=c(9212),s=c(91292),t=c(77917),u=c(82042),v=c(85351),w=c(44943);let x={full:{label:"Full Backup",icon:k.A,description:"Restore all components from this backup"},database:{label:"Database",icon:l.A,description:"Restore PostgreSQL database (requires project to be running)"},storage:{label:"Storage",icon:m.A,description:"Restore all storage bucket files"},functions:{label:"Functions",icon:n.A,description:"Restore Edge Functions source code"},config:{label:"Config",icon:o.A,description:"Restore environment and Docker configuration"}};function y({backup:a,open:b,onClose:c,onRestoreComplete:k}){let l=(0,j.d)(),[m,n]=(0,e.useState)(!1),[o,y]=(0,e.useState)([]),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)("select"),[D,E]=(0,e.useState)(null),[F,G]=(0,e.useState)([]),[H,I]=(0,e.useState)([]),[J,K]=(0,e.useState)(!0),L=(0,e.useRef)(null);(0,e.useRef)(null);let M="full"===a.type&&a.metadata?.components?a.metadata.components:[a.type],N=(a,b,c)=>{G(d=>[...d,{timestamp:new Date,type:a,message:b,data:c}])},O=async()=>{C("restoring"),n(!0),G([]),I([]),N("info","Connecting to restore stream...");try{let b=await fetch(`/api/v1/backups/${a.id}/restore/stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({restoreTypes:o,forceRestore:z})});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to start restore")}if(!b.body)throw Error("No response body");let c=b.body.getReader(),d=new TextDecoder,e="";for(;;){let{done:a,value:b}=await c.read();if(a)break;let f=(e+=d.decode(b,{stream:!0})).split("\n");e=f.pop()||"";let g="",h="";for(let a of f)if(a.startsWith("event: "))g=a.slice(7);else if(a.startsWith("data: ")&&(h=a.slice(6),g&&h)){try{let a=JSON.parse(h);P(g,a)}catch(a){console.error("Failed to parse SSE data:",a)}g="",h=""}}}catch(b){let a=b instanceof Error?b.message:"Restore failed";N("error",a),E({success:!1,error:a}),C("complete")}finally{n(!1)}},P=(a,b)=>{switch(a){case"start":case"info":N("info",b.message,b);break;case"command":N("command",b.cmd,b);break;case"output":b.stdout&&N("output",b.stdout),b.stderr&&N("output",b.stderr);break;case"warning":N("warning",b.message,b);break;case"step":I(a=>{let c=a.findIndex(a=>a.step===b.step),d={step:b.step,status:b.status,message:b.message};if(c>=0){let b=[...a];return b[c]=d,b}return[...a,d]}),N("step",`[${b.step}] ${b.message}`,b);break;case"complete":E({success:!0,warnings:b.warnings,duration:b.duration}),C("complete"),N("info",b.message),k?.();break;case"error":E({success:!1,error:b.error,warnings:b.warnings,duration:b.duration}),C("complete"),N("error",b.error)}},Q=()=>{m||(C("select"),y([]),E(null),A(!1),G([]),I([]),c())},R=x[a.type],S=R.icon;return(0,d.jsxs)(f.lG,{open:b,onClose:Q,title:"Restore from Backup",className:"restoring"===B||"complete"===B?"max-w-4xl":"max-w-2xl",children:["select"===B&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-background-tertiary rounded-lg",children:[(0,d.jsx)(S,{className:"h-8 w-8 text-brand flex-shrink-0"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-medium",children:a.filename}),(0,d.jsxs)("p",{className:"text-sm text-foreground-muted",children:[R.label," • ",(0,w.z3)(a.size)]})]})]}),M.length>1&&(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Select Components to Restore"}),(0,d.jsx)(g.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{y([...M])},children:"Select All"})]}),(0,d.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:M.map(a=>{let b=x[a],c=b.icon,e=o.includes(a);return(0,d.jsx)("button",{type:"button",onClick:()=>{o.includes(a)?y(o.filter(b=>b!==a)):y([...o,a])},className:`p-3 border rounded-lg text-left transition-colors ${e?"border-brand bg-brand/10":"border-border hover:border-brand/50"}`,children:(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(c,{className:`h-5 w-5 ${e?"text-brand":"text-foreground-muted"}`}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"font-medium text-sm",children:b.label}),(0,d.jsx)("p",{className:"text-xs text-foreground-muted",children:b.description})]}),e&&(0,d.jsx)(p.A,{className:"h-4 w-4 text-brand"})]})},a)})})]}),1===M.length&&(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("p",{className:"text-sm text-foreground-muted",children:["This will restore the ",x[a.type].label.toLowerCase()," from this backup."]}),(0,d.jsxs)(g.Button,{type:"button",variant:"outline",onClick:()=>y([a.type]),className:o.length>0?"border-brand bg-brand/10":"",children:[(0,d.jsx)(p.A,{className:`h-4 w-4 mr-2 ${o.length>0?"text-brand":"text-foreground-muted"}`}),o.length>0?"Selected":"Select to Restore"]})]}),(0,d.jsxs)(f.Es,{children:[(0,d.jsx)(g.Button,{type:"button",variant:"outline",onClick:Q,children:"Cancel"}),(0,d.jsx)(g.Button,{type:"button",onClick:()=>{if(0===o.length)return void l.error("Select components","Please select at least one component to restore");C("confirm")},disabled:0===o.length,children:"Continue"})]})]}),"confirm"===B&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)("div",{className:"p-4 bg-warning/10 border border-warning/20 rounded-lg",children:(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)(q.A,{className:"h-5 w-5 text-warning flex-shrink-0 mt-0.5"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-medium text-warning",children:"Warning: This action cannot be undone"}),(0,d.jsx)("p",{className:"text-sm text-foreground-muted mt-1",children:"Restoring will overwrite existing data. Make sure you have a recent backup of current data if needed."})]})]})}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Components to restore:"}),(0,d.jsx)("div",{className:"flex flex-wrap gap-2",children:o.map(a=>{let b=x[a],c=b.icon;return(0,d.jsxs)(h.E,{variant:"secondary",children:[(0,d.jsx)(c,{className:"h-3 w-3 mr-1"}),b.label]},a)})})]}),(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)("input",{type:"checkbox",id:"forceRestore",checked:z,onChange:a=>A(a.target.checked),className:"mt-1"}),(0,d.jsxs)("label",{htmlFor:"forceRestore",className:"text-sm",children:[(0,d.jsx)("span",{className:"font-medium",children:"Force restore"}),(0,d.jsx)("p",{className:"text-foreground-muted",children:"Override safety checks (e.g., restore config while project is running)"})]})]}),(0,d.jsxs)(f.Es,{children:[(0,d.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>C("select"),children:"Back"}),(0,d.jsxs)(g.Button,{type:"button",variant:"destructive",onClick:O,children:[(0,d.jsx)(r.A,{className:"h-4 w-4 mr-2"}),"Restore Now"]})]})]}),"restoring"===B&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{className:"flex items-center gap-2 flex-wrap",children:H.map(a=>(0,d.jsxs)(h.E,{variant:"completed"===a.status?"success":"failed"===a.status?"error":"running"===a.status?"info":"secondary",children:["running"===a.status&&(0,d.jsx)(i.y,{size:"sm",className:"mr-1"}),"completed"===a.status&&(0,d.jsx)(p.A,{className:"h-3 w-3 mr-1"}),"failed"===a.status&&(0,d.jsx)(s.A,{className:"h-3 w-3 mr-1"}),a.step.replace("restore-","").replace("-"," ")]},a.step))}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(t.A,{className:"h-4 w-4 text-foreground-muted"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"Live Output"})]}),(0,d.jsx)(g.Button,{variant:"ghost",size:"sm",onClick:()=>K(!J),children:J?(0,d.jsx)(u.A,{className:"h-4 w-4"}):(0,d.jsx)(v.A,{className:"h-4 w-4"})})]}),J&&(0,d.jsx)("div",{className:"bg-[#1a1a1a] rounded-lg font-mono text-xs max-h-[400px] overflow-auto",children:(0,d.jsxs)("div",{className:"p-4 space-y-1",children:[F.map((a,b)=>(0,d.jsxs)("div",{className:`whitespace-pre-wrap break-all ${"command"===a.type?"text-cyan-400":"error"===a.type?"text-red-400":"warning"===a.type?"text-yellow-400":"step"===a.type?"text-green-400":"text-gray-300"}`,children:["command"===a.type&&(0,d.jsx)("span",{className:"text-gray-500",children:"$ "}),a.message]},b)),m&&(0,d.jsx)("div",{className:"text-yellow-400 animate-pulse",children:"Processing..."}),(0,d.jsx)("div",{ref:L})]})})]}),"complete"===B&&D&&(0,d.jsxs)("div",{className:"space-y-6",children:[D.success?(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center py-4",children:[(0,d.jsx)("div",{className:"h-16 w-16 rounded-full bg-success/10 flex items-center justify-center",children:(0,d.jsx)(p.A,{className:"h-8 w-8 text-success"})}),(0,d.jsx)("p",{className:"mt-4 font-medium text-lg",children:"Restore Complete"}),(0,d.jsxs)("p",{className:"text-sm text-foreground-muted mt-1",children:["The backup has been successfully restored",D.duration&&` in ${(a=>{let b=Math.round(a/1e3);if(b<60)return`${b}s`;let c=Math.floor(b/60);return`${c}m ${b%60}s`})(D.duration)}`,"."]})]}):(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center py-4",children:[(0,d.jsx)("div",{className:"h-16 w-16 rounded-full bg-error/10 flex items-center justify-center",children:(0,d.jsx)(s.A,{className:"h-8 w-8 text-error"})}),(0,d.jsx)("p",{className:"mt-4 font-medium text-lg",children:"Restore Failed"}),(0,d.jsx)("p",{className:"text-sm text-error mt-1",children:D.error})]}),D.warnings&&D.warnings.length>0&&(0,d.jsxs)("div",{className:"p-4 bg-warning/10 border border-warning/20 rounded-lg",children:[(0,d.jsx)("p",{className:"font-medium text-warning mb-2",children:"Warnings:"}),(0,d.jsx)("ul",{className:"text-sm text-foreground-muted space-y-1",children:D.warnings.map((a,b)=>(0,d.jsxs)("li",{children:["• ",a]},b))})]}),F.length>0&&(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Restore Log"}),(0,d.jsxs)(g.Button,{variant:"ghost",size:"sm",onClick:()=>K(!J),children:[J?"Hide":"Show"," Output"]})]}),J&&(0,d.jsx)("div",{className:"bg-[#1a1a1a] rounded-lg font-mono text-xs max-h-[300px] overflow-auto",children:(0,d.jsx)("div",{className:"p-4 space-y-1",children:F.map((a,b)=>(0,d.jsxs)("div",{className:`whitespace-pre-wrap break-all ${"command"===a.type?"text-cyan-400":"error"===a.type?"text-red-400":"warning"===a.type?"text-yellow-400":"step"===a.type?"text-green-400":"text-gray-300"}`,children:["command"===a.type&&(0,d.jsx)("span",{className:"text-gray-500",children:"$ "}),a.message]},b))})})]}),(0,d.jsx)(f.Es,{children:(0,d.jsx)(g.Button,{type:"button",onClick:Q,children:"Close"})})]})]})}},33218:(a,b,c)=>{c.d(b,{BackupTypeSelector:()=>k,getBackupTypeConfig:()=>l});var d=c(21124),e=c(40179),f=c(65828),g=c(66041),h=c(33464),i=c(94684);let j=[{id:"full",label:"Full Backup",description:"Complete backup including database, storage, functions, and config",icon:e.A},{id:"database",label:"Database",description:"PostgreSQL database dump using pg_dump",icon:f.A},{id:"storage",label:"Storage",description:"All files stored in Supabase Storage buckets",icon:g.A},{id:"functions",label:"Functions",description:"Edge Functions source code and configuration",icon:h.A},{id:"config",label:"Config",description:"Environment files and Docker Compose configuration",icon:i.A}];function k({value:a,onChange:b,disabled:c}){return(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Backup Type"}),(0,d.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:j.map(e=>{let f=e.icon,g=a===e.id;return(0,d.jsxs)("button",{type:"button",disabled:c,onClick:()=>b(e.id),className:`p-4 border rounded-lg text-left transition-colors ${g?"border-brand bg-brand/10":"border-border hover:border-brand/50"} ${c?"opacity-50 cursor-not-allowed":""}`,children:[(0,d.jsx)(f,{className:`h-5 w-5 mb-2 ${g?"text-brand":"text-foreground-muted"}`}),(0,d.jsx)("p",{className:"font-medium",children:e.label}),(0,d.jsx)("p",{className:"text-xs text-foreground-muted mt-1",children:e.description})]},e.id)})})]})}function l(a){return j.find(b=>b.id===a)||j[0]}},40068:(a,b,c)=>{c.d(b,{Es:()=>j,lG:()=>i});var d=c(21124),e=c(38301),f=c(47089),g=c(44943),h=c(35284);function i({open:a,onClose:b,children:c,className:i,title:j}){return a?(0,d.jsxs)(e.Fragment,{children:[(0,d.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",onClick:b,"aria-hidden":"true"}),(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,d.jsxs)("div",{className:(0,g.cn)("relative w-full max-w-lg max-h-[90vh] flex flex-col bg-background-secondary rounded-xl shadow-lg border border-border","animate-in fade-in-0 zoom-in-95 duration-200",i),role:"dialog","aria-modal":"true",onClick:a=>a.stopPropagation(),children:[j&&(0,d.jsxs)("div",{className:"flex items-center justify-between p-6 pb-0 flex-shrink-0",children:[(0,d.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:j}),(0,d.jsxs)(h.Button,{variant:"ghost",size:"icon",onClick:b,className:"h-8 w-8 text-foreground-muted hover:text-foreground",children:[(0,d.jsx)(f.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,d.jsx)("div",{className:"p-6 overflow-y-auto flex-1",children:c})]})})]}):null}function j({children:a,className:b}){return(0,d.jsx)("div",{className:(0,g.cn)("flex items-center justify-end gap-3 p-6 pt-0",b),children:a})}},43120:(a,b,c)=>{c.d(b,{BackupHistory:()=>t});var d=c(21124),e=c(38301),f=c(35284),g=c(62145),h=c(39163),i=c(79240),j=c(18646),k=c(40179),l=c(65828),m=c(66041),n=c(33464),o=c(94684),p=c(89023),q=c(25345);let r=[{value:"all",label:"All Types",icon:k.A},{value:"full",label:"Full",icon:k.A},{value:"database",label:"Database",icon:l.A},{value:"storage",label:"Storage",icon:m.A},{value:"functions",label:"Functions",icon:n.A},{value:"config",label:"Config",icon:o.A}],s=[{value:"all",label:"All Status"},{value:"completed",label:"Completed"},{value:"running",label:"Running"},{value:"pending",label:"Pending"},{value:"failed",label:"Failed"}];function t({projectId:a,limit:b=50,showFilters:c=!0,onBackupCreated:l}){let m=(0,h.d)(),[n,o]=(0,e.useState)([]),[t,u]=(0,e.useState)(!0),[v,w]=(0,e.useState)(!1),[x,y]=(0,e.useState)("all"),[z,A]=(0,e.useState)("all"),[B,C]=(0,e.useState)(null),D=(0,e.useCallback)(async(c=!0)=>{c?u(!0):w(!0);try{let c=new URLSearchParams;a&&c.append("projectId",a),"all"!==x&&c.append("type",x),"all"!==z&&c.append("status",z),c.append("limit",b.toString());let d=await fetch(`/api/v1/backups?${c}`),e=await d.json();e.success&&o(e.data||[])}catch(a){console.error("Failed to fetch backups:",a)}finally{u(!1),w(!1)}},[a,x,z,b]),E=async a=>{window.open(`/api/v1/backups/${a}/download`,"_blank")},F=a=>{let b=n.find(b=>b.id===a);b&&C(b)},G=async a=>{try{let b=await fetch(`/api/v1/backups/${a}`,{method:"DELETE"}),c=await b.json();if(!c.success)throw Error(c.error||"Failed to delete backup");m.success("Backup deleted","Backup has been deleted successfully"),D(!1)}catch(b){let a=b instanceof Error?b.message:"Failed to delete backup";m.error("Error",a)}};return t?(0,d.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,d.jsx)(g.y,{size:"lg"})}):(0,d.jsxs)("div",{className:"space-y-4",children:[c&&(0,d.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(p.A,{className:"h-4 w-4 text-foreground-muted"}),(0,d.jsx)("span",{className:"text-sm text-foreground-muted",children:"Filter:"})]}),(0,d.jsx)("select",{value:x,onChange:a=>y(a.target.value),className:"h-8 px-2 text-sm border border-border rounded bg-background focus:outline-none focus:ring-2 focus:ring-brand",children:r.map(a=>(0,d.jsx)("option",{value:a.value,children:a.label},a.value))}),(0,d.jsx)("select",{value:z,onChange:a=>A(a.target.value),className:"h-8 px-2 text-sm border border-border rounded bg-background focus:outline-none focus:ring-2 focus:ring-brand",children:s.map(a=>(0,d.jsx)("option",{value:a.value,children:a.label},a.value))}),(0,d.jsx)("div",{className:"flex-1"}),(0,d.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>{D(!1)},disabled:v,children:v?(0,d.jsx)(g.y,{size:"sm"}):(0,d.jsx)(q.A,{className:"h-4 w-4"})})]}),0===n.length?(0,d.jsxs)("div",{className:"text-center py-12",children:[(0,d.jsx)(k.A,{className:"h-12 w-12 mx-auto text-foreground-muted mb-4"}),(0,d.jsx)("p",{className:"text-foreground-muted",children:"No backups found"}),("all"!==x||"all"!==z)&&(0,d.jsx)("p",{className:"text-sm text-foreground-muted mt-1",children:"Try adjusting your filters"})]}):(0,d.jsx)("div",{className:"space-y-3",children:n.map(a=>(0,d.jsx)(i.BackupCard,{backup:a,onDownload:E,onRestore:F,onDelete:G},a.id))}),B&&(0,d.jsx)(j.RestoreDialog,{backup:B,open:!!B,onClose:()=>C(null),onRestoreComplete:()=>{D(!1),l?.()}})]})}},55392:(a,b,c)=>{c.d(b,{BackupProgressCard:()=>r});var d=c(21124),e=c(38301),f=c(62186),g=c(99187),h=c(62145),i=c(40179),j=c(65828),k=c(66041),l=c(33464),m=c(94684),n=c(9212),o=c(59268),p=c(91292);let q={full:{label:"Full Backup",icon:i.A},database:{label:"Database",icon:j.A},storage:{label:"Storage",icon:k.A},functions:{label:"Functions",icon:l.A},config:{label:"Config",icon:m.A}};function r({backup:a,restoreJob:b,projectName:c,onComplete:j}){let[k,l]=(0,e.useState)(0),m=!!a,r=!!b,s=a?.status==="running"||b?.status==="running",t=a?.status==="completed"||b?.status==="completed",u=a?.status==="failed"||b?.status==="failed",v=a=>{let b=Math.floor(a/60),c=a%60;return b>0?`${b}m ${c}s`:`${c}s`},w=a?q[a.type]:b?{label:"Restore",icon:n.A}:{label:"Unknown",icon:i.A},x=w.icon;return(0,d.jsx)(f.Zp,{className:`border-2 ${s?"border-brand animate-pulse":t?"border-success":u?"border-error":"border-border"}`,children:(0,d.jsxs)(f.Wu,{className:"p-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)("div",{className:`h-12 w-12 rounded-lg flex items-center justify-center ${s?"bg-brand/10":t?"bg-success/10":u?"bg-error/10":"bg-background-tertiary"}`,children:s?(0,d.jsx)(h.y,{size:"md"}):t?(0,d.jsx)(o.A,{className:"h-6 w-6 text-success"}):u?(0,d.jsx)(p.A,{className:"h-6 w-6 text-error"}):(0,d.jsx)(x,{className:"h-6 w-6 text-brand"})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("p",{className:"font-medium truncate",children:m?"Creating Backup":"Restoring Backup"}),(0,d.jsx)(g.E,{variant:s?"info":t?"success":u?"error":"secondary",children:s?"In Progress":t?"Completed":u?"Failed":"Pending"})]}),(0,d.jsxs)("p",{className:"text-sm text-foreground-muted mt-0.5",children:[c&&(0,d.jsxs)(d.Fragment,{children:[c," • "]}),w.label,s&&(0,d.jsxs)(d.Fragment,{children:[" • ",v(k)]}),(t||u)&&a?.duration&&(0,d.jsxs)(d.Fragment,{children:[" • Took ",v(Math.round(a.duration/1e3))]}),(t||u)&&b?.duration&&(0,d.jsxs)(d.Fragment,{children:[" • Took ",v(Math.round(b.duration/1e3))]})]})]}),r&&b?.restoreTypes&&(0,d.jsx)("div",{className:"flex items-center gap-1",children:b.restoreTypes.map(a=>{let b=q[a],c=b.icon;return(0,d.jsx)("div",{className:"h-8 w-8 rounded bg-background-tertiary flex items-center justify-center",title:b.label,children:(0,d.jsx)(c,{className:"h-4 w-4 text-foreground-muted"})},a)})})]}),u&&(a?.errorMessage||b?.errorMessage)&&(0,d.jsx)("div",{className:"mt-3 p-2 bg-error/10 border border-error/20 rounded text-sm text-error",children:a?.errorMessage||b?.errorMessage}),b?.warnings&&b.warnings.length>0&&(0,d.jsxs)("div",{className:"mt-3 p-2 bg-warning/10 border border-warning/20 rounded text-sm text-warning",children:[(0,d.jsx)("p",{className:"font-medium mb-1",children:"Warnings:"}),(0,d.jsx)("ul",{className:"list-disc list-inside",children:b.warnings.map((a,b)=>(0,d.jsx)("li",{children:a},b))})]})]})})}},57284:(a,b,c)=>{c.d(b,{BackupForm:()=>o});var d=c(21124),e=c(38301),f=c(42378),g=c(62186),h=c(35284),i=c(1420),j=c(62145),k=c(39163),l=c(33218),m=c(5443),n=c(40179);function o({project:a,projects:b=[],onSuccess:c}){let o=(0,f.useRouter)(),p=(0,k.d)(),[q,r]=(0,e.useState)(!1),[s,t]=(0,e.useState)(a?.id||b[0]?.id||""),[u,v]=(0,e.useState)("full"),[w,x]=(0,e.useState)("local"),[y,z]=(0,e.useState)(!1),A=a||b.find(a=>a.id===s),B=async a=>{if(a.preventDefault(),!s)return void p.error("Project required","Please select a project to backup");r(!0);try{let a=await fetch("/api/v1/backups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:s,type:u,destination:w,encrypt:y})}),b=await a.json();if(!b.success)throw Error(b.error||"Failed to create backup");p.success("Backup started","Backup is being created in the background"),c?.(),o.push("/backups"),o.refresh()}catch(b){let a=b instanceof Error?b.message:"Failed to create backup";p.error("Error",a)}finally{r(!1)}};return(0,d.jsxs)("form",{onSubmit:B,className:"space-y-6",children:[!a&&b.length>0&&(0,d.jsxs)(g.Zp,{children:[(0,d.jsxs)(g.aR,{children:[(0,d.jsx)(g.ZB,{children:"Select Project"}),(0,d.jsx)(g.BT,{children:"Choose the project to backup"})]}),(0,d.jsx)(g.Wu,{children:(0,d.jsx)("select",{value:s,onChange:a=>t(a.target.value),className:"w-full h-10 px-3 border border-border rounded-lg bg-background text-sm focus:outline-none focus:ring-2 focus:ring-brand",required:!0,children:b.map(a=>(0,d.jsx)("option",{value:a.id,children:a.name},a.id))})})]}),A&&(0,d.jsxs)(g.Zp,{children:[(0,d.jsx)(g.aR,{children:(0,d.jsx)(g.ZB,{children:"Project"})}),(0,d.jsx)(g.Wu,{children:(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:"h-10 w-10 rounded-lg bg-background-tertiary flex items-center justify-center",children:(0,d.jsx)(n.A,{className:"h-5 w-5 text-brand"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-medium",children:A.name}),(0,d.jsx)("p",{className:"text-sm text-foreground-muted",children:A.directory})]})]})})]}),(0,d.jsxs)(g.Zp,{children:[(0,d.jsxs)(g.aR,{children:[(0,d.jsx)(g.ZB,{children:"Backup Type"}),(0,d.jsx)(g.BT,{children:"Select what to include in the backup"})]}),(0,d.jsx)(g.Wu,{children:(0,d.jsx)(l.BackupTypeSelector,{value:u,onChange:v})})]}),(0,d.jsxs)(g.Zp,{children:[(0,d.jsxs)(g.aR,{children:[(0,d.jsx)(g.ZB,{children:"Destination"}),(0,d.jsx)(g.BT,{children:"Choose where to store the backup"})]}),(0,d.jsx)(g.Wu,{children:(0,d.jsx)(m.DestinationSelector,{value:w,onChange:x})})]}),(0,d.jsxs)(g.Zp,{children:[(0,d.jsxs)(g.aR,{children:[(0,d.jsx)(g.ZB,{children:"Options"}),(0,d.jsx)(g.BT,{children:"Additional backup settings"})]}),(0,d.jsx)(g.Wu,{className:"space-y-4",children:(0,d.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Encrypt Backup"}),(0,d.jsx)("p",{className:"text-sm text-foreground-muted",children:"Encrypt the backup file using the project's encryption key"})]}),(0,d.jsx)(i.d,{checked:y,onCheckedChange:z})]})})]}),(0,d.jsx)("div",{className:"flex justify-end",children:(0,d.jsx)(h.Button,{type:"submit",disabled:q||!s,children:q?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.y,{size:"sm",className:"mr-2"}),"Creating Backup..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.A,{className:"h-4 w-4 mr-2"}),"Create Backup"]})})})]})}},62186:(a,b,c)=>{c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h});var d=c(21124),e=c(38301),f=c(44943);let g=(0,e.forwardRef)(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("rounded-xl border border-border bg-background-secondary shadow-xs",a),...b}));g.displayName="Card";let h=(0,e.forwardRef)(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=(0,e.forwardRef)(({className:a,...b},c)=>(0,d.jsx)("h3",{ref:c,className:(0,f.cn)("text-lg font-semibold leading-none tracking-tight text-foreground",a),...b}));i.displayName="CardTitle";let j=(0,e.forwardRef)(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:(0,f.cn)("text-sm text-foreground-secondary",a),...b}));j.displayName="CardDescription";let k=(0,e.forwardRef)(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent",(0,e.forwardRef)(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b})).displayName="CardFooter"},79240:(a,b,c)=>{c.d(b,{BackupCard:()=>B});var d=c(21124),e=c(3991),f=c.n(e),g=c(38301),h=c(62186),i=c(99187),j=c(35284),k=c(62145),l=c(40179),m=c(65828),n=c(66041),o=c(33464),p=c(94684),q=c(22842),r=c(15303),s=c(84220),t=c(59268),u=c(91292),v=c(49269),w=c(9212),x=c(40284),y=c(44943);let z={full:{label:"Full Backup",icon:l.A,color:"text-brand"},database:{label:"Database",icon:m.A,color:"text-success"},storage:{label:"Storage",icon:n.A,color:"text-info"},functions:{label:"Functions",icon:o.A,color:"text-warning"},config:{label:"Config",icon:p.A,color:"text-foreground-muted"}},A={completed:{label:"Completed",variant:"success"},failed:{label:"Failed",variant:"error"},running:{label:"Running",variant:"info"},pending:{label:"Pending",variant:"secondary"}};function B({backup:a,projectName:b,onDownload:c,onRestore:e,onDelete:l}){let[m,n]=(0,g.useState)(!1),o=z[a.type],p=o.icon,B=A[a.status],C=async b=>{if(b.preventDefault(),b.stopPropagation(),l&&confirm("Are you sure you want to delete this backup?")){n(!0);try{await l(a.id)}finally{n(!1)}}};return(0,d.jsx)(f(),{href:`/backups/${a.id}`,className:"block",children:(0,d.jsx)(h.Zp,{className:"hover:border-brand/50 transition-colors cursor-pointer",children:(0,d.jsxs)(h.Wu,{className:"p-4",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,d.jsxs)("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[(0,d.jsx)("div",{className:"h-10 w-10 rounded-lg bg-background-tertiary flex items-center justify-center flex-shrink-0",children:(0,d.jsx)(p,{className:`h-5 w-5 ${o.color}`})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,d.jsx)("h3",{className:"font-medium text-foreground truncate",children:a.filename}),a.encrypted&&(0,d.jsx)("span",{title:"Encrypted",children:(0,d.jsx)(q.A,{className:"h-3.5 w-3.5 text-foreground-muted"})})]}),(0,d.jsxs)("p",{className:"text-sm text-foreground-muted mt-0.5",children:[b&&(0,d.jsxs)(d.Fragment,{children:[b," • "]}),o.label," • ",(0,y.z3)(a.size)]}),(0,d.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-foreground-muted",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(r.A,{className:"h-3 w-3"}),(0,d.jsx)("span",{children:(0,y.mo)(a.createdAt)})]}),"local"!==a.destination&&(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(s.A,{className:"h-3 w-3"}),(0,d.jsx)("span",{children:"Cloud"})]}),a.duration&&(0,d.jsxs)("span",{children:["Duration: ",Math.round(a.duration/1e3),"s"]})]})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-3 flex-shrink-0",children:[(0,d.jsxs)(i.E,{variant:B.variant,children:["running"===a.status&&(0,d.jsx)(k.y,{size:"sm",className:"mr-1"}),"completed"===a.status&&(0,d.jsx)(t.A,{className:"h-3 w-3 mr-1"}),"failed"===a.status&&(0,d.jsx)(u.A,{className:"h-3 w-3 mr-1"}),"pending"===a.status&&(0,d.jsx)(r.A,{className:"h-3 w-3 mr-1"}),B.label]}),"completed"===a.status&&(0,d.jsxs)("div",{className:"flex items-center gap-1",onClick:a=>a.preventDefault(),children:["local"===a.destination&&c&&(0,d.jsx)(j.Button,{variant:"ghost",size:"sm",onClick:b=>{b.preventDefault(),b.stopPropagation(),c?.(a.id)},title:"Download backup",children:(0,d.jsx)(v.A,{className:"h-4 w-4"})}),e&&(0,d.jsx)(j.Button,{variant:"ghost",size:"sm",onClick:b=>{b.preventDefault(),b.stopPropagation(),e?.(a.id)},title:"Restore from backup",children:(0,d.jsx)(w.A,{className:"h-4 w-4"})}),l&&(0,d.jsx)(j.Button,{variant:"ghost",size:"sm",onClick:C,disabled:m,title:"Delete backup",className:"text-error hover:text-error",children:m?(0,d.jsx)(k.y,{size:"sm"}):(0,d.jsx)(x.A,{className:"h-4 w-4"})})]})]})]}),"failed"===a.status&&a.errorMessage&&(0,d.jsx)("div",{className:"mt-3 p-2 bg-error/10 border border-error/20 rounded text-xs text-error",children:a.errorMessage}),"full"===a.type&&a.metadata?.components&&(0,d.jsx)("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:a.metadata.components.map(a=>{let b=z[a],c=b.icon;return(0,d.jsxs)(i.E,{variant:"secondary",className:"text-xs",children:[(0,d.jsx)(c,{className:"h-3 w-3 mr-1"}),b.label]},a)})})]})})})}},99187:(a,b,c)=>{c.d(b,{E:()=>f});var d=c(21124),e=c(44943);function f({className:a,variant:b="default",...c}){return(0,d.jsx)("span",{className:(0,e.cn)("inline-flex items-center rounded-md border px-2 py-0.5 text-xs font-semibold transition-colors",{default:"bg-brand/10 text-brand border-brand/20",success:"bg-success/10 text-success border-success/20",warning:"bg-warning/10 text-warning border-warning/20",error:"bg-error/10 text-error border-error/20",info:"bg-info/10 text-info border-info/20",secondary:"bg-background-tertiary text-foreground-secondary border-border"}[b],a),...c})}}};