{
  "name": "capco-fire-protection",
  "services": [
    {
      "name": "astro-app",
      "build": {
        "builder": "NIXPACKS"
      },
      "environment": {
        "NODE_ENV": "production",
        "PORT": "3000"
      },
      "deploy": {
        "startCommand": "npm run build && npm run preview --port 3000 --host 0.0.0.0"
      }
    },
    {
      "name": "n8n",
      "image": "n8nio/n8n:latest",
      "ports": ["5678"],
      "environment": {
        "N8N_BASIC_AUTH_ACTIVE": "true",
        "N8N_BASIC_AUTH_USER": "admin",
        "N8N_BASIC_AUTH_PASSWORD": "admin123",
        "N8N_HOST": "0.0.0.0",
        "N8N_PORT": "5678",
        "N8N_PROTOCOL": "https",
        "WEBHOOK_URL": "https://capco-fire-protection.railway.app",
        "N8N_METRICS": "true",
        "N8N_LOG_LEVEL": "info"
      },
      "volumes": [
        {
          "name": "n8n_data",
          "mountPath": "/home/node/.n8n"
        }
      ],
      "command": "n8n start"
    },
    {
      "name": "resend",
      "image": "resend/resend:latest",
      "ports": ["8000"],
      "environment": {
        "RESEND_API_KEY": "${{RESEND_API_KEY}}",
        "RESEND_WEBHOOK_SECRET": "${{RESEND_WEBHOOK_SECRET}}",
        "RESEND_FROM_EMAIL": "${{FROM_EMAIL}}",
        "RESEND_FROM_NAME": "${{FROM_NAME}}"
      },
      "deploy": {
        "startCommand": "resend start --port 8000"
      }
    }
  ]
}
