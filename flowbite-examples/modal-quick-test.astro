---
// Quick test page to verify modal system is working
import PageEditorModal from "../src/components/ui/PageEditorModal.astro";
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modal System Quick Test</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
  </head>
  <body class="p-8 bg-gray-50">
    <h1 class="text-3xl font-bold mb-4">üß™ Modal System Quick Test</h1>
    <p class="mb-8 text-gray-600">Click the buttons below to test the modal system:</p>

    <div class="space-y-4">
      <!-- Test 1: Simple Modal -->
      <button
        id="test-simple"
        class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700"
      >
        Test 1: Simple Modal
      </button>

      <!-- Test 2: Form Modal -->
      <button
        id="test-form"
        class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700"
      >
        Test 2: Form Modal
      </button>

      <!-- Test 3: Confirmation -->
      <button
        id="test-confirm"
        class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700"
      >
        Test 3: Confirmation Dialog
      </button>

      <!-- Test 4: No Footer -->
      <button
        id="test-no-footer"
        class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700"
      >
        Test 4: Info Modal (No Footer)
      </button>

      <!-- Test 5: Component Modal -->
      <button
        data-modal-toggle="test-component-modal"
        class="bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700"
      >
        Test 5: Component Modal
      </button>
    </div>

    <div class="mt-8 p-4 bg-white rounded-lg shadow">
      <h2 class="text-xl font-semibold mb-2">Test Results:</h2>
      <div id="test-results" class="text-sm text-gray-600">
        No tests run yet. Click a button above!
      </div>
    </div>

    <div class="mt-8 p-4 bg-blue-50 rounded-lg">
      <h2 class="text-lg font-semibold mb-2">‚úÖ Checklist:</h2>
      <ul class="space-y-2 text-sm">
        <li>‚úì Modals appear correctly</li>
        <li>‚úì ESC key closes modal</li>
        <li>‚úì Backdrop click closes modal</li>
        <li>‚úì Confirm/Cancel buttons work</li>
        <li>‚úì Body scroll is locked when modal open</li>
        <li>‚úì TypeScript autocomplete works (check in IDE)</li>
      </ul>
    </div>

    <!-- Component Modal -->
    <PageEditorModal id="test-component-modal" />

    <script>
      import { showModal } from "../src/lib/ux-utils";

      // Make available globally
      window.showModal = showModal;

      const results = document.getElementById("test-results");

      function log(message) {
        const time = new Date().toLocaleTimeString();
        results.innerHTML += `<div>[${time}] ${message}</div>`;
      }

      // Test 1: Simple Modal
      document.getElementById("test-simple")?.addEventListener("click", () => {
        log("Test 1: Opening simple modal...");
        window.showModal({
          title: "Test Modal",
          body: "<p class='text-gray-700'>This is a simple test modal. Press ESC or click the backdrop to close.</p>",
          primaryButtonText: "OK",
          onConfirm: () => {
            log("Test 1: ‚úÖ Confirm button clicked");
          },
          onCancel: () => {
            log("Test 1: ‚ÑπÔ∏è Modal cancelled");
          },
        });
      });

      // Test 2: Form Modal
      document.getElementById("test-form")?.addEventListener("click", () => {
        log("Test 2: Opening form modal...");
        window.showModal({
          title: "Test Form",
          body: `
            <form id="test-form" class="space-y-4">
              <div>
                <label class="block text-sm font-medium mb-2">Name</label>
                <input type="text" name="name" class="w-full p-2 border rounded" required />
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">Email</label>
                <input type="email" name="email" class="w-full p-2 border rounded" required />
              </div>
            </form>
          `,
          primaryButtonText: "Submit",
          size: "medium",
          onConfirm: () => {
            const form = document.getElementById("test-form");
            const data = new FormData(form);
            log(`Test 2: ‚úÖ Form submitted - Name: ${data.get("name")}, Email: ${data.get("email")}`);
          },
        });
      });

      // Test 3: Confirmation
      document.getElementById("test-confirm")?.addEventListener("click", () => {
        log("Test 3: Opening confirmation dialog...");
        window.showModal({
          title: "Confirm Action",
          body: "<p class='text-gray-700'>Are you sure you want to proceed?</p>",
          primaryButtonText: "Yes, Proceed",
          secondaryButtonText: "Cancel",
          size: "small",
          onConfirm: () => {
            log("Test 3: ‚úÖ User confirmed action");
          },
          onCancel: () => {
            log("Test 3: ‚ÑπÔ∏è User cancelled action");
          },
        });
      });

      // Test 4: No Footer
      document.getElementById("test-no-footer")?.addEventListener("click", () => {
        log("Test 4: Opening info modal (no footer)...");
        window.showModal({
          title: "Information",
          body: `
            <div class="space-y-4">
              <p class="text-gray-700">This modal has no footer buttons.</p>
              <p class="text-sm text-gray-500">Press ESC or click the backdrop to close.</p>
            </div>
          `,
          showFooter: false,
          size: "medium",
        });
      });

      // Test 5: Component Modal
      const componentModalBtn = document.querySelector('[data-modal-toggle="test-component-modal"]');
      const componentModal = document.getElementById("test-component-modal");

      componentModalBtn?.addEventListener("click", () => {
        log("Test 5: Opening component modal...");
        componentModal?.classList.remove("hidden");
        componentModal?.classList.add("flex");

        // Update content
        const title = document.getElementById("test-component-modal-title");
        const body = document.getElementById("test-component-modal-body");

        if (title) title.textContent = "Component Modal Test";
        if (body)
          body.innerHTML =
            "<p class='text-gray-700'>This modal was created using the PageEditorModal.astro component.</p>";
      });

      // Log when page loads
      document.addEventListener("DOMContentLoaded", () => {
        log("‚úÖ Page loaded - Modal system ready for testing");
        log("‚ÑπÔ∏è window.showModal is available: " + (typeof window.showModal === "function"));
      });
    </script>
  </body>
</html>
