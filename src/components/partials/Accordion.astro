---
// Reusable Accordion component following Flowbite design
import { globalClasses } from "../../pages/api/global/global-classes";

const { globalCardStyle } = globalClasses();
export const partial = true;

// Detect if this is being used as a partial
const isPartial = Astro.request.headers.has("x-accordion-id");

let id, title, description, content, open, className, headerClass, contentClass;

if (isPartial) {
  // Extract props from headers when used as partial
  id = Astro.request.headers.get("x-accordion-id") || "";
  title = Astro.request.headers.get("x-accordion-title") || "";
  description = Astro.request.headers.get("x-accordion-description") || "";
  content = Astro.request.headers.get("x-accordion-content") || "";
  open = Astro.request.headers.get("x-accordion-open") === "true";
  className = Astro.request.headers.get("x-accordion-class") || "";
  headerClass = Astro.request.headers.get("x-accordion-header-class") || "";
  contentClass = Astro.request.headers.get("x-accordion-content-class") || "";
} else {
  // Use regular props when used as a component
  const props = Astro.props;
  id = props.id;
  title = props.title;
  description = props.description;
  content = props.content;
  open = props.open || false;
  className = props.class || "";
  headerClass = props.headerClass || "";
  contentClass = props.contentClass || "";
}
---

<details
  class={`${globalCardStyle} ${className} group`}
  open={open}
>
  <summary class={`flex cursor-pointer list-none items-center justify-between rounded-lg p-4 transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 [&::-webkit-details-marker]:hidden ${headerClass}`}>
    <div class="flex-1">
      <h3 class="text-lg font-medium text-gray-900 dark:text-white">
        {title}
      </h3>
      {description && <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">{description}</p>}
    </div>
    <svg
      class="h-4 w-4 shrink-0 transition-transform duration-200 group-open:rotate-180 text-gray-400"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
      aria-hidden="true"
    >
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
    </svg>
  </summary>
  <div class={`border-t border-gray-200 px-4 pb-4 dark:border-gray-700 ${contentClass}`}>
    <div class="pt-4">
      <div set:html={content} />
    </div>
  </div>
</details>
