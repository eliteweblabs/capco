---
/**
 * SidebarBlock - Content with Sidebar Layout
 *
 * Classic content + sidebar layout, great for blog posts, documentation, etc.
 *
 * @example Basic usage:
 * <SidebarBlock>
 *   <div slot="content">Main content here</div>
 *   <div slot="sidebar">Sidebar content</div>
 * </SidebarBlock>
 *
 * @example Sidebar on left:
 * <SidebarBlock sidebarPosition="left" sidebarWidth="narrow">
 *   <div slot="content">Main content</div>
 *   <div slot="sidebar">Navigation sidebar</div>
 * </SidebarBlock>
 */

interface Props {
  // Sidebar position
  sidebarPosition?: "left" | "right";

  // Sidebar width
  sidebarWidth?: "narrow" | "medium" | "wide";

  // Gap between content and sidebar
  gap?: "none" | "small" | "medium" | "large" | "xl";

  // Sticky sidebar
  stickySidebar?: boolean | string;
  stickyOffset?: string;

  // Container settings
  contained?: boolean | string;
  maxWidth?: "lg" | "xl" | "2xl" | "full";

  // Padding
  padding?: "none" | "small" | "medium" | "large";

  // Background
  backgroundColor?: string;

  // Mobile behavior
  hideSidebarOnMobile?: boolean | string;

  // Props-based content (for CMS/dynamic rendering)
  mainContent?: string;
  sidebarContent?: string;

  // Styling
  className?: string;
  id?: string;
}

const props = Astro.props;
const {
  sidebarPosition = "right",
  sidebarWidth = "medium",
  gap = "large",
  stickyOffset = "6rem",
  maxWidth = "2xl",
  backgroundColor,
  mainContent,
  sidebarContent,
  className = "",
  id,
} = props;

// Handle boolean/string conversions
const contained = props.contained !== "false" && props.contained !== false;
const stickySidebar = props.stickySidebar === "true" || props.stickySidebar === true;
const hideSidebarOnMobile =
  props.hideSidebarOnMobile === "true" || props.hideSidebarOnMobile === true;
const padding = props.padding || "medium";

// Sidebar width classes (using 12-column grid)
const sidebarWidthClasses = {
  narrow: { content: "lg:col-span-9", sidebar: "lg:col-span-3" },
  medium: { content: "lg:col-span-8", sidebar: "lg:col-span-4" },
  wide: { content: "lg:col-span-7", sidebar: "lg:col-span-5" },
};

const widthClasses = sidebarWidthClasses[sidebarWidth] || sidebarWidthClasses.medium;

// Gap classes
const gapClasses = {
  none: "gap-0",
  small: "gap-4 lg:gap-6",
  medium: "gap-6 lg:gap-8",
  large: "gap-8 lg:gap-12",
  xl: "gap-12 lg:gap-16",
};

// Max width classes
const maxWidthClasses = {
  lg: "max-w-screen-lg",
  xl: "max-w-screen-xl",
  "2xl": "max-w-7xl",
  full: "max-w-full",
};

// Padding classes
const paddingClasses = {
  none: "",
  small: "py-8",
  medium: "py-12 md:py-16",
  large: "py-16 md:py-24",
};
---

<section
  {id}
  class:list={["sidebar-block", paddingClasses[padding], backgroundColor || "", className]}
>
  <div
    class:list={[
      contained && "mx-auto px-4 sm:px-6 lg:px-8",
      contained && maxWidthClasses[maxWidth],
    ]}
  >
    <div class:list={["grid grid-cols-1 lg:grid-cols-12", gapClasses[gap]]}>
      <!-- Content -->
      <div
        class:list={[
          "col-span-1",
          widthClasses.content,
          sidebarPosition === "left" && "lg:order-2",
        ]}
      >
        {mainContent ? <Fragment set:html={mainContent} /> : <slot name="content" />}
      </div>

      <!-- Sidebar -->
      <aside
        class:list={[
          "col-span-1",
          widthClasses.sidebar,
          sidebarPosition === "left" && "lg:order-1",
          hideSidebarOnMobile && "hidden lg:block",
        ]}
      >
        <div
          class:list={[stickySidebar && "lg:sticky"]}
          style={stickySidebar ? `top: ${stickyOffset};` : ""}
        >
          {sidebarContent ? <Fragment set:html={sidebarContent} /> : <slot name="sidebar" />}
        </div>
      </aside>
    </div>
  </div>
</section>
