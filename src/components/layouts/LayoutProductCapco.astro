---
import Button from "../common/Button.astro";
import Tooltip from "../ui/Tooltip.astro";
---


<div
  class="mx-auto flex h-full w-full max-w-screen-xl items-center justify-between"
  style="overscroll-behavior-y: contain;"
  data-dynamic-height="minHeight"
>
<div class="flex flex-col items-center justify-center px-4">
  <div class="bg-radial-gradient relative z-1 mb-0 inline-block text-left">
    <a
      href="project/dashboard"
      class="mb-6 inline-flex items-center justify-between rounded-full px-1 py-1 pr-4 text-sm text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700"
      role="alert"
    >
      <span
        class="mr-2 rounded-full bg-primary-600 px-4 text-white hover:bg-primary-600 dark:bg-primary-500 dark:hover:bg-primary-600"
        >New</span
      >
      <span class="text-sm font-medium">Streamlined Web App Workflow</span>
      <svg
        class="ml-2 h-5 w-5"
        fill="currentColor"
        viewBox="0 0 20 20"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fill-rule="evenodd"
          d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
          clip-rule="evenodd"></path>
      </svg>
    </a>
    <h1 class="mb-4 select-none text-5xl font-bold md:text-6xl">
      <span data-aos="fade-up" data-aos-delay="200">Expert Fire<br /></span>
      <span data-aos="fade-up" data-aos-delay="400">Alarm & Sprinkler<br /></span>
      <span data-aos="fade-up" data-aos-delay="600">Designers</span>
    </h1>
    <p class="mb-6 max-w-2xl text-gray-500 dark:text-gray-400 md:mx-0 md:mb-8 md:text-xl">
      <span class="hidden select-none md:block" data-aos="fade-up" data-aos-delay="400"
        >Combined 50+ years of experience in permitting & expediting...<br /><br />
      </span>
      <span class="inline-block" data-aos="fade-up" data-aos-delay="800">
        Submittals delivered in 48 hours <span class="hidden md:inline"
          >with guaranteed approval at a fraction of the cost of traditional firms.<Tooltip
            position="right"
            className="text-red-500"
            text={`After deposit & document submission`}>*</Tooltip
          ></span
        >
      </span>
    </p>

    <div class="smoke-button hidden">
      <span class="smoke-particle"></span>
      <span class="smoke-particle"></span>
      <span class="smoke-particle"></span>
      <span class="smoke-particle"></span>
      <span class="smoke-particle"></span>
      <Button
        variant="outline"
        size="md"
        onclick="window.location.href='/auth/register'"
        class="pulse"
        dataAttributes={{
          "data-aos": "fade-up",
          "data-aos-delay": "1000",
        }}>Get Started</Button
      >
    </div>
  </div>
</div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const emailInput = document.getElementById("quick-register-email");
    const nextBtn = document.getElementById("next-btn");

    if (emailInput && nextBtn) {
      // Email validation function
      const isValidEmail = window.isValidEmail ?? ((e) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e));

      // Show/hide next button based on email validity
      function toggleNextButton() {
        const email = (emailInput as HTMLInputElement)?.value?.trim();
        if (isValidEmail(email)) {
          nextBtn?.classList.remove("hidden");
        } else {
          nextBtn?.classList.add("hidden");
        }
      }

      // Listen for input changes
      emailInput.addEventListener("input", toggleNextButton);
      emailInput.addEventListener("blur", toggleNextButton);

      // Handle next button click
      nextBtn.addEventListener("click", function () {
        const email = (emailInput as HTMLInputElement)?.value.trim();
        if (isValidEmail(email)) {
          const encodedEmail = encodeURIComponent(email);
          window.location.href = `/auth/register&email=${encodedEmail}`;
        }
      });

      // Handle Enter key on email input
      emailInput.addEventListener("keypress", function (e) {
        if (e.key === "Enter" && !nextBtn.classList.contains("hidden")) {
          nextBtn.click();
        }
      });
    }
  });
</script>

<style>
  .smoke-button {
    display: inline-block;
    position: relative;
  }

  .smoke-button::before,
  .smoke-button::after {
    position: absolute;
    top: 0;
    left: 50%;
    opacity: 0;
    z-index: -1;
    animation: smoke 3s infinite ease-out;
    border-radius: 50%;
    background: radial-gradient(
      circle,
      rgba(200, 200, 200, 0.8) 0%,
      rgba(150, 150, 150, 0.4) 40%,
      transparent 70%
    );
    width: 4px;
    height: 4px;
    pointer-events: none;
    content: "";
  }

  .smoke-button::after {
    left: 45%;
    animation-delay: 1.5s;
  }

  @keyframes smoke {
    0% {
      transform: translate(-50%, 0) scale(1);
      opacity: 0;
    }
    10% {
      opacity: 0.8;
    }
    50% {
      transform: translate(calc(-50% + 15px), -80px) scale(8);
      opacity: 0.6;
    }
    100% {
      transform: translate(calc(-50% + 25px), -120px) scale(12);
      opacity: 0;
    }
  }

  /* Multiple smoke particles */
  .smoke-particle {
    position: absolute;
    top: 1.5rem;
    left: 50%;
    opacity: 0;
    z-index: -1;
    border-radius: 50%;
    background: radial-gradient(
      circle,
      rgba(220, 220, 220, 0.7) 0%,
      rgba(180, 180, 180, 0.3) 40%,
      transparent 70%
    );
    width: 6px;
    height: 6px;
    pointer-events: none;
  }

  .smoke-particle:nth-child(1) {
    animation: smoke-particle 4s infinite ease-out;
    animation-delay: 1s;
  }

  .smoke-particle:nth-child(2) {
    left: 55%;
    animation: smoke-particle 4.5s infinite ease-out;
    animation-delay: 1.8s;
  }

  .smoke-particle:nth-child(3) {
    left: 45%;
    animation: smoke-particle 3.5s infinite ease-out;
    animation-delay: 2.6s;
  }

  .smoke-particle:nth-child(4) {
    left: 52%;
    animation: smoke-particle 4.2s infinite ease-out;
    animation-delay: 3.4s;
  }

  .smoke-particle:nth-child(5) {
    left: 48%;
    animation: smoke-particle 3.8s infinite ease-out;
    animation-delay: 4.2s;
  }

  @keyframes smoke-particle {
    0% {
      transform: translate(-50%, 0) scale(1) rotate(0deg);
      opacity: 0;
    }
    15% {
      opacity: 0.9;
    }
    60% {
      transform: translate(calc(-50% + 20px), -100px) scale(10) rotate(180deg);
      opacity: 0.5;
    }
    100% {
      transform: translate(calc(-50% + 35px), -150px) scale(15) rotate(360deg);
      opacity: 0;
    }
  }

  /* Dark mode adjustments */
  :global(.dark) .smoke-button::before,
  :global(.dark) .smoke-button::after {
    background: radial-gradient(
      circle,
      rgba(100, 100, 100, 0.6) 0%,
      rgba(70, 70, 70, 0.3) 40%,
      transparent 70%
    );
  }

  :global(.dark) .smoke-particle {
    background: radial-gradient(
      circle,
      rgba(120, 120, 120, 0.5) 0%,
      rgba(90, 90, 90, 0.2) 40%,
      transparent 70%
    );
  }

  .bg-radial-gradient::after {
    position: absolute;
    z-index: -1;
    inset: 0;
    background: radial-gradient(
      ellipse 50% 80% at 30% 40%,
      rgba(255, 255, 255, 0.95) 0%,
      rgba(255, 255, 255, 0.8) 20%,
      rgba(255, 255, 255, 0.6) 40%,
      rgba(255, 255, 255, 0.3) 60%,
      rgba(255, 255, 255, 0.1) 80%,
      transparent 100%
    );
    pointer-events: none;
    content: "";
  }

  /* Dark mode version - use :global() to match the HTML dark class */
  :global(.dark) .bg-radial-gradient::after {
    position: absolute;
    z-index: -1;
    inset: 0;
    background: radial-gradient(
      ellipse 50% 80% at 30% 40%,
      rgba(0, 0, 0, 0.95) 0%,
      rgba(0, 0, 0, 0.8) 20%,
      rgba(0, 0, 0, 0.6) 40%,
      rgba(0, 0, 0, 0.3) 60%,
      rgba(0, 0, 0, 0.1) 80%,
      transparent 100%
    );
    pointer-events: none;
    content: "";
  }
</style>
