---
import Button from "../common/Button.astro";

const { class: className, "data-count": count, label, icon, ...props } = Astro.props;

// Extract data attributes from props
const dataAttributes: Record<string, string> = {};
const buttonProps: Record<string, any> = {};

Object.entries(props).forEach(([key, value]) => {
  if (key.startsWith("data-")) {
    // Remove 'data-' prefix for the dataAttributes object
    const dataKey = key.replace("data-", "");
    dataAttributes[dataKey] = value;
  } else {
    buttonProps[key] = value;
  }
});

// Add count to data attributes
if (count) {
  dataAttributes.count = count;
}
---

<div class="relative">
  <Button
    variant="ghost"
    size="sm"
    class={`mt-2 w-auto text-text-primary dark:hover:text-text-primary-dark [&.text-blue-600]:text-white [&.dark\\:text-blue-400]:text-white ${className || ""}`}
    dataAttributes={dataAttributes}
    {...buttonProps}
  >
    <slot />
  </Button>
  {
    count && parseInt(count) > 0 && (
      <span class="absolute right-0 top-0 flex h-5 w-5 items-center justify-center rounded-full border border-primary-500 bg-white text-xs font-medium text-primary-500 dark:bg-background-dark dark:border-primary-400 dark:text-primary-400">
        {count}
      </span>
    )
  }
</div>
