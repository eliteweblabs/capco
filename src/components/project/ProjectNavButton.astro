---
import Button from "../common/Button.astro";

const { 
  class: className, 
  "data-count": count, 
  label,
  icon,
  ...props 
} = Astro.props;

// Build data attributes object
const dataAttributes = {
  count: count || "0",
  ...Object.fromEntries(
    Object.entries(props).filter(([key]) => key.startsWith('data-'))
  )
};

// Remove data-* props from the main props object
const { ...buttonProps } = props;
Object.keys(buttonProps).forEach(key => {
  if (key.startsWith('data-')) {
    delete buttonProps[key];
  }
});
---

<div class="relative">
  <Button
    variant="ghost"
    size="sm"
    class={`mt-2 w-auto text-text-primary dark:hover:text-text-primary-dark [&.text-blue-600]:text-white [&.dark\\:text-blue-400]:text-white ${className || ""}`}
    dataAttributes={dataAttributes}
    {...buttonProps}
  >
    <slot />
  </Button>
  {
    count && parseInt(count) > 0 && (
      <span class="absolute -right-2 -top-2 flex h-5 w-5 items-center justify-center rounded-full border border-primary-500 bg-white text-xs font-medium text-primary-500 dark:bg-background-dark dark:border-primary-400 dark:text-primary-400">
        {count}
      </span>
    )
  }
</div>
