---
import PaymentForm from "./PaymentForm.astro";

interface Props {
  project?: any;
  currentRole?: string;
  projectId: string;
  authorProfile?: any;
  projectStatus?: number;
  currentUser?: any;
  projectStatusLabel?: string;
  invoiceId?: string;
  totalAmount?: number;
}

const {
  project,
  currentRole,
  projectId,
  authorProfile,
  projectStatus = 0,
  projectStatusLabel,
  invoiceId,
  totalAmount = 0,
} = Astro.props;

// Debug logging
// // console.log("ðŸ” [TAB-DEPOSIT] Debug values:", {
//   projectId,
//   authorProfile,
//   projectIdType: typeof projectId,
//   parsedProjectId: parseInt(projectId),
//   projectStatus,
//   projectStatusType: typeof projectStatus,
//   currentRole,
//   currentRoleType: typeof currentRole,
//   totalAmount,
//   totalAmountType: typeof totalAmount,
//   condition1: projectStatus >= 30,
//   condition2: currentRole === "Client",
//   condition3: projectStatus < 50,
//   fullCondition: projectStatus >= 30 && currentRole === "Client" && projectStatus < 50,
// });

// Log PaymentForm props
// // console.log("ðŸ” [TAB-DEPOSIT] PaymentForm props:", {
//   invoiceId: parseInt(invoiceId ?? "0"),
//   amount: totalAmount,
//   currency: "usd",
//   paymentType: "deposit",
// });
---

<div id="content-deposit" class="tab-content hidden">
  <div class="py-8 text-center">
    <i style="" class="bx bx-upload bx-lg bx-sm mx-auto mb-4 text-gray-700 dark:text-gray-300"></i>

    <p class="mb-4 text-gray-500 dark:text-gray-400">
      {
        currentRole === "Client" && projectStatus < 55
          ? "Deposit payment will be available after contract is signed."
          : projectStatus >= 55 && currentRole === "Client"
            ? "Secure your project with a deposit payment. This ensures we can begin work on your fire protection system."
            : null
      }
    </p>
  </div>

  {
    projectStatus >= 50 && projectStatus < 70 && currentRole === "Client" && (
      <PaymentForm
        invoiceId={invoiceId && invoiceId !== "0" ? parseInt(invoiceId) : null}
        amount={totalAmount / 2}
        currency="usd"
        paymentType="deposit"
        authorProfile={authorProfile}
        currentRole={currentRole}
        project={project}
        projectId={projectId}
      />
    )
  }
</div>
