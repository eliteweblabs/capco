---
import ProjectStatusDropdown from "../project/ProjectStatusDropdown.astro";
import StaffSelect from "../project/StaffSelectDropdown.astro";
import SectionContainer from "./SectionContainer.astro";

interface Props {
  title: string;
  description: string;
  statusLabel?: string;
  statusColor?: string;
  projectId?: number;
  currentStatus?: number;
  userRole?: string;
  projectTitle?: string;
  clientEmail?: string;
  project?: any;
  statuses?: any[]; // Accept statuses to pass to ProjectStatusDropdown
}

const {
  title,
  description,
  statusLabel,
  statusColor = "blue",
  projectId,
  currentStatus,
  userRole,
  projectTitle,
  clientEmail,
  project,
  statuses = [],
} = Astro.props;

// Debug logging for Hero component props
console.log("ðŸŽ¯ [HERO] Hero component props:", {
  title,
  statusLabel,
  projectId,
  userRole,
  hasProject: !!project,
  showStatusAndStaff: !!(statusLabel && projectId),
  isAdminOrStaff: userRole === "Admin" || userRole === "Staff",
});
---

<SectionContainer>
  <div class="relative mx-auto flex">
    <div class="flex-1">
      <h1
        class="text-2xl font-medium text-hub-title dark:text-hub-title-dark"
        id="page-title"
        data-refresh
      >
        {title}
      </h1>
      <h2
        id="page-subtitle"
        class="text-hub-subtitle dark:text-hub-subtitle-dark"
        set:html={description}
      />
    </div>
    {
      statusLabel && projectId ? (
        <div class="ml-4 flex flex-shrink-0 items-center gap-2">
          <ProjectStatusDropdown
            projectId={projectId}
            currentStatus={currentStatus ?? 0}
            statusLabel={statusLabel}
            statusColor={statusColor}
            userRole={userRole}
            projectTitle={projectTitle}
            clientEmail={clientEmail}
            statuses={statuses}
            data-refresh
          />
          {(userRole === "Admin" || userRole === "Staff") && (
            <div class="relative inline-block text-left">
              <div class="staff-select-hero">
                <StaffSelect
                  id="hero-staff-select"
                  projectId={projectId?.toString() || ""}
                  value={project?.assigned_to_id || ""}
                  autoSave={true}
                  variant="hero"
                  placeholder="Assign staff..."
                />
              </div>
            </div>
          )}
        </div>
      ) : statusLabel ? (
        <div class="ml-4 flex-shrink-0">
          <span
            class={`inline-flex items-center rounded-full px-3 py-1 text-sm font-medium bg-${statusColor}-100 text-${statusColor}-800 dark:bg-${statusColor}-900/30 dark:text-${statusColor}-400`}
          >
            {statusLabel}
          </span>
        </div>
      ) : null
    }
  </div>
</SectionContainer>
