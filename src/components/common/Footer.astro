---
const {
  globalInputClasses,
  secondaryTextClasses,
  primaryTextClasses,
  year,
  globalCompanyName,
  isBackend,
  primaryColor,
} = Astro.props;

import { checkAuth } from "@/lib/auth";
const { currentUser } = await checkAuth(Astro.cookies);

import Tooltip from "@/components/common/Tooltip.astro";
import VapiChatWidget from "@/components/vapi/VapiChatWidget.astro";
import CampfireChatWidget from "@/components/common/CampfireChatWidget.astro";
---

<footer class="flex max-w-screen-xl mx-auto w-full gap-2 mt-4 p-4 items-center justify-between">
  <div class="align-center flex justify-center space-x-3">
    <Tooltip
      position="right"
      text={`${new Date().getFullYear().toString()} ${globalCompanyName}. 
        All rights reserved.`}
      >Â©
    </Tooltip>
    {
      !isBackend && (
        <ul class="align-center flex justify-center text-gray-500 dark:text-gray-400">
          <li>
            <a href="/privacy" class="me-6 no-underline hover:underline">
              privacy
            </a>
          </li>
          <li>
            <a href="/terms" class="me-6 no-underline hover:underline">
              terms
            </a>
          </li>
          <li>
            <a href="/cookies" class="no-underline hover:underline">
              cookie
            </a>
          </li>
        </ul>
      )
    }

    <!-- Legal Links -->
  </div>

  <div class="align-center flex justify-center space-x-3 w-full hidden">
    <div class="flex flex-wrap items-center justify-center gap-4 md:justify-end">
      <!-- Certificate images temporarily disabled to fix console errors -->
      <img
        src="/img/cert-afsa.png"
        alt="AFSA Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale md:w-20"
      />
      <img
        src="/img/cert-hfsc.jpg"
        alt="HFSC Certification"
        class="h-auto w-16 max-w-[40px] object-contain grayscale md:w-20"
      />
      <img
        src="/img/NFPA_logo.svg"
        alt="NFPA Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale hover:grayscale-0 md:w-20"
      />
      <img
        src="/img/cert-nfsa.png"
        alt="NFSA Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale md:w-20"
      />
      <img
        src="/img/cert-nicet.png"
        alt="NICET Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale md:w-20"
      />
      <img
        src="/img/cert-sfpe.png"
        alt="SFPE Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale md:w-20"
      />
    </div>
  </div>
  <div class="align-center flex justify-center space-x-3 w-8">
    <!-- VAPI Voice Chat Widget (Fixed Bottom Right) -->
    <!-- <VapiChatWidget
  assistantId="3ae002d5-fe9c-4870-8034-4c66a9b43b51"
  publicKey="77cb0a47-2427-44ac-996d-e6ed2ca03bbf"
/> -->

    {
      !currentUser && !isBackend ? (
        <>
          <vapi-widget
            public-key="e527a16e-e913-4330-ae9d-09d83e8da40f"
            assistant-id="3ae002d5-fe9c-4870-8034-4c66a9b43b51"
            mode="chat"
            theme="dark"
            base-bg-color="#000000"
            accent-color={primaryColor}
            cta-button-color="#000000"
            cta-button-text-color="#ffffff"
            border-radius="large"
            size="compact"
            position="bottom-right"
            title="Live"
            start-button-text="Start"
            end-button-text="End Call"
            chat-first-message={`Thank you for your interest in ${globalCompanyName}. How can I help you today?`}
            chat-placeholder="Type your message..."
            voice-show-transcript="true"
            consent-required="true"
            consent-title="Terms and conditions"
            consent-content="By clicking Agree, and each time I interact with this AI agent, I consent to the recording, storage, and sharing of my communications with third-party service providers, and as otherwise described in our Terms of Service."
            consent-storage-key="vapi_widget_consent"
          />

          <script
            src="https://unpkg.com/@vapi-ai/client-sdk-react/dist/embed/widget.umd.js"
            async
            type="text/javascript"
          />
        </>
      ) : (
        <CampfireChatWidget
          currentUser={currentUser ?? undefined}
          position="bottom-right"
          theme="auto"
        />
      )
    }
  </div>
</footer>
