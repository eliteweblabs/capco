---
/**
 * Popover component using Flowbite's popover (Popper.js).
 * Renders a trigger + floating content. Flowbite initPopovers() auto-initializes.
 *
 * @param id - Unique ID for the popover (required for data-popover-target)
 * @param placement - Where to show: top | top-start | top-end | right | right-start | right-end | bottom | bottom-start | bottom-end | left | left-start | left-end. Default: top
 * @param trigger - "click" or "hover". Default: hover
 * @param offset - Distance in px from trigger. Default: 10
 * @param showArrow - Whether to show the arrow. Default: true
 * @param class - Extra classes for the popover content container
 * @param contentClass - Extra classes for the inner content area (below header)
 * @param title - Optional header title (renders above content)
 * @param width - Width class: "w-64" | "w-72" | "w-80" | "w-96" | "max-w-sm" etc. Default: w-64
 */
export const partial = true;

export interface Props {
  id: string;
  width?: string;
  placement?:
    | "top"
    | "top-start"
    | "top-end"
    | "right"
    | "right-start"
    | "right-end"
    | "bottom"
    | "bottom-start"
    | "bottom-end"
    | "left"
    | "left-start"
    | "left-end";
  trigger?: "click" | "hover";
  offset?: number;
  showArrow?: boolean;
  class?: string;
  contentClass?: string;
  title?: string;
}

const {
  id,
  placement = "top",
  trigger = "hover",
  offset = 10,
  showArrow = true,
  class: className = "",
  contentClass = "",
  title,
  width = "w-64",
} = Astro.props;
---

<div class="relative inline-flex">
  <span
    data-popover-target={id}
    data-popover-trigger={trigger}
    data-popover-placement={placement}
    data-popover-offset={String(offset)}
    class="inline-flex cursor-pointer"
  >
    <slot name="trigger" />
  </span>
  <div
    data-popover
    id={id}
    role="tooltip"
    class={`shadow-xs color-background invisible absolute z-10 inline-block ${width} rounded-lg border border-gray-200 bg-white text-sm text-gray-500 opacity-0 transition-opacity duration-300 dark:border-gray-600 dark:text-gray-400 ${className}`}
  >
    {title && (
      <div class="rounded-t-lg border-b border-gray-200 bg-gray-100 px-3 py-2 dark:border-gray-600 dark:bg-gray-700">
        <h3 class="font-semibold text-gray-900 dark:text-white">{title}</h3>
      </div>
    )}
    <div class={`px-3 py-2 ${contentClass}`}>
      <slot />
    </div>
    {showArrow && <div data-popper-arrow></div>}
  </div>
</div>
