---
// No server-side message handling needed - using toast system instead
---

<div class="mx-auto my-12 w-full max-w-lg px-6">
  <p class="mb-8 w-full text-sm text-zinc-500 dark:text-zinc-400">
    Already have an account?
    <a
      href="/login"
      class="font-medium text-blue-600 underline underline-offset-2 dark:text-blue-400"
    >
      Sign in
    </a>
  </p>

  <form action="/api/auth/register" method="post" class="grid w-full grid-cols-1 gap-3">
    <!-- Name Fields -->
    <div class="grid grid-cols-2 gap-3">
      <div class="grid grid-cols-1 gap-2">
        <label for="first_name" class="text-sm font-medium text-zinc-900 dark:text-zinc-300">
          First Name <span class="text-red-500">*</span>
        </label>
        <input
          id="first_name"
          type="text"
          name="first_name"
          required
          placeholder="Your first name"
          class="rounded-md border border-zinc-300 bg-zinc-50 px-3 py-1 focus:border-blue-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-opacity-60 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:focus:bg-zinc-900"
        />
      </div>

      <div class="grid grid-cols-1 gap-2">
        <label for="last_name" class="text-sm font-medium text-zinc-900 dark:text-zinc-300">
          Last Name <span class="text-red-500">*</span>
        </label>
        <input
          id="last_name"
          type="text"
          name="last_name"
          required
          placeholder="Your last name"
          class="rounded-md border border-zinc-300 bg-zinc-50 px-3 py-1 focus:border-blue-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-opacity-60 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:focus:bg-zinc-900"
        />
      </div>
    </div>

    <!-- Company/Display Name -->
    <div class="grid grid-cols-1 gap-2">
      <label for="display_name" class="text-sm font-medium text-zinc-900 dark:text-zinc-300">
        Company/Display Name <span class="text-red-500">*</span>
      </label>
      <input
        id="display_name"
        type="text"
        name="display_name"
        required
        placeholder="Your company or display name"
        class="rounded-md border border-zinc-300 bg-zinc-50 px-3 py-1 focus:border-blue-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-opacity-60 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:focus:bg-zinc-900"
      />
    </div>

    <!-- Email -->
    <div class="grid grid-cols-1 gap-2">
      <label for="email" class="text-sm font-medium text-zinc-900 dark:text-zinc-300">
        Email <span class="text-red-500">*</span>
      </label>
      <input
        id="email"
        type="email"
        name="email"
        required
        placeholder="Enter your email address"
        class="rounded-md border border-zinc-300 bg-zinc-50 px-3 py-1 focus:border-blue-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-opacity-60 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:focus:bg-zinc-900"
      />
    </div>

    <!-- Phone (Optional) -->
    <div class="grid grid-cols-1 gap-2">
      <label for="phone" class="text-sm font-medium text-zinc-900 dark:text-zinc-300">
        Phone Number
      </label>
      <input
        id="phone"
        type="tel"
        name="phone"
        placeholder="(555) 123-4567 (optional)"
        class="rounded-md border border-zinc-300 bg-zinc-50 px-3 py-1 focus:border-blue-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-opacity-60 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:focus:bg-zinc-900"
      />
    </div>

    <!-- Password -->
    <div class="grid grid-cols-1 gap-2">
      <label for="password" class="text-sm font-medium text-zinc-900 dark:text-zinc-300">
        Password <span class="text-red-500">*</span>
      </label>
      <input
        id="password"
        type="password"
        name="password"
        required
        minlength="6"
        placeholder="Enter a password (minimum 6 characters)"
        class="rounded-md border border-zinc-300 bg-zinc-50 px-3 py-1 focus:border-blue-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-opacity-60 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-300 dark:focus:bg-zinc-900"
      />
      <p class="text-xs text-zinc-500 dark:text-zinc-400">
        Password must be at least 6 characters long
      </p>
    </div>

    <button
      type="submit"
      class="mt-2 rounded-md border border-zinc-900 bg-zinc-900 py-1.5 text-sm font-medium text-zinc-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-100 dark:bg-zinc-100 dark:text-zinc-900 dark:focus:ring-offset-zinc-900"
    >
      Create Account
    </button>
  </form>

  <hr class="mt-8 h-0 border-t border-zinc-300 dark:border-zinc-600" />
  <p class="-mt-2.5 text-center text-xs text-zinc-500 dark:text-zinc-400">
    <span class="bg-zinc-50 px-4 dark:bg-zinc-900">Or with</span>
  </p>

  <form action="/api/auth/signin" method="post" class="mt-6 flex w-full flex-col gap-2">
    <button
      value="google"
      name="provider"
      class="mt-2 flex w-full items-center justify-center gap-2 rounded-md border border-zinc-300 p-1.5 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-zinc-100 dark:bg-zinc-100 dark:text-zinc-900 dark:focus:ring-offset-zinc-900"
      type="submit"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-auto"
        preserveAspectRatio="xMidYMid"
        viewBox="0 0 256 262"
      >
        <path
          fill="#4285F4"
          d="M255.878 133.451c0-10.734-.871-18.567-2.756-26.69H130.55v48.448h71.947c-1.45 12.04-9.283 30.172-26.69 42.356l-.244 1.622 38.755 30.023 2.685.268c24.659-22.774 38.875-56.282 38.875-96.027"
        ></path>
        <path
          fill="#34A853"
          d="M130.55 261.1c35.248 0 64.839-11.605 86.453-31.622l-41.196-31.913c-11.024 7.688-25.82 13.055-45.257 13.055-34.523 0-63.824-22.773-74.269-54.25l-1.531.13-40.298 31.187-.527 1.465C35.393 231.798 79.49 261.1 130.55 261.1"
        ></path>
        <path
          fill="#FBBC05"
          d="M56.281 156.37c-2.756-8.123-4.351-16.827-4.351-25.82 0-8.994 1.595-17.697 4.206-25.82l-.073-1.73L15.26 71.312l-1.335.635C5.077 89.644 0 109.517 0 130.55s5.077 40.905 13.925 58.602l42.356-32.782"
        ></path>
        <path
          fill="#EB4335"
          d="M130.55 50.479c24.514 0 41.05 10.589 50.479 19.438l36.844-35.974C195.245 12.91 165.798 0 130.55 0 79.49 0 35.393 29.301 13.925 71.947l42.211 32.783c10.59-31.477 39.891-54.251 74.414-54.251"
        ></path>
      </svg>
      Sign up with Google
    </button>
  </form>

  <!-- Additional Links -->
  <div class="mt-8 space-y-4 text-center">
    <div class="text-sm text-gray-500 dark:text-gray-400">
      <p>Need help? Contact our support team</p>
    </div>
  </div>
</div>

<script>
  import { globalServices } from "../../lib/global-services";

  // Handle form submission with client-side validation feedback
  document.addEventListener("DOMContentLoaded", () => {
    const registerForm = document.querySelector('form[action="/api/auth/register"]');
    if (registerForm) {
      registerForm.addEventListener("submit", (e) => {
        const firstName = (
          registerForm.querySelector("#first_name") as HTMLInputElement
        )?.value?.trim();
        const lastName = (
          registerForm.querySelector("#last_name") as HTMLInputElement
        )?.value?.trim();
        const displayName = (
          registerForm.querySelector("#display_name") as HTMLInputElement
        )?.value?.trim();
        const email = (registerForm.querySelector("#email") as HTMLInputElement)?.value?.trim();
        const password = (registerForm.querySelector("#password") as HTMLInputElement)?.value;

        // Check required fields
        if (!firstName || !lastName || !displayName || !email || !password) {
          e.preventDefault();
          globalServices.showNotification({
            type: "error",
            title: "Validation Error",
            message: "Please fill in all required fields (marked with *).",
            duration: 5000,
          });
          return;
        }

        // Validate name fields
        if (firstName.length < 2 || lastName.length < 2) {
          e.preventDefault();
          globalServices.showNotification({
            type: "error",
            title: "Validation Error",
            message: "First and last names must be at least 2 characters long.",
            duration: 5000,
          });
          return;
        }

        // Validate display name
        if (displayName.length < 2) {
          e.preventDefault();
          globalServices.showNotification({
            type: "error",
            title: "Validation Error",
            message: "Display name must be at least 2 characters long.",
            duration: 5000,
          });
          return;
        }

        // Validate password
        if (password.length < 6) {
          e.preventDefault();
          globalServices.showNotification({
            type: "error",
            title: "Validation Error",
            message: "Password must be at least 6 characters long.",
            duration: 5000,
          });
          return;
        }

        // Show loading notification
        globalServices.showNotification({
          type: "info",
          title: "Creating Account...",
          message: "Please wait while we set up your account.",
          duration: 3000,
        });
      });
    }
  });
</script>
