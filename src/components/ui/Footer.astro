---
const { globalCompanyName, isBackend } = Astro.props;

import { checkAuth } from "@/lib/auth";
const { currentUser } = await checkAuth(Astro.cookies);

// Get theme from cookie for server-side rendering
const themeCookie = Astro.cookies.get("theme");
const theme = (themeCookie?.value as "light" | "dark") || "light";

import Tooltip from "@/components/common/Tooltip.astro";
import VapiChatWidget from "@/features/vapi-chat-widget/VapiChatWidget.astro";
---

<footer
  class="font-secondary flex max-w-screen-xl mx-auto w-full gap-2 mt-4 p-4 items-center justify-between relative pt-0 z-10"
>
  <div class="align-center flex justify-center space-x-3">
    <Tooltip
      position="right"
      text={`${new Date().getFullYear().toString()} ${globalCompanyName}. 
        All rights reserved.`}
      >Â©
    </Tooltip>
    <ul class="align-center flex justify-center text-gray-500 dark:text-gray-400">
      <li>
        <a href="/privacy" class="me-6 no-underline hover:underline"> privacy </a>
      </li>
      <li>
        <a href="/terms" class="me-6 no-underline hover:underline"> terms </a>
      </li>
      <li>
        <a href="/cookies" class="no-underline hover:underline"> cookie </a>
      </li>
    </ul>

    <!-- Legal Links -->
  </div>

  <div class="align-center justify-center space-x-3 w-full hidden">
    <div class="flex flex-wrap items-center justify-center gap-4 md:justify-end">
      <!-- Certificate images temporarily disabled to fix console errors -->
      <!-- <img
        src="/img/cert-afsa.png"
        alt="AFSA Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale md:w-20"
      />
      <img
        src="/img/cert-hfsc.jpg"
        alt="HFSC Certification"
        class="h-auto w-16 max-w-[40px] object-contain grayscale md:w-20"
      />
      <img
        src="/img/NFPA_logo.svg"
        alt="NFPA Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale hover:grayscale-0 md:w-20"
      />
      <img
        src="/img/cert-nfsa.png"
        alt="NFSA Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale md:w-20"
      />
      <img
        src="/img/cert-nicet.png"
        alt="NICET Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale md:w-20"
      />
      <img
        src="/img/cert-sfpe.png"
        alt="SFPE Certification"
        class="h-auto w-16 max-w-[20px] object-contain grayscale md:w-20"
      /> -->
    </div>
  </div>
  <div class="align-center flex justify-center space-x-3 w-8">
    <!-- VAPI Voice Chat Widget (Fixed Bottom Right) -->
    <!-- Debug: Show VAPI widget status -->
    <!-- currentUser: {currentUser ? "LOGGED IN" : "NOT LOGGED IN"} -->
    <!-- isBackend: {isBackend ? "TRUE" : "FALSE"} -->

    {!currentUser && !isBackend && <VapiChatWidget basic={true} theme={theme} />}
  </div>
</footer>
