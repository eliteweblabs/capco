---
import Tooltip from "../common/TooltipFloating.astro";
import SimpleIcon from "../common/SimpleIcon.astro";
import { globalCompanyData } from "../../pages/api/global/global-company-data";

const { globalIconButtonClasses } = await Astro.props;
---

<!-- <button id="theme-toggle" data-tooltip-target="tooltip-toggle" type="button" class="mveJTCIb2WII7J4sY22F Z4DH5a4vmjReSFRBpPgz c8dCx6gnV43hTOLV6ks5 PeR2JZ9BZHYIH8Ea3F36 _7KA5gD55t2lxf9Jkj20 BkIbg_JwkgiyRW804Hhu _q0p_O8QLU1paqtuqmI2 _6wdnQrxT_dGdAdNk5AQ XIIs8ZOri3wm8Wnj9N_y OPrb_iG5WDy_7F05BDOX yChACvAr1v8czJ2VO22j">
  <svg id="theme-toggle-dark-icon" class="MnxxlQlR1H0xJuMEE8Yr YIUegm7fh_CpJbivTu6B" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
    <path d="M12.3224 5.68708c.2935-.31028.3575-.77266.1594-1.15098-.1981-.37832-.6146-.5891-1.0368-.52467-1.50847.2302-2.93175.83665-4.12869 1.76276-1.19717.92628-2.12732 2.1411-2.69465 3.52702-.56744 1.38619-.75115 2.89299-.53164 4.37079.2195 1.4776.83393 2.8711 1.77895 4.0436.9448 1.1722 2.18683 2.0826 3.60103 2.6449 1.414.5623 2.9539.7584 4.4683.57 1.5145-.1884 2.9549-.7551 4.1784-1.6475 1.2237-.8924 2.1892-2.0806 2.7972-3.4499.1723-.3879.0809-.8423-.2279-1.1335-.3089-.2911-.7679-.3556-1.145-.1608-.8631.4459-1.8291.6799-2.8118.6791h-.0018c-1.1598.0013-2.2925-.3234-3.2596-.931-.9667-.6074-1.7244-1.4697-2.1856-2.4779-.4611-1.0078-.6079-2.1209-.4243-3.20511.1835-1.08442.6905-2.09837 1.4645-2.91681Z"></path>
  </svg>

  <svg id="theme-toggle-light-icon" class="MnxxlQlR1H0xJuMEE8Yr YIUegm7fh_CpJbivTu6B _SmdlCf6eUKB_V9S5IDj" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
    <path fill-rule="evenodd" d="M13 3a1 1 0 1 0-2 0v2a1 1 0 1 0 2 0V3ZM6.343 4.929A1 1 0 0 0 4.93 6.343l1.414 1.414a1 1 0 0 0 1.414-1.414L6.343 4.929Zm12.728 1.414a1 1 0 0 0-1.414-1.414l-1.414 1.414a1 1 0 0 0 1.414 1.414l1.414-1.414ZM12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm-9 4a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2H3Zm16 0a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2h-2ZM7.757 17.657a1 1 0 1 0-1.414-1.414l-1.414 1.414a1 1 0 1 0 1.414 1.414l1.414-1.414Zm9.9-1.414a1 1 0 0 0-1.414 1.414l1.414 1.414a1 1 0 0 0 1.414-1.414l-1.414-1.414ZM13 19a1 1 0 1 0-2 0v2a1 1 0 1 0 2 0v-2Z" clip-rule="evenodd"></path>
  </svg>
</button>
<div id="tooltip-toggle" role="tooltip" class="H78G_4yayxs5C3xdFbnK pq2JRWtiWcwYnw3xueNl QhmQ_v3mmDFIP9VaVOfb VPGGthdu3cy_ZP7AL7dt mveJTCIb2WII7J4sY22F foDHZclRWUf2bqma2a8U _Cj_M6jt2eLjDgkBBNgI b9aD6g2qw84oyZNsMO8j c8dCx6gnV43hTOLV6ks5 ezMFUVl744lvw6ht0lFe y6GKdvUrd7vp_pxsFb57 fzhbbDQ686T8arwvi_bJ mc9bwhBTHL8mVzJvl6gz rqOAGYeDo9iWuroePkaf Db4Wzva4DMepJJiQLY7M ZBSHeVK3dmgzHTRX3hLO" style="position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate3d(459px, 57.5px, 0px);" data-popper-placement="bottom">
  Toggle dark mode
  <div class="tkX8MMO2MiTlgtbd_jG3" data-popper-arrow="" style="position: absolute; left: 0px; transform: translate3d(69px, 0px, 0px);"></div>
</div> -->
<a id="theme-toggle" type="button" title="Toggle dark mode" class={globalIconButtonClasses}>
  <Tooltip text="Toggle dark mode" position="bottom">
    <SimpleIcon
      name="moon"
      size="md"
      id="theme-toggle-dark-icon"
      class={"hidden text-black dark:text-white"}
    />
  </Tooltip>
  <Tooltip text="Toggle light mode" position="bottom">
    <SimpleIcon
      name="sun"
      size="md"
      id="theme-toggle-light-icon"
      class={`hidden text-black dark:text-white`}
    />
  </Tooltip>
  <span class="sr-only">Toggle dark mode</span>
</a>

<script>
  // Theme toggle functionality
  function initThemeToggle() {
    const themeToggle = document.getElementById("theme-toggle");
    const darkIcon = document.getElementById("theme-toggle-dark-icon");
    const lightIcon = document.getElementById("theme-toggle-light-icon");

    if (!themeToggle || !darkIcon || !lightIcon) return;

    // Set initial state (dark mode is already initialized in App.astro)
    const isDark = document.documentElement.classList.contains("dark");

    isDark ? document.documentElement.classList.add("zD1iTsv7EQco3GO_szee") : "";

    // Remove hidden class from the appropriate icon
    if (isDark) {
      darkIcon.classList.add("hidden");
      lightIcon.classList.remove("hidden");
    } else {
      darkIcon.classList.remove("hidden");
      lightIcon.classList.add("hidden");
    }

    themeToggle.addEventListener("click", function () {
      const isDark = document.documentElement.classList.contains("dark");
      const newTheme = isDark ? "light" : "dark";

      if (isDark) {
        // Switch to light
        document.documentElement.classList.remove("dark", "zD1iTsv7EQco3GO_szee");
        localStorage.setItem("color-theme", "light");
        darkIcon.classList.remove("hidden");
        lightIcon.classList.add("hidden");
      } else {
        // Switch to dark
        document.documentElement.classList.add("dark", "zD1iTsv7EQco3GO_szee");
        localStorage.setItem("color-theme", "dark");
        darkIcon.classList.add("hidden");
        lightIcon.classList.remove("hidden");
      }

      // Update cookie
      document.cookie = `theme=${newTheme}; path=/; max-age=31536000; SameSite=Lax`;
      console.log("[THEME-TOGGLE] Theme changed to:", newTheme);
      console.log("[THEME-TOGGLE] Cookie set to:", newTheme);

      // Update window.currentTheme
      if (window.currentTheme !== undefined) {
        window.currentTheme = newTheme;
      }

      // Sync theme-synced elements
      if (window.updateThemeSync) {
        window.updateThemeSync();
      }
    });
  }

  document.addEventListener("DOMContentLoaded", initThemeToggle);
</script>
