---
/**
 * Notification bell button with dropdown panel for the navbar.
 * Uses Flowbite popover: data-popover-target points to notifications-dropdown.
 * Renders nothing when currentUser is absent (user not logged in).
 */
import SimpleIcon from "../common/SimpleIcon.astro";
import NotificationsDropdown from "./NotificationsDropdown.astro";
import { globalClasses } from "../../pages/api/global/global-classes";

const { globalDropdownClose } = globalClasses();

interface Props {
  currentUser?: any;
  globalIconButtonClasses?: string;
}

const { currentUser, globalIconButtonClasses = "" } = Astro.props;
---

{currentUser && (
<>
<button
  type="button"
  id="notification-bell"
  title="Notifications"
  popovertarget="notifications-dropdown"
  popovertargetaction="toggle"
  class={`relative ${globalIconButtonClasses}`}
  aria-label="View notifications"
>
  <span class="auth-icon-default" aria-hidden="true">
    <SimpleIcon name="notification-bell" size="md" />
  </span>
  <span
    class={globalDropdownClose}
    aria-hidden="true"
    style="opacity: 0; pointer-events: none;"
  >
    <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M6 18L18 6M6 6l12 12"
      />
    </svg>
  </span>
  <span class="sr-only">Notifications</span>
</button>
<NotificationsDropdown
  id="notifications"
  closeButton={false}
  globalIconButtonClasses={globalIconButtonClasses}
  {currentUser}
/>
</>
)}
