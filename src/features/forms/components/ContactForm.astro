---
import { globalCompanyData } from "../../../pages/api/global/global-company-data";
import ConfigForm from "./ConfigForm.astro";
import { getContactFormConfig } from "../../../lib/forms/form-config-from-site";
import { buildFormInitialDataFromUser } from "../../../lib/forms/form-initial-data-from-user";
import { checkAuth } from "../../../lib/auth";

const { currentUser } = await checkAuth(Astro.cookies);
const { globalCompanyName, virtualAssistantName } = await globalCompanyData();
const contactFormConfig = await getContactFormConfig(globalCompanyName, virtualAssistantName);
const initialData = buildFormInitialDataFromUser(currentUser);
---

<ConfigForm config={contactFormConfig} {initialData} />
