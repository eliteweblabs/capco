---
/**
 * Media Manager Admin Page
 * Uses MediaFilter component for the main content
 */
const requireAuthRedirect = "/auth/login";
import { checkAuth } from "../../lib/auth";

const { currentUser, session, supabase } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role;

// Handle auth redirect - Admin only
if (requireAuthRedirect && (!session || !currentUser || currentRole !== "Admin")) {
  return Astro.redirect(requireAuthRedirect);
}

import { globalClasses } from "../api/global/global-classes";
const { globalInputClasses, primaryTextClasses, secondaryTextClasses } = globalClasses();

import LayoutDefault from "../../components/layouts/LayoutDefault.astro";
import MediaFilter from "../../features/media-filter/MediaFilter.astro";
import AdminMedia from "../../components/admin/AdminMedia.astro";
---

<LayoutDefault title="Media Manager" description="Browse, upload, and manage all media files across the system">
  <div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Media Manager</h1>
    <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">
      Browse, upload, and manage all media files across the system.
    </p>
  </div>

  <!-- <AdminMedia {currentUser} {supabase} /> -->
  <MediaFilter
    {currentUser}
    {supabase}
    sourceFilters={["All", "Project", "Global"]}
    typeFilters={["All", "Images", "PDFs", "Documents", "Other"]}
    showSearch={true}
    minSearchChars={2}
    searchPlaceholder="Search media files..."
    {globalInputClasses}
    includeGrid={true}
  />
</LayoutDefault>
