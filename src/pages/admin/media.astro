---
/**
 * Media Manager Admin Page
 * Uses MediaFilter component for the main content
 */
const requireAuthRedirect = "/auth/login";
import { checkAuth } from "../../lib/auth";

const { currentUser, session, supabase } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role;

// Handle auth redirect - Admin only
if (requireAuthRedirect && (!session || !currentUser || currentRole !== "Admin")) {
  return Astro.redirect(requireAuthRedirect);
}

import { globalClasses } from "../api/global/global-classes";
const { globalInputClasses, primaryTextClasses, secondaryTextClasses } = globalClasses();

import MediaFilter from "../../features/media-filter/MediaFilter.astro";
import LayoutFullScreen from "../../components/layouts/LayoutFullscreen.astro";
import HeroDashboard from "@/components/common/HeroDashboard.astro";
import Hero from "@/components/common/Hero.astro";
---

<LayoutFullScreen
  title="Media Manager"
  description="Browse, upload, and manage all media files across the system"
>
  <Hero
    title="Project Media Manager"
    description="Browse, upload, and manage all media files across the project"
  />

  <!-- <AdminMedia {currentUser} {supabase} /> -->
  <MediaFilter
    {currentUser}
    {supabase}
    sourceFilters={["All", "Project", "Global"]}
    typeFilters={["All", "Images", "Videos", "PDFs", "Documents", "Other"]}
    showSearch={true}
    minSearchChars={2}
    searchPlaceholder="Search media files..."
    {globalInputClasses}
    includeGrid={true}
  />
</LayoutFullScreen>
