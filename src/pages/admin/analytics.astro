---
/**
 * Analytics Dashboard Admin Page
 * Uses AdminAnalytics component for the main content
 */
import LayoutDefault from "../../components/layouts/LayoutDefault.astro";
import { checkAuth } from "../../lib/auth";
import AdminAnalytics from "../../components/admin/AdminAnalytics.astro";

const { currentUser, session, supabase } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role || "Client";

if (!currentUser) {
  return Astro.redirect("/auth/login");
}

if (currentRole !== "Admin") {
  return Astro.redirect("/dashboard");
}
---

<LayoutDefault
  title="Analytics Dashboard"
  description="Real-time website analytics and insights"
>
  <div class="py-6 sm:px-0">
    <AdminAnalytics {currentUser} />
  </div>
</LayoutDefault>
