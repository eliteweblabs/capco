---
/**
 * Analytics Dashboard Admin Page
 * Uses AdminAnalytics component for the main content
 */
import App from "../../components/ui/App.astro";
import { checkAuth } from "../../lib/auth";
import AdminAnalytics from "../../components/admin/AdminAnalytics.astro";

const { currentUser, session, supabase } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role || "Client";

if (!currentUser) {
  return Astro.redirect("/auth/login");
}

if (currentRole !== "Admin") {
  return Astro.redirect("/dashboard");
}
---

<App
  title="Analytics Dashboard"
  description="Real-time website analytics and insights"
  {currentUser}
  {session}
  {supabase}
  isBackend={true}
>
  <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
    <AdminAnalytics {currentUser} />
  </div>
</App>
