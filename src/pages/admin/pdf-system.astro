---
import LayoutFullWidth from "../../components/layouts/LayoutFullWidth.astro";
import PDFSystem from "../../features/pdf-system/PDFSystem.astro";
import { checkAuth } from "../../lib/auth";
import { globalClasses } from "../api/global/global-classes";

const { currentUser, session, supabase } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role || "Client";
const { globalInputClasses, secondaryTextClasses, primaryTextClasses } = globalClasses();

// For development: allow access without authentication
// In production, you might want to re-enable these checks
if (!currentUser) {
  return Astro.redirect("/auth/login");
}

if (currentRole !== "Admin") {
  return Astro.redirect("/dashboard");
}
---

<LayoutFullWidth title="PDF System" description="Manage PDF documents and templates" classList="p-4">
  <PDFSystem {globalInputClasses} {secondaryTextClasses} {primaryTextClasses} />
</LayoutFullWidth>
