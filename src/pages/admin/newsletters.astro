---
/**
 * Newsletter Management Admin Page
 * Admin-only page for creating and sending newsletters
 */
const requireAuthRedirect = "/auth/login";
import { checkAuth } from "../../lib/auth";

const { currentUser, session, supabase } = await checkAuth(Astro.cookies);

// Handle auth redirect first
if (requireAuthRedirect && (!session || !currentUser || currentUser?.profile?.role !== "Admin")) {
  return Astro.redirect(requireAuthRedirect);
}

import { globalClasses } from "../api/global/global-classes";
const { globalInputClasses, primaryTextClasses, secondaryTextClasses } = globalClasses();

import LayoutFullWidth from "../../components/layouts/LayoutFullWidth.astro";
import Hero from "../../components/common/Hero.astro";
import NewsletterManager from "../../features/newsletters/components/NewsletterManager.astro";
---

<LayoutFullWidth
  title="Newsletter Management"
  classList="p-4"
  description="Create and manage newsletters to send to users via email and SMS"
>
  <Hero
    title="Newsletter Management"
    description="Create and manage newsletters to send to users via email and SMS"
    {primaryTextClasses}
    {secondaryTextClasses}
  />

  <NewsletterManager />
</LayoutFullWidth>
