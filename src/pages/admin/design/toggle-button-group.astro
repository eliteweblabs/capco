---
/**
 * Design demo: Toggle / Button Group
 * Several contained versions including multi-select with "All" toggle.
 */
import { checkAuth } from "../../../lib/auth";
import LayoutDefault from "../../../components/layouts/LayoutDefault.astro";
import ToggleButtonGroupComp from "../../../components/form/ToggleButtonGroup.astro";
import { globalClasses } from "../../api/global/global-classes";

const { currentUser, session } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role;

if (!currentUser || !session) {
  return Astro.redirect("/auth/login");
}
if (currentRole !== "Admin") {
  return Astro.redirect("/dashboard");
}

const { primaryTextClasses, mutedTextClasses } = globalClasses();

const inspectionButtons = [
  { label: "Yes", dataValue: "yes" },
  { label: "No", dataValue: "no" },
  { label: "N/A", dataValue: "na" },
];

const frequencyButtons = [
  { label: "Daily", value: "daily" },
  { label: "Weekly", value: "weekly" },
  { label: "Monthly", value: "monthly" },
  { label: "Quarterly", value: "quarterly" },
];

const codeSampleButtons =
  'buttons: [{ "type": "choice", "label": "Yes", "dataValue": "yes" }, ...]';
---

<LayoutDefault
  title="Button Group Demo"
  description="ToggleButtonGroup – radio, multi-select, and multi-select with All toggle. All demos contained."
>
  <div class="px-4 py-8">
    <h1 class={`mb-2 text-3xl font-bold ${primaryTextClasses}`}>Toggle / Button Group</h1>
    <p class={`mb-6 ${mutedTextClasses}`}>
      Several versions below; each is self-contained. One includes an <strong>All</strong> toggle for
      multi-select.
    </p>

    <div class="space-y-6">
      <!-- Version 1: Radio (single choice) -->
      <section
        class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-900"
        aria-labelledby="version-1-heading"
      >
        <h2 id="version-1-heading" class={`${primaryTextClasses} mb-3 text-xl font-semibold`}>
          Version 1 — Radio (single choice)
        </h2>
        <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
          Inspection-style: <code class="rounded bg-gray-100 px-1 dark:bg-gray-800"
            >toggleType="radio"</code
          >, config shape <code class="rounded bg-gray-100 px-1 dark:bg-gray-800"
            >{codeSampleButtons}</code
          >.
        </p>
        <div
          class="rounded-lg border border-gray-100 bg-gray-50/50 p-4 dark:border-gray-800 dark:bg-gray-800/30"
        >
          <ToggleButtonGroupComp
            name="design-demo-radio"
            buttons={inspectionButtons}
            toggleType="radio"
          />
        </div>
      </section>

      <!-- Version 2: Multi-select (no All) -->
      <section
        class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-900"
        aria-labelledby="version-2-heading"
      >
        <h2 id="version-2-heading" class={`${primaryTextClasses} mb-3 text-xl font-semibold`}>
          Version 2 — Multi-select
        </h2>
        <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
          Multiple choices; <code class="rounded bg-gray-100 px-1 dark:bg-gray-800"
            >toggleType="multi-select"</code
          >.
        </p>
        <div
          class="rounded-lg border border-gray-100 bg-gray-50/50 p-4 dark:border-gray-800 dark:bg-gray-800/30"
        >
          <ToggleButtonGroupComp
            name="design-demo-multi"
            buttons={frequencyButtons}
            toggleType="multi-select"
          />
        </div>
      </section>

      <!-- Version 3: Multi-select with All toggle -->
      <section
        class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-900"
        aria-labelledby="version-3-heading"
      >
        <h2 id="version-3-heading" class={`${primaryTextClasses} mb-3 text-xl font-semibold`}>
          Version 3 — Multi-select with <strong>All</strong> toggle
        </h2>
        <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
          <code class="rounded bg-gray-100 px-1 dark:bg-gray-800">allToggle={true}</code>. Selecting
          &quot;All&quot; clears others; selecting any other deselects &quot;All&quot;.
        </p>
        <div
          class="rounded-lg border border-gray-100 bg-gray-50/50 p-4 dark:border-gray-800 dark:bg-gray-800/30"
        >
          <ToggleButtonGroupComp
            name="design-demo-all"
            buttons={frequencyButtons}
            toggleType="multi-select"
            allToggle={true}
          />
        </div>
      </section>

      <!-- Version 4: Choice (form flow) + pre-selected -->
      <section
        class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-900"
        aria-labelledby="version-4-heading"
      >
        <h2 id="version-4-heading" class={`${primaryTextClasses} mb-3 text-xl font-semibold`}>
          Version 4 — Radio with pre-selected
        </h2>
        <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
          <code class="rounded bg-gray-100 px-1 dark:bg-gray-800">initialValues</code> or <code
            class="rounded bg-gray-100 px-1 dark:bg-gray-800">selected</code
          > on options.
        </p>
        <div
          class="rounded-lg border border-gray-100 bg-gray-50/50 p-4 dark:border-gray-800 dark:bg-gray-800/30"
        >
          <ToggleButtonGroupComp
            name="design-demo-initial"
            buttons={[
              { label: "Yes", dataValue: "yes" },
              { label: "No", dataValue: "no", selected: true },
              { label: "N/A", dataValue: "na" },
            ]}
            toggleType="radio"
          />
        </div>
      </section>
    </div>
  </div>
</LayoutDefault>
