---
/**
 * Global Discussions Admin Page
 * Uses AdminDiscussions component for the main content
 */
import { checkAuth } from "../../lib/auth";
const { currentUser, session, supabase } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role;

// Redirect to login if not authenticated
if (!currentUser || !session) {
  return Astro.redirect("/auth/login");
}

import { globalCompanyData } from "../api/global/global-company-data";
const {
  globalCompanyName,
  globalCompanySlogan,
  globalCompanyAddress,
  globalCompanyPhone,
  globalCompanyEmail,
  globalCompanyWebsite,
  globalCompanyLogo,
} = await globalCompanyData();

import { globalClasses } from "../api/global/global-classes";
const { globalInputClasses, primaryTextClasses, secondaryTextClasses } = globalClasses();

import App from "../../components/ui/App.astro";
import AdminDiscussions from "../../components/admin/AdminDiscussions.astro";
---

<App
  title="Global Discussions"
  description="Monitor all project discussions and conversations across the platform."
  {currentUser}
  project={undefined}
  {session}
  {supabase}
  isBackend={true}
  {globalCompanyName}
  {globalCompanySlogan}
  {globalCompanyAddress}
  {globalCompanyPhone}
  {globalCompanyEmail}
  {globalCompanyWebsite}
  {globalCompanyLogo}
  {primaryTextClasses}
  {secondaryTextClasses}
  {globalInputClasses}
>
  <AdminDiscussions
    {currentUser}
    {globalInputClasses}
    {primaryTextClasses}
    {secondaryTextClasses}
  />
</App>
