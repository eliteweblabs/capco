---
/**
 * Global Activity Feed Admin Page
 * Uses AdminGlobalActivity component for the main content
 */
import { checkAuth } from "../../lib/auth";
import { isAdminOrSuperAdmin } from "../../lib/user-utils";
const { currentUser, session, supabase } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role;

// Redirect to login if not authenticated
if (!currentUser || !session) {
  return Astro.redirect("/auth/login");
}

if (!isAdminOrSuperAdmin(currentRole)) {
  return Astro.redirect("/dashboard");
}

import { globalClasses } from "../api/global/global-classes";
const { globalInputClasses, primaryTextClasses, secondaryTextClasses } = globalClasses();

import LayoutFullWidth from "../../components/layouts/LayoutFullWidth.astro";
import AdminGlobalActivity from "../../components/admin/AdminGlobalActivity.astro";
---

<LayoutFullWidth
  title="Global Activity Feed"
  description="Monitor all project activities and user actions"
  classList="p-4"
>
  <AdminGlobalActivity
    {currentUser}
    {globalInputClasses}
    {primaryTextClasses}
    {secondaryTextClasses}
    limit={100}
  />
</LayoutFullWidth>
