---
/**
 * Design index â€“ list of design component pages from config (asideNav design.children).
 * Each element has its own page under /admin/design/<slug>.
 */
import { checkAuth } from "../../lib/auth";
import LayoutDefault from "../../components/layouts/LayoutDefault.astro";
import { globalClasses } from "../api/global/global-classes";
import { getDesignPageLinks } from "../../lib/aside-nav-config";

const { currentUser, session } = await checkAuth(Astro.cookies);
const currentRole = currentUser?.profile?.role;

if (!currentUser || !session) {
  return Astro.redirect("/auth/login");
}
if (currentRole !== "Admin") {
  return Astro.redirect("/dashboard");
}

const { primaryTextClasses, secondaryTextClasses } = globalClasses();

const designPages =
  (await getDesignPageLinks(currentRole)) ||
  [
    { label: "Accordion Data Table", href: "/admin/design/data-table-accordion" },
    { label: "Alert Block", href: "/admin/design/alert-block" },
    { label: "Breadcrumb", href: "/admin/design/breadcrumb" },
    { label: "Buttons", href: "/admin/design/buttons" },
    { label: "Button Group", href: "/admin/design/toggle-button-group" },
    { label: "CTA Block", href: "/admin/design/cta-block" },
    { label: "FAQ Block", href: "/admin/design/faq-block" },
    { label: "Form", href: "/admin/design/form" },
    { label: "Hero", href: "/admin/design/hero" },
    { label: "Image Slider", href: "/admin/design/image-slider" },
    { label: "Loading Spinner", href: "/admin/design/loading-spinner" },
    { label: "Logo Cloud Block", href: "/admin/design/logo-cloud-block" },
    { label: "Layouts", href: "/admin/design/layouts" },
    { label: "MultiStep Form", href: "/admin/design/multistepform" },
    { label: "Placeholders", href: "/admin/design/placeholders" },
    { label: "Pricing Card", href: "/admin/design/pricing-card" },
    { label: "Slide Toggle", href: "/admin/design/slide-toggle" },
    { label: "Sliding Tab", href: "/admin/design/sliding-tab" },
    { label: "Stats Block", href: "/admin/design/stats-block" },
    { label: "Testimonials", href: "/admin/design/testimonials" },
    { label: "Timeline Block", href: "/admin/design/timeline-block" },
    { label: "Tooltip", href: "/admin/design/tooltip" },
  ];
---

<LayoutDefault
  title="Design"
  description="Design system component demos. Each element has its own page."
>
  <div class="px-4 py-8">
    <div class="mb-8">
      <h1 class={`mb-2 text-3xl font-bold ${primaryTextClasses}`}>Design</h1>
      <p class={`${secondaryTextClasses} text-gray-600 dark:text-gray-400`}>
        Component demos in alphabetical order. Use the sidebar or the list below.
      </p>
    </div>

    <ul class="grid gap-2 sm:grid-cols-2 lg:grid-cols-3">
      {
        designPages.map(({ label, href }) => (
          <li>
            <a
              href={href}
              class="block rounded-lg border border-gray-200 bg-white p-4 transition-colors hover:bg-gray-50 hover:border-primary-300 dark:border-gray-700 dark:bg-gray-900 dark:hover:bg-gray-800 dark:hover:border-primary-600"
            >
              <span class={`font-medium ${primaryTextClasses}`}>{label}</span>
            </a>
          </li>
        ))
      }
    </ul>
  </div>
</LayoutDefault>
