---
// Tooltip partial - makes the Tooltip component accessible as a partial
import TooltipComponent from "../../components/common/Tooltip.astro";

// Check if we have props (when used as component) or need to use headers (when used as partial)
const hasProps = Object.keys(Astro.props).length > 0;

let text, position, className, tooltipClass, disabled, open, slotContent;

if (hasProps) {
  // Use props when available (prioritize props over headers)
  const props = Astro.props;
  text = props.text || "";
  position = props.position || "top";
  className = props.className;
  tooltipClass = props.tooltipClass;
  disabled = props.disabled || false;
  open = props.open || false;
  slotContent = props.slotContent;
} else {
  // Fall back to headers when used as partial
  text = Astro.request.headers.get("x-tooltip-text") || "";
  position = Astro.request.headers.get("x-tooltip-position") || "top";
  className = Astro.request.headers.get("x-tooltip-class-name");
  tooltipClass = Astro.request.headers.get("x-tooltip-class");
  disabled = Astro.request.headers.get("x-tooltip-disabled") === "true";
  open = Astro.request.headers.get("x-tooltip-open") === "true";
  slotContent = Astro.request.headers.get("x-tooltip-slot-content");
}
---

<TooltipComponent
  {text}
  position={position as "top" | "bottom" | "left" | "right"}
  {className}
  {tooltipClass}
  {disabled}
  {open}
>
  {slotContent ? <Fragment set:html={slotContent} /> : <slot />}
</TooltipComponent>
