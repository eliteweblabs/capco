---
import { checkAuth } from "../lib/auth";
const { currentUser, session, supabase, refreshToken, accessToken } = await checkAuth(
  Astro.cookies
);
const currentRole = currentUser?.profile?.role || "Client";

import App from "../components/common/App.astro";
import CalComBooking from "../components/common/CalComBooking.astro";
import Hero from "../components/common/Hero.astro";
import VapiChatWidget from "../components/vapi/VapiChatWidget.astro";
---

<App
  title="Book a Demo"
  description="Schedule a personalized demo of our fire protection system management platform. See how we can streamline your workflow."
>
  <!-- Hero Section -->
  <Hero
    title="Book a Demo"
    description="Schedule a personalized demo of our fire protection system management platform. See how we can streamline your workflow."
  />
  <!-- Cal.com Booking Section -->
  <CalComBooking {currentUser} />

  <!-- VAPI Voice Chat Widget (Fixed Bottom Right) -->
  <VapiChatWidget
    assistantId="3ae002d5-fe9c-4870-8034-4c66a9b43b51"
    publicKey="77cb0a47-2427-44ac-996d-e6ed2ca03bbf"
  />

  <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"
    ></path>
  </svg>
  Voice Assistant Testing
</App>
