---
/**
 * Home Page - Root Route Handler
 * 
 * This file handles the root route (/). It renders the default home page
 * components. If content/pages/home.md exists, the catch-all route [...slug].astro
 * would handle it, but index.astro takes precedence for the root route.
 */

import { checkAuth } from "../lib/auth";
import LayoutFullWidth from "../components/layouts/LayoutFullWidth.astro";
import NodesCapco from "../components/ui/NodesCapco.astro";
import LandingProductCapco from "../components/layouts/LandingProductCapco.astro";
import { globalCompanyData } from "./api/global/global-company-data";

// Get auth state
const { currentUser, session, supabase } = await checkAuth(Astro.cookies);

// Get company data for page metadata
const {
  globalCompanyName,
  globalCompanySlogan,
} = await globalCompanyData();
---

<LayoutFullWidth
  title={globalCompanyName || "Fire Protection Services"}
  description={globalCompanySlogan || "Professional fire protection plan review and approval"}
  {currentUser}
  {session}
  {supabase}
>
  <NodesCapco />
  <LandingProductCapco />
</LayoutFullWidth>

