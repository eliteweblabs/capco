---
// Define requireAuthRedirect
const requireAuthRedirect = undefined;
// Make sure to check above value before redirecting
import Button from "../components/common/Button.astro";
import { checkAuth } from "../lib/auth";
// Handle OAuth callback if code is present
const { currentUser, session, supabase } = await checkAuth(Astro.cookies);
// Handle auth redirect first
if (requireAuthRedirect && (!session || !currentUser)) {
  return Astro.redirect(requireAuthRedirect);
}

import { globalCompanyData } from "../pages/api/global-company-data";
const {
  globalCompanyName,
  globalCompanySlogan,
  globalCompanyAddress,
  globalCompanyPhone,
  globalCompanyEmail,
  globalCompanyWebsite,
  globalCompanyLogo,
  globalCompanyLogoDark,
  globalCompanyLogoLight,
} = globalCompanyData();

import { globalClasses } from "../pages/api/global-classes";
const { globalInputClasses, globalPrimaryTextClasses, globalSecondaryTextClasses } =
  globalClasses();

import App from "../components/common/App.astro";

import ContactFormWithUpload from "../components/common/ContactFormWithUpload.astro";
import Features from "../components/common/Features.astro";
import FlowbiteStatsGrid from "../components/common/FlowbiteStatsGrid.astro";
import Hero from "../components/common/Hero.astro";
import Testimonials from "../components/common/Testimonials.astro";

// Get auth data for conditional rendering

const stats = [
  {
    title: "Total Projects",
    value: "1,024",
    change: { value: "12%", type: "increase" as const },
    icon: "ðŸ“Š",
    color: "blue" as const,
  },
  {
    title: "Active Users",
    value: "357",
    change: { value: "8%", type: "increase" as const },
    icon: "ðŸ‘¥",
    color: "green" as const,
  },
  // {
  //   title: "Revenue",
  //   value: "$45,678",
  //   change: { value: "15%", type: "increase" as const },
  //   icon: "ðŸ’°",
  //   color: "purple" as const,
  // },
  {
    title: "Approval Rate",
    value: "97.5%",
    change: { value: "3%", type: "increase" as const },
    icon: "ðŸ“ˆ",
    color: "yellow" as const,
  },
];
---

<App
  title={`${globalCompanyName} - ${globalCompanySlogan}`}
  description={globalCompanySlogan}
  currentUser={currentUser}
  session={session || undefined}
  project={undefined}
  supabase={supabase}
  globalCompanyName={globalCompanyName}
  globalCompanyName={globalCompanyName}
  globalCompanySlogan={globalCompanySlogan}
  globalPrimaryTextClasses={globalPrimaryTextClasses}
  globalSecondaryTextClasses={globalSecondaryTextClasses}
  globalInputClasses={globalInputClasses}
>
  <div class="RZmKBZs1E1eXw8vkE6jY p_2EXc_a2sDA_h41l8QU">
    <div
      class="mveJTCIb2WII7J4sY22F _Ybd3WwuTVljUT4vEaM3 _wYiJGbRZyFZeCc8y7Sf mngKhi_Rv06PF57lblDI _1jTZ8KXRZul60S6czNi LSIxp7RSuOKhsg28v_u3"
    >
      <!-- Hero Section -->

      <Hero
        title={globalCompanyName || ""}
        description={globalCompanySlogan || ""}
        globalPrimaryTextClasses={globalPrimaryTextClasses}
        globalSecondaryTextClasses={globalSecondaryTextClasses}
        globalInputClasses={globalInputClasses}
      />

      <div
        class="RZmKBZs1E1eXw8vkE6jY p_2EXc_a2sDA_h41l8QU mx-auto flex max-w-2xl items-center justify-center pb-6"
      >
        <div class="inset-0 mx-auto flex max-w-2xl items-center justify-center pb-6">
          <Button
            href="/login?tab=register"
            variant="primary"
            size="lg"
            icon="user-plus"
            iconPosition="left"
            class="w-full"
          >
            Create Account
          </Button>
        </div>
      </div>
    </div>
  </div>

  <div class="cellular_maps__IWnVr mapboxgl-map">
    <div class="mapboxgl-canary" style="visibility: hidden;"></div><div
      class="mapboxgl-canvas-container mapboxgl-interactive mapboxgl-touch-drag-pan"
    >
      <canvas
        class="mapboxgl-canvas"
        tabindex="0"
        aria-label="Map"
        role="region"
        width="502"
        height="1004"
        style="width: 251px; height: 502px;"></canvas><div
        class="undefined mapboxgl-marker mapboxgl-marker-anchor-bottom"
        aria-label="Map marker"
        role="img"
        style="transform: translate(126px, 251px) translate(-50%, -100%) translate(0px, 0px); opacity: 0.951862; pointer-events: auto;"
      >
      </div>
    </div><div class="mapboxgl-control-container">
      <div class="mapboxgl-ctrl-top-left"></div><div class="mapboxgl-ctrl-top"></div><div
        class="mapboxgl-ctrl-top-right"
      >
      </div><div class="mapboxgl-ctrl-right">
        <div class="mapboxgl-ctrl mapboxgl-ctrl-group"></div>
      </div><div class="mapboxgl-ctrl-bottom-right">
        <div class="mapboxgl-ctrl mapboxgl-ctrl-attrib mapboxgl-compact">
          <button class="mapboxgl-ctrl-attrib-button" type="button" aria-label="Toggle attribution"
            ><span class="mapboxgl-ctrl-icon" aria-hidden="true" title="Toggle attribution"
            ></span></button
          ><div class="mapboxgl-ctrl-attrib-inner">
            <a
              href="https://www.mapbox.com/about/maps/"
              target="_blank"
              title="Mapbox"
              aria-label="Mapbox">Â© Mapbox</a
            >
            <a
              href="https://www.openstreetmap.org/copyright/"
              target="_blank"
              title="OpenStreetMap"
              aria-label="OpenStreetMap">Â© OpenStreetMap</a
            >
            <a
              class="mapbox-improve-map"
              href="https://apps.mapbox.com/feedback/?owner=xiak&id=cm1uffojx005w01rdcf7q1h99&access_token=pk.eyJ1IjoieGlhayIsImEiOiJjbG5vMGV2Y2swOXppMmpwZG1jYnRyMnhmIn0.FpPkmcf72TdatL0MjMjGPQ#/-122.40944/37.76201/16.5/-41/63"
              target="_blank"
              title="Improve this map"
              aria-label="Improve this map"
              rel="noopener nofollow">Improve this map</a>
          </div>
        </div>
      </div><div class="mapboxgl-ctrl-bottom"></div><div class="mapboxgl-ctrl-bottom-left">
        <div class="mapboxgl-ctrl" style="display: block;">
          <a
            class="mapboxgl-ctrl-logo"
            target="_blank"
            rel="noopener nofollow"
            href="https://www.mapbox.com/"
            aria-label="Mapbox homepage"></a>
        </div>
      </div><div class="mapboxgl-ctrl-left"></div>
    </div>
  </div>

  <div class="RZmKBZs1E1eXw8vkE6jY p_2EXc_a2sDA_h41l8QU">
    <div
      class="mveJTCIb2WII7J4sY22F _Ybd3WwuTVljUT4vEaM3 _wYiJGbRZyFZeCc8y7Sf mngKhi_Rv06PF57lblDI _1jTZ8KXRZul60S6czNi LSIxp7RSuOKhsg28v_u3"
    >
      <FlowbiteStatsGrid
        stats={stats}
        columns={3}
        globalPrimaryTextClasses={globalPrimaryTextClasses}
        globalSecondaryTextClasses={globalSecondaryTextClasses}
        globalInputClasses={globalInputClasses}
      />
    </div>
  </div>

  <div class="RZmKBZs1E1eXw8vkE6jY p_2EXc_a2sDA_h41l8QU">
    <div
      class="mveJTCIb2WII7J4sY22F _Ybd3WwuTVljUT4vEaM3 _wYiJGbRZyFZeCc8y7Sf mngKhi_Rv06PF57lblDI _1jTZ8KXRZul60S6czNi LSIxp7RSuOKhsg28v_u3"
    >
      <!-- Features Section -->
      <Features
        globalPrimaryTextClasses={globalPrimaryTextClasses}
        globalSecondaryTextClasses={globalSecondaryTextClasses}
        globalInputClasses={globalInputClasses}
      />
    </div>
  </div>

  <div class="RZmKBZs1E1eXw8vkE6jY p_2EXc_a2sDA_h41l8QU">
    <div
      class="mveJTCIb2WII7J4sY22F _Ybd3WwuTVljUT4vEaM3 _wYiJGbRZyFZeCc8y7Sf mngKhi_Rv06PF57lblDI _1jTZ8KXRZul60S6czNi LSIxp7RSuOKhsg28v_u3"
    >
      <!-- Testimonials Section -->
      <Testimonials
        globalCompanyName={globalCompanyName || ""}
        globalPrimaryTextClasses={globalPrimaryTextClasses}
        globalSecondaryTextClasses={globalSecondaryTextClasses}
        globalInputClasses={globalInputClasses}
      />
    </div>
  </div>

  {
    !currentUser && (
      <div class="RZmKBZs1E1eXw8vkE6jY p_2EXc_a2sDA_h41l8QU">
        <div class="mveJTCIb2WII7J4sY22F _Ybd3WwuTVljUT4vEaM3 _wYiJGbRZyFZeCc8y7Sf mngKhi_Rv06PF57lblDI _1jTZ8KXRZul60S6czNi LSIxp7RSuOKhsg28v_u3">
          <ContactFormWithUpload globalInputClasses={globalInputClasses} />
        </div>
      </div>
    )
  }
</App>
