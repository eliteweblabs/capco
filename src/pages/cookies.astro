---
import App from "../components/common/App.astro";
---

<App
  title="Cookie Preferences - CAPCo Fire Protection"
  description="Manage your cookie preferences and learn about how CAPCo uses cookies to enhance your experience."
>
  <div class="container mx-auto px-4 py-8 max-w-4xl">
    <div class="prose prose-lg dark:prose-invert max-w-none">
      <h1 class="text-3xl font-bold text-text-primary dark:text-text-primary-dark mb-8">Cookie Preferences</h1>

      <div
        class="bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-800 rounded-lg p-6 mb-8"
      >
        <p class="text-primary-800 dark:text-primary-200 mb-0">
          <strong>Last Updated:</strong>
          {new Date().toLocaleDateString()}
        </p>
      </div>

      <p class="text-text-secondary dark:text-text-secondary-dark mb-8">
        We use cookies and similar technologies to enhance your browsing experience, provide personalized content, 
        and analyze our traffic. You can manage your cookie preferences below or learn more about our cookie usage 
        in our <a href="/privacy-policy" class="text-primary-600 dark:text-primary-400 hover:underline">Privacy Policy</a>.
      </p>

      <!-- Cookie Categories -->
      <div class="space-y-6 mb-8">
        <!-- Essential Cookies -->
        <div class="bg-background-card dark:bg-background-card-dark rounded-lg border border-border-light dark:border-border-dark p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="text-lg font-semibold text-text-primary dark:text-text-primary-dark mb-2">
                Essential Cookies
              </h3>
              <p class="text-sm text-text-secondary dark:text-text-secondary-dark">
                These cookies are necessary for the website to function and cannot be switched off.
              </p>
            </div>
            <div class="flex items-center">
              <span class="bg-success-100 dark:bg-success-900/30 text-success-800 dark:text-success-200 px-3 py-1 rounded-full text-sm font-medium">
                Always Active
              </span>
            </div>
          </div>
          <div class="text-sm text-text-muted dark:text-text-muted">
            <p class="mb-2">These cookies enable basic functions like:</p>
            <ul class="list-disc list-inside space-y-1">
              <li>User authentication and session management</li>
              <li>Security features and fraud prevention</li>
              <li>Remembering your login status</li>
              <li>Basic website functionality</li>
            </ul>
          </div>
        </div>

        <!-- Analytics Cookies -->
        <div class="bg-background-card dark:bg-background-card-dark rounded-lg border border-border-light dark:border-border-dark p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="text-lg font-semibold text-text-primary dark:text-text-primary-dark mb-2">
                Analytics Cookies
              </h3>
              <p class="text-sm text-text-secondary dark:text-text-secondary-dark">
                These cookies help us understand how visitors interact with our website.
              </p>
            </div>
            <div class="flex items-center">
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" class="sr-only peer" id="analytics-toggle" checked>
                <div class="w-11 h-6 bg-neutral-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-neutral-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-neutral-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-neutral-600 peer-checked:bg-primary-600"></div>
              </label>
            </div>
          </div>
          <div class="text-sm text-text-muted dark:text-text-muted">
            <p class="mb-2">These cookies collect anonymous information about:</p>
            <ul class="list-disc list-inside space-y-1">
              <li>Page views and user interactions</li>
              <li>Website performance and loading times</li>
              <li>Popular content and features</li>
              <li>Error tracking and debugging</li>
            </ul>
          </div>
        </div>

        <!-- Functional Cookies -->
        <div class="bg-background-card dark:bg-background-card-dark rounded-lg border border-border-light dark:border-border-dark p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="text-lg font-semibold text-text-primary dark:text-text-primary-dark mb-2">
                Functional Cookies
              </h3>
              <p class="text-sm text-text-secondary dark:text-text-secondary-dark">
                These cookies enable enhanced functionality and personalization.
              </p>
            </div>
            <div class="flex items-center">
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" class="sr-only peer" id="functional-toggle" checked>
                <div class="w-11 h-6 bg-neutral-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-neutral-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-neutral-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-neutral-600 peer-checked:bg-primary-600"></div>
              </label>
            </div>
          </div>
          <div class="text-sm text-text-muted dark:text-text-muted">
            <p class="mb-2">These cookies remember your preferences for:</p>
            <ul class="list-disc list-inside space-y-1">
              <li>Language and region settings</li>
              <li>Theme preferences (light/dark mode)</li>
              <li>Customized dashboard layouts</li>
              <li>Form auto-completion</li>
            </ul>
          </div>
        </div>

        <!-- Marketing Cookies -->
        <div class="bg-background-card dark:bg-background-card-dark rounded-lg border border-border-light dark:border-border-dark p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="text-lg font-semibold text-text-primary dark:text-text-primary-dark mb-2">
                Marketing Cookies
              </h3>
              <p class="text-sm text-text-secondary dark:text-text-secondary-dark">
                These cookies are used to deliver relevant advertisements and track marketing campaigns.
              </p>
            </div>
            <div class="flex items-center">
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" class="sr-only peer" id="marketing-toggle">
                <div class="w-11 h-6 bg-neutral-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 dark:peer-focus:ring-primary-800 rounded-full peer dark:bg-neutral-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-neutral-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-neutral-600 peer-checked:bg-primary-600"></div>
              </label>
            </div>
          </div>
          <div class="text-sm text-text-muted dark:text-text-muted">
            <p class="mb-2">These cookies may be used to:</p>
            <ul class="list-disc list-inside space-y-1">
              <li>Show relevant advertisements</li>
              <li>Track campaign effectiveness</li>
              <li>Limit ad frequency</li>
              <li>Measure ad performance</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-col sm:flex-row gap-4 mb-8">
        <button
          id="save-preferences"
          class="px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium"
        >
          Save Preferences
        </button>
        <button
          id="accept-all"
          class="px-6 py-3 bg-success-600 text-white rounded-lg hover:bg-success-700 transition-colors font-medium"
        >
          Accept All Cookies
        </button>
        <button
          id="reject-all"
          class="px-6 py-3 bg-neutral-600 text-white rounded-lg hover:bg-neutral-700 transition-colors font-medium"
        >
          Reject All Optional
        </button>
      </div>

      <!-- Additional Information -->
      <div class="bg-neutral-50 dark:bg-neutral-900 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-text-primary dark:text-text-primary-dark mb-4">
          Additional Information
        </h3>
        <div class="space-y-4 text-sm text-text-secondary dark:text-text-secondary-dark">
          <p>
            <strong>Browser Settings:</strong> You can also manage cookies through your browser settings. 
            Most browsers allow you to refuse cookies or delete them. However, disabling cookies may 
            affect the functionality of our website.
          </p>
          <p>
            <strong>Third-Party Cookies:</strong> Some cookies on our website are set by third-party 
            services that appear on our pages. We do not control these cookies, and you should check 
            the third-party websites for more information about their cookies and how to manage them.
          </p>
          <p>
            <strong>Updates:</strong> We may update this Cookie Preferences page from time to time. 
            Any changes will be posted on this page with an updated revision date.
          </p>
        </div>
      </div>

      <div class="mt-8 pt-6 border-t border-border-light dark:border-border-dark">
        <p class="text-sm text-text-muted dark:text-text-muted">
          For more detailed information about our data practices, please review our 
          <a href="/privacy-policy" class="text-primary-600 dark:text-primary-400 hover:underline">Privacy Policy</a>.
        </p>
      </div>
    </div>
  </div>

  <script>
    // Cookie preference management
    document.addEventListener('DOMContentLoaded', function() {
      const analyticsToggle = document.getElementById('analytics-toggle');
      const functionalToggle = document.getElementById('functional-toggle');
      const marketingToggle = document.getElementById('marketing-toggle');
      const saveBtn = document.getElementById('save-preferences');
      const acceptAllBtn = document.getElementById('accept-all');
      const rejectAllBtn = document.getElementById('reject-all');

      // Load current preferences
      function loadPreferences() {
        const prefs = JSON.parse(localStorage.getItem('cookiePreferences') || '{}');
        analyticsToggle.checked = prefs.analytics !== false;
        functionalToggle.checked = prefs.functional !== false;
        marketingToggle.checked = prefs.marketing === true;
      }

      // Save preferences
      function savePreferences() {
        const preferences = {
          analytics: analyticsToggle.checked,
          functional: functionalToggle.checked,
          marketing: marketingToggle.checked,
          timestamp: new Date().toISOString()
        };
        localStorage.setItem('cookiePreferences', JSON.stringify(preferences));
        
        // Show confirmation
        alert('Your cookie preferences have been saved!');
      }

      // Accept all
      function acceptAll() {
        analyticsToggle.checked = true;
        functionalToggle.checked = true;
        marketingToggle.checked = true;
        savePreferences();
      }

      // Reject all optional
      function rejectAll() {
        analyticsToggle.checked = false;
        functionalToggle.checked = false;
        marketingToggle.checked = false;
        savePreferences();
      }

      // Event listeners
      saveBtn.addEventListener('click', savePreferences);
      acceptAllBtn.addEventListener('click', acceptAll);
      rejectAllBtn.addEventListener('click', rejectAll);

      // Load preferences on page load
      loadPreferences();
    });
  </script>
</App>
