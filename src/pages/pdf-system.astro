---
import App from "../components/common/App.astro";
import PDFSystem from "../components/project/PDFSystem.astro";
import { supabase } from "../lib/supabase";

// Get current user
if (!supabase) {
  return Astro.redirect("/auth/login");
}
const {
  data: { user },
  error: authError,
} = await supabase.auth.getUser();

if (authError || !user) {
  return Astro.redirect("/auth/login");
}

// Get user profile
const { data: profile } = await supabase.from("profiles").select("*").eq("id", user.id).single();
---

<App title="PDF System - CAPCo Fire Protection">
  <div class="min-h-screen bg-gray-50 dark:bg-gray-900">
    <div class="container mx-auto px-4 py-8">
      <PDFSystem
        currentUser={user}
        globalInputClasses="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white"
        globalSecondaryTextClasses="text-gray-600 dark:text-gray-400"
        globalPrimaryTextClasses="text-gray-900 dark:text-white"
      />
    </div>
  </div>
</App>
