revoke delete on table "public"."ai_agent_conversations" from "anon";

revoke insert on table "public"."ai_agent_conversations" from "anon";

revoke references on table "public"."ai_agent_conversations" from "anon";

revoke select on table "public"."ai_agent_conversations" from "anon";

revoke trigger on table "public"."ai_agent_conversations" from "anon";

revoke truncate on table "public"."ai_agent_conversations" from "anon";

revoke update on table "public"."ai_agent_conversations" from "anon";

revoke delete on table "public"."ai_agent_conversations" from "authenticated";

revoke insert on table "public"."ai_agent_conversations" from "authenticated";

revoke references on table "public"."ai_agent_conversations" from "authenticated";

revoke select on table "public"."ai_agent_conversations" from "authenticated";

revoke trigger on table "public"."ai_agent_conversations" from "authenticated";

revoke truncate on table "public"."ai_agent_conversations" from "authenticated";

revoke update on table "public"."ai_agent_conversations" from "authenticated";

revoke delete on table "public"."ai_agent_conversations" from "service_role";

revoke insert on table "public"."ai_agent_conversations" from "service_role";

revoke references on table "public"."ai_agent_conversations" from "service_role";

revoke select on table "public"."ai_agent_conversations" from "service_role";

revoke trigger on table "public"."ai_agent_conversations" from "service_role";

revoke truncate on table "public"."ai_agent_conversations" from "service_role";

revoke update on table "public"."ai_agent_conversations" from "service_role";

revoke delete on table "public"."ai_agent_knowledge" from "anon";

revoke insert on table "public"."ai_agent_knowledge" from "anon";

revoke references on table "public"."ai_agent_knowledge" from "anon";

revoke select on table "public"."ai_agent_knowledge" from "anon";

revoke trigger on table "public"."ai_agent_knowledge" from "anon";

revoke truncate on table "public"."ai_agent_knowledge" from "anon";

revoke update on table "public"."ai_agent_knowledge" from "anon";

revoke delete on table "public"."ai_agent_knowledge" from "authenticated";

revoke insert on table "public"."ai_agent_knowledge" from "authenticated";

revoke references on table "public"."ai_agent_knowledge" from "authenticated";

revoke select on table "public"."ai_agent_knowledge" from "authenticated";

revoke trigger on table "public"."ai_agent_knowledge" from "authenticated";

revoke truncate on table "public"."ai_agent_knowledge" from "authenticated";

revoke update on table "public"."ai_agent_knowledge" from "authenticated";

revoke delete on table "public"."ai_agent_knowledge" from "service_role";

revoke insert on table "public"."ai_agent_knowledge" from "service_role";

revoke references on table "public"."ai_agent_knowledge" from "service_role";

revoke select on table "public"."ai_agent_knowledge" from "service_role";

revoke trigger on table "public"."ai_agent_knowledge" from "service_role";

revoke truncate on table "public"."ai_agent_knowledge" from "service_role";

revoke update on table "public"."ai_agent_knowledge" from "service_role";

revoke delete on table "public"."ai_agent_messages" from "anon";

revoke insert on table "public"."ai_agent_messages" from "anon";

revoke references on table "public"."ai_agent_messages" from "anon";

revoke select on table "public"."ai_agent_messages" from "anon";

revoke trigger on table "public"."ai_agent_messages" from "anon";

revoke truncate on table "public"."ai_agent_messages" from "anon";

revoke update on table "public"."ai_agent_messages" from "anon";

revoke delete on table "public"."ai_agent_messages" from "authenticated";

revoke insert on table "public"."ai_agent_messages" from "authenticated";

revoke references on table "public"."ai_agent_messages" from "authenticated";

revoke select on table "public"."ai_agent_messages" from "authenticated";

revoke trigger on table "public"."ai_agent_messages" from "authenticated";

revoke truncate on table "public"."ai_agent_messages" from "authenticated";

revoke update on table "public"."ai_agent_messages" from "authenticated";

revoke delete on table "public"."ai_agent_messages" from "service_role";

revoke insert on table "public"."ai_agent_messages" from "service_role";

revoke references on table "public"."ai_agent_messages" from "service_role";

revoke select on table "public"."ai_agent_messages" from "service_role";

revoke trigger on table "public"."ai_agent_messages" from "service_role";

revoke truncate on table "public"."ai_agent_messages" from "service_role";

revoke update on table "public"."ai_agent_messages" from "service_role";

revoke delete on table "public"."ai_agent_project_memory" from "anon";

revoke insert on table "public"."ai_agent_project_memory" from "anon";

revoke references on table "public"."ai_agent_project_memory" from "anon";

revoke select on table "public"."ai_agent_project_memory" from "anon";

revoke trigger on table "public"."ai_agent_project_memory" from "anon";

revoke truncate on table "public"."ai_agent_project_memory" from "anon";

revoke update on table "public"."ai_agent_project_memory" from "anon";

revoke delete on table "public"."ai_agent_project_memory" from "authenticated";

revoke insert on table "public"."ai_agent_project_memory" from "authenticated";

revoke references on table "public"."ai_agent_project_memory" from "authenticated";

revoke select on table "public"."ai_agent_project_memory" from "authenticated";

revoke trigger on table "public"."ai_agent_project_memory" from "authenticated";

revoke truncate on table "public"."ai_agent_project_memory" from "authenticated";

revoke update on table "public"."ai_agent_project_memory" from "authenticated";

revoke delete on table "public"."ai_agent_project_memory" from "service_role";

revoke insert on table "public"."ai_agent_project_memory" from "service_role";

revoke references on table "public"."ai_agent_project_memory" from "service_role";

revoke select on table "public"."ai_agent_project_memory" from "service_role";

revoke trigger on table "public"."ai_agent_project_memory" from "service_role";

revoke truncate on table "public"."ai_agent_project_memory" from "service_role";

revoke update on table "public"."ai_agent_project_memory" from "service_role";

revoke delete on table "public"."ai_agent_usage" from "anon";

revoke insert on table "public"."ai_agent_usage" from "anon";

revoke references on table "public"."ai_agent_usage" from "anon";

revoke select on table "public"."ai_agent_usage" from "anon";

revoke trigger on table "public"."ai_agent_usage" from "anon";

revoke truncate on table "public"."ai_agent_usage" from "anon";

revoke update on table "public"."ai_agent_usage" from "anon";

revoke delete on table "public"."ai_agent_usage" from "authenticated";

revoke insert on table "public"."ai_agent_usage" from "authenticated";

revoke references on table "public"."ai_agent_usage" from "authenticated";

revoke select on table "public"."ai_agent_usage" from "authenticated";

revoke trigger on table "public"."ai_agent_usage" from "authenticated";

revoke truncate on table "public"."ai_agent_usage" from "authenticated";

revoke update on table "public"."ai_agent_usage" from "authenticated";

revoke delete on table "public"."ai_agent_usage" from "service_role";

revoke insert on table "public"."ai_agent_usage" from "service_role";

revoke references on table "public"."ai_agent_usage" from "service_role";

revoke select on table "public"."ai_agent_usage" from "service_role";

revoke trigger on table "public"."ai_agent_usage" from "service_role";

revoke truncate on table "public"."ai_agent_usage" from "service_role";

revoke update on table "public"."ai_agent_usage" from "service_role";

revoke delete on table "public"."ai_generated_documents" from "anon";

revoke insert on table "public"."ai_generated_documents" from "anon";

revoke references on table "public"."ai_generated_documents" from "anon";

revoke select on table "public"."ai_generated_documents" from "anon";

revoke trigger on table "public"."ai_generated_documents" from "anon";

revoke truncate on table "public"."ai_generated_documents" from "anon";

revoke update on table "public"."ai_generated_documents" from "anon";

revoke delete on table "public"."ai_generated_documents" from "authenticated";

revoke insert on table "public"."ai_generated_documents" from "authenticated";

revoke references on table "public"."ai_generated_documents" from "authenticated";

revoke select on table "public"."ai_generated_documents" from "authenticated";

revoke trigger on table "public"."ai_generated_documents" from "authenticated";

revoke truncate on table "public"."ai_generated_documents" from "authenticated";

revoke update on table "public"."ai_generated_documents" from "authenticated";

revoke delete on table "public"."ai_generated_documents" from "service_role";

revoke insert on table "public"."ai_generated_documents" from "service_role";

revoke references on table "public"."ai_generated_documents" from "service_role";

revoke select on table "public"."ai_generated_documents" from "service_role";

revoke trigger on table "public"."ai_generated_documents" from "service_role";

revoke truncate on table "public"."ai_generated_documents" from "service_role";

revoke update on table "public"."ai_generated_documents" from "service_role";

revoke delete on table "public"."ai_generations" from "anon";

revoke insert on table "public"."ai_generations" from "anon";

revoke references on table "public"."ai_generations" from "anon";

revoke select on table "public"."ai_generations" from "anon";

revoke trigger on table "public"."ai_generations" from "anon";

revoke truncate on table "public"."ai_generations" from "anon";

revoke update on table "public"."ai_generations" from "anon";

revoke delete on table "public"."ai_generations" from "authenticated";

revoke insert on table "public"."ai_generations" from "authenticated";

revoke references on table "public"."ai_generations" from "authenticated";

revoke select on table "public"."ai_generations" from "authenticated";

revoke trigger on table "public"."ai_generations" from "authenticated";

revoke truncate on table "public"."ai_generations" from "authenticated";

revoke update on table "public"."ai_generations" from "authenticated";

revoke delete on table "public"."ai_generations" from "service_role";

revoke insert on table "public"."ai_generations" from "service_role";

revoke references on table "public"."ai_generations" from "service_role";

revoke select on table "public"."ai_generations" from "service_role";

revoke trigger on table "public"."ai_generations" from "service_role";

revoke truncate on table "public"."ai_generations" from "service_role";

revoke update on table "public"."ai_generations" from "service_role";

revoke delete on table "public"."bannerAlerts" from "anon";

revoke insert on table "public"."bannerAlerts" from "anon";

revoke references on table "public"."bannerAlerts" from "anon";

revoke select on table "public"."bannerAlerts" from "anon";

revoke trigger on table "public"."bannerAlerts" from "anon";

revoke truncate on table "public"."bannerAlerts" from "anon";

revoke update on table "public"."bannerAlerts" from "anon";

revoke delete on table "public"."bannerAlerts" from "authenticated";

revoke insert on table "public"."bannerAlerts" from "authenticated";

revoke references on table "public"."bannerAlerts" from "authenticated";

revoke select on table "public"."bannerAlerts" from "authenticated";

revoke trigger on table "public"."bannerAlerts" from "authenticated";

revoke truncate on table "public"."bannerAlerts" from "authenticated";

revoke update on table "public"."bannerAlerts" from "authenticated";

revoke delete on table "public"."bannerAlerts" from "service_role";

revoke insert on table "public"."bannerAlerts" from "service_role";

revoke references on table "public"."bannerAlerts" from "service_role";

revoke select on table "public"."bannerAlerts" from "service_role";

revoke trigger on table "public"."bannerAlerts" from "service_role";

revoke truncate on table "public"."bannerAlerts" from "service_role";

revoke update on table "public"."bannerAlerts" from "service_role";

revoke delete on table "public"."chatMessages" from "anon";

revoke insert on table "public"."chatMessages" from "anon";

revoke references on table "public"."chatMessages" from "anon";

revoke select on table "public"."chatMessages" from "anon";

revoke trigger on table "public"."chatMessages" from "anon";

revoke truncate on table "public"."chatMessages" from "anon";

revoke update on table "public"."chatMessages" from "anon";

revoke delete on table "public"."chatMessages" from "authenticated";

revoke insert on table "public"."chatMessages" from "authenticated";

revoke references on table "public"."chatMessages" from "authenticated";

revoke select on table "public"."chatMessages" from "authenticated";

revoke trigger on table "public"."chatMessages" from "authenticated";

revoke truncate on table "public"."chatMessages" from "authenticated";

revoke update on table "public"."chatMessages" from "authenticated";

revoke delete on table "public"."chatMessages" from "service_role";

revoke insert on table "public"."chatMessages" from "service_role";

revoke references on table "public"."chatMessages" from "service_role";

revoke select on table "public"."chatMessages" from "service_role";

revoke trigger on table "public"."chatMessages" from "service_role";

revoke truncate on table "public"."chatMessages" from "service_role";

revoke update on table "public"."chatMessages" from "service_role";

revoke delete on table "public"."cmsPages" from "anon";

revoke insert on table "public"."cmsPages" from "anon";

revoke references on table "public"."cmsPages" from "anon";

revoke select on table "public"."cmsPages" from "anon";

revoke trigger on table "public"."cmsPages" from "anon";

revoke truncate on table "public"."cmsPages" from "anon";

revoke update on table "public"."cmsPages" from "anon";

revoke delete on table "public"."cmsPages" from "authenticated";

revoke insert on table "public"."cmsPages" from "authenticated";

revoke references on table "public"."cmsPages" from "authenticated";

revoke select on table "public"."cmsPages" from "authenticated";

revoke trigger on table "public"."cmsPages" from "authenticated";

revoke truncate on table "public"."cmsPages" from "authenticated";

revoke update on table "public"."cmsPages" from "authenticated";

revoke delete on table "public"."cmsPages" from "service_role";

revoke insert on table "public"."cmsPages" from "service_role";

revoke references on table "public"."cmsPages" from "service_role";

revoke select on table "public"."cmsPages" from "service_role";

revoke trigger on table "public"."cmsPages" from "service_role";

revoke truncate on table "public"."cmsPages" from "service_role";

revoke update on table "public"."cmsPages" from "service_role";

revoke delete on table "public"."contactSubmissions" from "anon";

revoke insert on table "public"."contactSubmissions" from "anon";

revoke references on table "public"."contactSubmissions" from "anon";

revoke select on table "public"."contactSubmissions" from "anon";

revoke trigger on table "public"."contactSubmissions" from "anon";

revoke truncate on table "public"."contactSubmissions" from "anon";

revoke update on table "public"."contactSubmissions" from "anon";

revoke delete on table "public"."contactSubmissions" from "authenticated";

revoke insert on table "public"."contactSubmissions" from "authenticated";

revoke references on table "public"."contactSubmissions" from "authenticated";

revoke select on table "public"."contactSubmissions" from "authenticated";

revoke trigger on table "public"."contactSubmissions" from "authenticated";

revoke truncate on table "public"."contactSubmissions" from "authenticated";

revoke update on table "public"."contactSubmissions" from "authenticated";

revoke delete on table "public"."contactSubmissions" from "service_role";

revoke insert on table "public"."contactSubmissions" from "service_role";

revoke references on table "public"."contactSubmissions" from "service_role";

revoke select on table "public"."contactSubmissions" from "service_role";

revoke trigger on table "public"."contactSubmissions" from "service_role";

revoke truncate on table "public"."contactSubmissions" from "service_role";

revoke update on table "public"."contactSubmissions" from "service_role";

revoke delete on table "public"."demo_bookings" from "anon";

revoke insert on table "public"."demo_bookings" from "anon";

revoke references on table "public"."demo_bookings" from "anon";

revoke select on table "public"."demo_bookings" from "anon";

revoke trigger on table "public"."demo_bookings" from "anon";

revoke truncate on table "public"."demo_bookings" from "anon";

revoke update on table "public"."demo_bookings" from "anon";

revoke delete on table "public"."demo_bookings" from "authenticated";

revoke insert on table "public"."demo_bookings" from "authenticated";

revoke references on table "public"."demo_bookings" from "authenticated";

revoke select on table "public"."demo_bookings" from "authenticated";

revoke trigger on table "public"."demo_bookings" from "authenticated";

revoke truncate on table "public"."demo_bookings" from "authenticated";

revoke update on table "public"."demo_bookings" from "authenticated";

revoke delete on table "public"."demo_bookings" from "service_role";

revoke insert on table "public"."demo_bookings" from "service_role";

revoke references on table "public"."demo_bookings" from "service_role";

revoke select on table "public"."demo_bookings" from "service_role";

revoke trigger on table "public"."demo_bookings" from "service_role";

revoke truncate on table "public"."demo_bookings" from "service_role";

revoke update on table "public"."demo_bookings" from "service_role";

revoke delete on table "public"."directMessages" from "anon";

revoke insert on table "public"."directMessages" from "anon";

revoke references on table "public"."directMessages" from "anon";

revoke select on table "public"."directMessages" from "anon";

revoke trigger on table "public"."directMessages" from "anon";

revoke truncate on table "public"."directMessages" from "anon";

revoke update on table "public"."directMessages" from "anon";

revoke delete on table "public"."directMessages" from "authenticated";

revoke insert on table "public"."directMessages" from "authenticated";

revoke references on table "public"."directMessages" from "authenticated";

revoke select on table "public"."directMessages" from "authenticated";

revoke trigger on table "public"."directMessages" from "authenticated";

revoke truncate on table "public"."directMessages" from "authenticated";

revoke update on table "public"."directMessages" from "authenticated";

revoke delete on table "public"."directMessages" from "service_role";

revoke insert on table "public"."directMessages" from "service_role";

revoke references on table "public"."directMessages" from "service_role";

revoke select on table "public"."directMessages" from "service_role";

revoke trigger on table "public"."directMessages" from "service_role";

revoke truncate on table "public"."directMessages" from "service_role";

revoke update on table "public"."directMessages" from "service_role";

revoke delete on table "public"."discussion" from "anon";

revoke insert on table "public"."discussion" from "anon";

revoke references on table "public"."discussion" from "anon";

revoke select on table "public"."discussion" from "anon";

revoke trigger on table "public"."discussion" from "anon";

revoke truncate on table "public"."discussion" from "anon";

revoke update on table "public"."discussion" from "anon";

revoke delete on table "public"."discussion" from "authenticated";

revoke insert on table "public"."discussion" from "authenticated";

revoke references on table "public"."discussion" from "authenticated";

revoke select on table "public"."discussion" from "authenticated";

revoke trigger on table "public"."discussion" from "authenticated";

revoke truncate on table "public"."discussion" from "authenticated";

revoke update on table "public"."discussion" from "authenticated";

revoke delete on table "public"."discussion" from "service_role";

revoke insert on table "public"."discussion" from "service_role";

revoke references on table "public"."discussion" from "service_role";

revoke select on table "public"."discussion" from "service_role";

revoke trigger on table "public"."discussion" from "service_role";

revoke truncate on table "public"."discussion" from "service_role";

revoke update on table "public"."discussion" from "service_role";

revoke delete on table "public"."documentComponents" from "anon";

revoke insert on table "public"."documentComponents" from "anon";

revoke references on table "public"."documentComponents" from "anon";

revoke select on table "public"."documentComponents" from "anon";

revoke trigger on table "public"."documentComponents" from "anon";

revoke truncate on table "public"."documentComponents" from "anon";

revoke update on table "public"."documentComponents" from "anon";

revoke delete on table "public"."documentComponents" from "authenticated";

revoke insert on table "public"."documentComponents" from "authenticated";

revoke references on table "public"."documentComponents" from "authenticated";

revoke select on table "public"."documentComponents" from "authenticated";

revoke trigger on table "public"."documentComponents" from "authenticated";

revoke truncate on table "public"."documentComponents" from "authenticated";

revoke update on table "public"."documentComponents" from "authenticated";

revoke delete on table "public"."documentComponents" from "service_role";

revoke insert on table "public"."documentComponents" from "service_role";

revoke references on table "public"."documentComponents" from "service_role";

revoke select on table "public"."documentComponents" from "service_role";

revoke trigger on table "public"."documentComponents" from "service_role";

revoke truncate on table "public"."documentComponents" from "service_role";

revoke update on table "public"."documentComponents" from "service_role";

revoke delete on table "public"."documentTemplates" from "anon";

revoke insert on table "public"."documentTemplates" from "anon";

revoke references on table "public"."documentTemplates" from "anon";

revoke select on table "public"."documentTemplates" from "anon";

revoke trigger on table "public"."documentTemplates" from "anon";

revoke truncate on table "public"."documentTemplates" from "anon";

revoke update on table "public"."documentTemplates" from "anon";

revoke delete on table "public"."documentTemplates" from "authenticated";

revoke insert on table "public"."documentTemplates" from "authenticated";

revoke references on table "public"."documentTemplates" from "authenticated";

revoke select on table "public"."documentTemplates" from "authenticated";

revoke trigger on table "public"."documentTemplates" from "authenticated";

revoke truncate on table "public"."documentTemplates" from "authenticated";

revoke update on table "public"."documentTemplates" from "authenticated";

revoke delete on table "public"."documentTemplates" from "service_role";

revoke insert on table "public"."documentTemplates" from "service_role";

revoke references on table "public"."documentTemplates" from "service_role";

revoke select on table "public"."documentTemplates" from "service_role";

revoke trigger on table "public"."documentTemplates" from "service_role";

revoke truncate on table "public"."documentTemplates" from "service_role";

revoke update on table "public"."documentTemplates" from "service_role";

revoke delete on table "public"."feedback" from "anon";

revoke insert on table "public"."feedback" from "anon";

revoke references on table "public"."feedback" from "anon";

revoke select on table "public"."feedback" from "anon";

revoke trigger on table "public"."feedback" from "anon";

revoke truncate on table "public"."feedback" from "anon";

revoke update on table "public"."feedback" from "anon";

revoke delete on table "public"."feedback" from "authenticated";

revoke insert on table "public"."feedback" from "authenticated";

revoke references on table "public"."feedback" from "authenticated";

revoke select on table "public"."feedback" from "authenticated";

revoke trigger on table "public"."feedback" from "authenticated";

revoke truncate on table "public"."feedback" from "authenticated";

revoke update on table "public"."feedback" from "authenticated";

revoke delete on table "public"."feedback" from "service_role";

revoke insert on table "public"."feedback" from "service_role";

revoke references on table "public"."feedback" from "service_role";

revoke select on table "public"."feedback" from "service_role";

revoke trigger on table "public"."feedback" from "service_role";

revoke truncate on table "public"."feedback" from "service_role";

revoke update on table "public"."feedback" from "service_role";

revoke delete on table "public"."fileCheckoutHistory" from "anon";

revoke insert on table "public"."fileCheckoutHistory" from "anon";

revoke references on table "public"."fileCheckoutHistory" from "anon";

revoke select on table "public"."fileCheckoutHistory" from "anon";

revoke trigger on table "public"."fileCheckoutHistory" from "anon";

revoke truncate on table "public"."fileCheckoutHistory" from "anon";

revoke update on table "public"."fileCheckoutHistory" from "anon";

revoke delete on table "public"."fileCheckoutHistory" from "authenticated";

revoke insert on table "public"."fileCheckoutHistory" from "authenticated";

revoke references on table "public"."fileCheckoutHistory" from "authenticated";

revoke select on table "public"."fileCheckoutHistory" from "authenticated";

revoke trigger on table "public"."fileCheckoutHistory" from "authenticated";

revoke truncate on table "public"."fileCheckoutHistory" from "authenticated";

revoke update on table "public"."fileCheckoutHistory" from "authenticated";

revoke delete on table "public"."fileCheckoutHistory" from "service_role";

revoke insert on table "public"."fileCheckoutHistory" from "service_role";

revoke references on table "public"."fileCheckoutHistory" from "service_role";

revoke select on table "public"."fileCheckoutHistory" from "service_role";

revoke trigger on table "public"."fileCheckoutHistory" from "service_role";

revoke truncate on table "public"."fileCheckoutHistory" from "service_role";

revoke update on table "public"."fileCheckoutHistory" from "service_role";

revoke delete on table "public"."fileCheckouts" from "anon";

revoke insert on table "public"."fileCheckouts" from "anon";

revoke references on table "public"."fileCheckouts" from "anon";

revoke select on table "public"."fileCheckouts" from "anon";

revoke trigger on table "public"."fileCheckouts" from "anon";

revoke truncate on table "public"."fileCheckouts" from "anon";

revoke update on table "public"."fileCheckouts" from "anon";

revoke delete on table "public"."fileCheckouts" from "authenticated";

revoke insert on table "public"."fileCheckouts" from "authenticated";

revoke references on table "public"."fileCheckouts" from "authenticated";

revoke select on table "public"."fileCheckouts" from "authenticated";

revoke trigger on table "public"."fileCheckouts" from "authenticated";

revoke truncate on table "public"."fileCheckouts" from "authenticated";

revoke update on table "public"."fileCheckouts" from "authenticated";

revoke delete on table "public"."fileCheckouts" from "service_role";

revoke insert on table "public"."fileCheckouts" from "service_role";

revoke references on table "public"."fileCheckouts" from "service_role";

revoke select on table "public"."fileCheckouts" from "service_role";

revoke trigger on table "public"."fileCheckouts" from "service_role";

revoke truncate on table "public"."fileCheckouts" from "service_role";

revoke update on table "public"."fileCheckouts" from "service_role";

revoke delete on table "public"."fileVersions" from "anon";

revoke insert on table "public"."fileVersions" from "anon";

revoke references on table "public"."fileVersions" from "anon";

revoke select on table "public"."fileVersions" from "anon";

revoke trigger on table "public"."fileVersions" from "anon";

revoke truncate on table "public"."fileVersions" from "anon";

revoke update on table "public"."fileVersions" from "anon";

revoke delete on table "public"."fileVersions" from "authenticated";

revoke insert on table "public"."fileVersions" from "authenticated";

revoke references on table "public"."fileVersions" from "authenticated";

revoke select on table "public"."fileVersions" from "authenticated";

revoke trigger on table "public"."fileVersions" from "authenticated";

revoke truncate on table "public"."fileVersions" from "authenticated";

revoke update on table "public"."fileVersions" from "authenticated";

revoke delete on table "public"."fileVersions" from "service_role";

revoke insert on table "public"."fileVersions" from "service_role";

revoke references on table "public"."fileVersions" from "service_role";

revoke select on table "public"."fileVersions" from "service_role";

revoke trigger on table "public"."fileVersions" from "service_role";

revoke truncate on table "public"."fileVersions" from "service_role";

revoke update on table "public"."fileVersions" from "service_role";

revoke delete on table "public"."files" from "anon";

revoke insert on table "public"."files" from "anon";

revoke references on table "public"."files" from "anon";

revoke select on table "public"."files" from "anon";

revoke trigger on table "public"."files" from "anon";

revoke truncate on table "public"."files" from "anon";

revoke update on table "public"."files" from "anon";

revoke delete on table "public"."files" from "authenticated";

revoke insert on table "public"."files" from "authenticated";

revoke references on table "public"."files" from "authenticated";

revoke select on table "public"."files" from "authenticated";

revoke trigger on table "public"."files" from "authenticated";

revoke truncate on table "public"."files" from "authenticated";

revoke update on table "public"."files" from "authenticated";

revoke delete on table "public"."files" from "service_role";

revoke insert on table "public"."files" from "service_role";

revoke references on table "public"."files" from "service_role";

revoke select on table "public"."files" from "service_role";

revoke trigger on table "public"."files" from "service_role";

revoke truncate on table "public"."files" from "service_role";

revoke update on table "public"."files" from "service_role";

revoke delete on table "public"."filesGlobal" from "anon";

revoke insert on table "public"."filesGlobal" from "anon";

revoke references on table "public"."filesGlobal" from "anon";

revoke select on table "public"."filesGlobal" from "anon";

revoke trigger on table "public"."filesGlobal" from "anon";

revoke truncate on table "public"."filesGlobal" from "anon";

revoke update on table "public"."filesGlobal" from "anon";

revoke delete on table "public"."filesGlobal" from "authenticated";

revoke insert on table "public"."filesGlobal" from "authenticated";

revoke references on table "public"."filesGlobal" from "authenticated";

revoke select on table "public"."filesGlobal" from "authenticated";

revoke trigger on table "public"."filesGlobal" from "authenticated";

revoke truncate on table "public"."filesGlobal" from "authenticated";

revoke update on table "public"."filesGlobal" from "authenticated";

revoke delete on table "public"."filesGlobal" from "service_role";

revoke insert on table "public"."filesGlobal" from "service_role";

revoke references on table "public"."filesGlobal" from "service_role";

revoke select on table "public"."filesGlobal" from "service_role";

revoke trigger on table "public"."filesGlobal" from "service_role";

revoke truncate on table "public"."filesGlobal" from "service_role";

revoke update on table "public"."filesGlobal" from "service_role";

revoke delete on table "public"."generatedDocuments" from "anon";

revoke insert on table "public"."generatedDocuments" from "anon";

revoke references on table "public"."generatedDocuments" from "anon";

revoke select on table "public"."generatedDocuments" from "anon";

revoke trigger on table "public"."generatedDocuments" from "anon";

revoke truncate on table "public"."generatedDocuments" from "anon";

revoke update on table "public"."generatedDocuments" from "anon";

revoke delete on table "public"."generatedDocuments" from "authenticated";

revoke insert on table "public"."generatedDocuments" from "authenticated";

revoke references on table "public"."generatedDocuments" from "authenticated";

revoke select on table "public"."generatedDocuments" from "authenticated";

revoke trigger on table "public"."generatedDocuments" from "authenticated";

revoke truncate on table "public"."generatedDocuments" from "authenticated";

revoke update on table "public"."generatedDocuments" from "authenticated";

revoke delete on table "public"."generatedDocuments" from "service_role";

revoke insert on table "public"."generatedDocuments" from "service_role";

revoke references on table "public"."generatedDocuments" from "service_role";

revoke select on table "public"."generatedDocuments" from "service_role";

revoke trigger on table "public"."generatedDocuments" from "service_role";

revoke truncate on table "public"."generatedDocuments" from "service_role";

revoke update on table "public"."generatedDocuments" from "service_role";

revoke delete on table "public"."globalSettings" from "anon";

revoke insert on table "public"."globalSettings" from "anon";

revoke references on table "public"."globalSettings" from "anon";

revoke select on table "public"."globalSettings" from "anon";

revoke trigger on table "public"."globalSettings" from "anon";

revoke truncate on table "public"."globalSettings" from "anon";

revoke update on table "public"."globalSettings" from "anon";

revoke delete on table "public"."globalSettings" from "authenticated";

revoke insert on table "public"."globalSettings" from "authenticated";

revoke references on table "public"."globalSettings" from "authenticated";

revoke select on table "public"."globalSettings" from "authenticated";

revoke trigger on table "public"."globalSettings" from "authenticated";

revoke truncate on table "public"."globalSettings" from "authenticated";

revoke update on table "public"."globalSettings" from "authenticated";

revoke delete on table "public"."globalSettings" from "service_role";

revoke insert on table "public"."globalSettings" from "service_role";

revoke references on table "public"."globalSettings" from "service_role";

revoke select on table "public"."globalSettings" from "service_role";

revoke trigger on table "public"."globalSettings" from "service_role";

revoke truncate on table "public"."globalSettings" from "service_role";

revoke update on table "public"."globalSettings" from "service_role";

revoke delete on table "public"."invoices" from "anon";

revoke insert on table "public"."invoices" from "anon";

revoke references on table "public"."invoices" from "anon";

revoke select on table "public"."invoices" from "anon";

revoke trigger on table "public"."invoices" from "anon";

revoke truncate on table "public"."invoices" from "anon";

revoke update on table "public"."invoices" from "anon";

revoke delete on table "public"."invoices" from "authenticated";

revoke insert on table "public"."invoices" from "authenticated";

revoke references on table "public"."invoices" from "authenticated";

revoke select on table "public"."invoices" from "authenticated";

revoke trigger on table "public"."invoices" from "authenticated";

revoke truncate on table "public"."invoices" from "authenticated";

revoke update on table "public"."invoices" from "authenticated";

revoke delete on table "public"."invoices" from "service_role";

revoke insert on table "public"."invoices" from "service_role";

revoke references on table "public"."invoices" from "service_role";

revoke select on table "public"."invoices" from "service_role";

revoke trigger on table "public"."invoices" from "service_role";

revoke truncate on table "public"."invoices" from "service_role";

revoke update on table "public"."invoices" from "service_role";

revoke delete on table "public"."lineItemsCatalog" from "anon";

revoke insert on table "public"."lineItemsCatalog" from "anon";

revoke references on table "public"."lineItemsCatalog" from "anon";

revoke select on table "public"."lineItemsCatalog" from "anon";

revoke trigger on table "public"."lineItemsCatalog" from "anon";

revoke truncate on table "public"."lineItemsCatalog" from "anon";

revoke update on table "public"."lineItemsCatalog" from "anon";

revoke delete on table "public"."lineItemsCatalog" from "authenticated";

revoke insert on table "public"."lineItemsCatalog" from "authenticated";

revoke references on table "public"."lineItemsCatalog" from "authenticated";

revoke select on table "public"."lineItemsCatalog" from "authenticated";

revoke trigger on table "public"."lineItemsCatalog" from "authenticated";

revoke truncate on table "public"."lineItemsCatalog" from "authenticated";

revoke update on table "public"."lineItemsCatalog" from "authenticated";

revoke delete on table "public"."lineItemsCatalog" from "service_role";

revoke insert on table "public"."lineItemsCatalog" from "service_role";

revoke references on table "public"."lineItemsCatalog" from "service_role";

revoke select on table "public"."lineItemsCatalog" from "service_role";

revoke trigger on table "public"."lineItemsCatalog" from "service_role";

revoke truncate on table "public"."lineItemsCatalog" from "service_role";

revoke update on table "public"."lineItemsCatalog" from "service_role";

revoke delete on table "public"."magicLinkTokens" from "anon";

revoke insert on table "public"."magicLinkTokens" from "anon";

revoke references on table "public"."magicLinkTokens" from "anon";

revoke select on table "public"."magicLinkTokens" from "anon";

revoke trigger on table "public"."magicLinkTokens" from "anon";

revoke truncate on table "public"."magicLinkTokens" from "anon";

revoke update on table "public"."magicLinkTokens" from "anon";

revoke delete on table "public"."magicLinkTokens" from "authenticated";

revoke insert on table "public"."magicLinkTokens" from "authenticated";

revoke references on table "public"."magicLinkTokens" from "authenticated";

revoke select on table "public"."magicLinkTokens" from "authenticated";

revoke trigger on table "public"."magicLinkTokens" from "authenticated";

revoke truncate on table "public"."magicLinkTokens" from "authenticated";

revoke update on table "public"."magicLinkTokens" from "authenticated";

revoke delete on table "public"."magicLinkTokens" from "service_role";

revoke insert on table "public"."magicLinkTokens" from "service_role";

revoke references on table "public"."magicLinkTokens" from "service_role";

revoke select on table "public"."magicLinkTokens" from "service_role";

revoke trigger on table "public"."magicLinkTokens" from "service_role";

revoke truncate on table "public"."magicLinkTokens" from "service_role";

revoke update on table "public"."magicLinkTokens" from "service_role";

revoke delete on table "public"."notifications" from "anon";

revoke insert on table "public"."notifications" from "anon";

revoke references on table "public"."notifications" from "anon";

revoke select on table "public"."notifications" from "anon";

revoke trigger on table "public"."notifications" from "anon";

revoke truncate on table "public"."notifications" from "anon";

revoke update on table "public"."notifications" from "anon";

revoke delete on table "public"."notifications" from "authenticated";

revoke insert on table "public"."notifications" from "authenticated";

revoke references on table "public"."notifications" from "authenticated";

revoke select on table "public"."notifications" from "authenticated";

revoke trigger on table "public"."notifications" from "authenticated";

revoke truncate on table "public"."notifications" from "authenticated";

revoke update on table "public"."notifications" from "authenticated";

revoke delete on table "public"."notifications" from "service_role";

revoke insert on table "public"."notifications" from "service_role";

revoke references on table "public"."notifications" from "service_role";

revoke select on table "public"."notifications" from "service_role";

revoke trigger on table "public"."notifications" from "service_role";

revoke truncate on table "public"."notifications" from "service_role";

revoke update on table "public"."notifications" from "service_role";

revoke delete on table "public"."payments" from "anon";

revoke insert on table "public"."payments" from "anon";

revoke references on table "public"."payments" from "anon";

revoke select on table "public"."payments" from "anon";

revoke trigger on table "public"."payments" from "anon";

revoke truncate on table "public"."payments" from "anon";

revoke update on table "public"."payments" from "anon";

revoke delete on table "public"."payments" from "authenticated";

revoke insert on table "public"."payments" from "authenticated";

revoke references on table "public"."payments" from "authenticated";

revoke select on table "public"."payments" from "authenticated";

revoke trigger on table "public"."payments" from "authenticated";

revoke truncate on table "public"."payments" from "authenticated";

revoke update on table "public"."payments" from "authenticated";

revoke delete on table "public"."payments" from "service_role";

revoke insert on table "public"."payments" from "service_role";

revoke references on table "public"."payments" from "service_role";

revoke select on table "public"."payments" from "service_role";

revoke trigger on table "public"."payments" from "service_role";

revoke truncate on table "public"."payments" from "service_role";

revoke update on table "public"."payments" from "service_role";

revoke delete on table "public"."pdfGenerationHistory" from "anon";

revoke insert on table "public"."pdfGenerationHistory" from "anon";

revoke references on table "public"."pdfGenerationHistory" from "anon";

revoke select on table "public"."pdfGenerationHistory" from "anon";

revoke trigger on table "public"."pdfGenerationHistory" from "anon";

revoke truncate on table "public"."pdfGenerationHistory" from "anon";

revoke update on table "public"."pdfGenerationHistory" from "anon";

revoke delete on table "public"."pdfGenerationHistory" from "authenticated";

revoke insert on table "public"."pdfGenerationHistory" from "authenticated";

revoke references on table "public"."pdfGenerationHistory" from "authenticated";

revoke select on table "public"."pdfGenerationHistory" from "authenticated";

revoke trigger on table "public"."pdfGenerationHistory" from "authenticated";

revoke truncate on table "public"."pdfGenerationHistory" from "authenticated";

revoke update on table "public"."pdfGenerationHistory" from "authenticated";

revoke delete on table "public"."pdfGenerationHistory" from "service_role";

revoke insert on table "public"."pdfGenerationHistory" from "service_role";

revoke references on table "public"."pdfGenerationHistory" from "service_role";

revoke select on table "public"."pdfGenerationHistory" from "service_role";

revoke trigger on table "public"."pdfGenerationHistory" from "service_role";

revoke truncate on table "public"."pdfGenerationHistory" from "service_role";

revoke update on table "public"."pdfGenerationHistory" from "service_role";

revoke delete on table "public"."pdfGenerationJobs" from "anon";

revoke insert on table "public"."pdfGenerationJobs" from "anon";

revoke references on table "public"."pdfGenerationJobs" from "anon";

revoke select on table "public"."pdfGenerationJobs" from "anon";

revoke trigger on table "public"."pdfGenerationJobs" from "anon";

revoke truncate on table "public"."pdfGenerationJobs" from "anon";

revoke update on table "public"."pdfGenerationJobs" from "anon";

revoke delete on table "public"."pdfGenerationJobs" from "authenticated";

revoke insert on table "public"."pdfGenerationJobs" from "authenticated";

revoke references on table "public"."pdfGenerationJobs" from "authenticated";

revoke select on table "public"."pdfGenerationJobs" from "authenticated";

revoke trigger on table "public"."pdfGenerationJobs" from "authenticated";

revoke truncate on table "public"."pdfGenerationJobs" from "authenticated";

revoke update on table "public"."pdfGenerationJobs" from "authenticated";

revoke delete on table "public"."pdfGenerationJobs" from "service_role";

revoke insert on table "public"."pdfGenerationJobs" from "service_role";

revoke references on table "public"."pdfGenerationJobs" from "service_role";

revoke select on table "public"."pdfGenerationJobs" from "service_role";

revoke trigger on table "public"."pdfGenerationJobs" from "service_role";

revoke truncate on table "public"."pdfGenerationJobs" from "service_role";

revoke update on table "public"."pdfGenerationJobs" from "service_role";

revoke delete on table "public"."pdfTemplateFields" from "anon";

revoke insert on table "public"."pdfTemplateFields" from "anon";

revoke references on table "public"."pdfTemplateFields" from "anon";

revoke select on table "public"."pdfTemplateFields" from "anon";

revoke trigger on table "public"."pdfTemplateFields" from "anon";

revoke truncate on table "public"."pdfTemplateFields" from "anon";

revoke update on table "public"."pdfTemplateFields" from "anon";

revoke delete on table "public"."pdfTemplateFields" from "authenticated";

revoke insert on table "public"."pdfTemplateFields" from "authenticated";

revoke references on table "public"."pdfTemplateFields" from "authenticated";

revoke select on table "public"."pdfTemplateFields" from "authenticated";

revoke trigger on table "public"."pdfTemplateFields" from "authenticated";

revoke truncate on table "public"."pdfTemplateFields" from "authenticated";

revoke update on table "public"."pdfTemplateFields" from "authenticated";

revoke delete on table "public"."pdfTemplateFields" from "service_role";

revoke insert on table "public"."pdfTemplateFields" from "service_role";

revoke references on table "public"."pdfTemplateFields" from "service_role";

revoke select on table "public"."pdfTemplateFields" from "service_role";

revoke trigger on table "public"."pdfTemplateFields" from "service_role";

revoke truncate on table "public"."pdfTemplateFields" from "service_role";

revoke update on table "public"."pdfTemplateFields" from "service_role";

revoke delete on table "public"."pdfTemplates" from "anon";

revoke insert on table "public"."pdfTemplates" from "anon";

revoke references on table "public"."pdfTemplates" from "anon";

revoke select on table "public"."pdfTemplates" from "anon";

revoke trigger on table "public"."pdfTemplates" from "anon";

revoke truncate on table "public"."pdfTemplates" from "anon";

revoke update on table "public"."pdfTemplates" from "anon";

revoke delete on table "public"."pdfTemplates" from "authenticated";

revoke insert on table "public"."pdfTemplates" from "authenticated";

revoke references on table "public"."pdfTemplates" from "authenticated";

revoke select on table "public"."pdfTemplates" from "authenticated";

revoke trigger on table "public"."pdfTemplates" from "authenticated";

revoke truncate on table "public"."pdfTemplates" from "authenticated";

revoke update on table "public"."pdfTemplates" from "authenticated";

revoke delete on table "public"."pdfTemplates" from "service_role";

revoke insert on table "public"."pdfTemplates" from "service_role";

revoke references on table "public"."pdfTemplates" from "service_role";

revoke select on table "public"."pdfTemplates" from "service_role";

revoke trigger on table "public"."pdfTemplates" from "service_role";

revoke truncate on table "public"."pdfTemplates" from "service_role";

revoke update on table "public"."pdfTemplates" from "service_role";

revoke delete on table "public"."profiles" from "anon";

revoke insert on table "public"."profiles" from "anon";

revoke references on table "public"."profiles" from "anon";

revoke select on table "public"."profiles" from "anon";

revoke trigger on table "public"."profiles" from "anon";

revoke truncate on table "public"."profiles" from "anon";

revoke update on table "public"."profiles" from "anon";

revoke delete on table "public"."profiles" from "authenticated";

revoke insert on table "public"."profiles" from "authenticated";

revoke references on table "public"."profiles" from "authenticated";

revoke select on table "public"."profiles" from "authenticated";

revoke trigger on table "public"."profiles" from "authenticated";

revoke truncate on table "public"."profiles" from "authenticated";

revoke update on table "public"."profiles" from "authenticated";

revoke delete on table "public"."profiles" from "service_role";

revoke insert on table "public"."profiles" from "service_role";

revoke references on table "public"."profiles" from "service_role";

revoke select on table "public"."profiles" from "service_role";

revoke trigger on table "public"."profiles" from "service_role";

revoke truncate on table "public"."profiles" from "service_role";

revoke update on table "public"."profiles" from "service_role";

revoke delete on table "public"."projectStatuses" from "anon";

revoke insert on table "public"."projectStatuses" from "anon";

revoke references on table "public"."projectStatuses" from "anon";

revoke select on table "public"."projectStatuses" from "anon";

revoke trigger on table "public"."projectStatuses" from "anon";

revoke truncate on table "public"."projectStatuses" from "anon";

revoke update on table "public"."projectStatuses" from "anon";

revoke delete on table "public"."projectStatuses" from "authenticated";

revoke insert on table "public"."projectStatuses" from "authenticated";

revoke references on table "public"."projectStatuses" from "authenticated";

revoke select on table "public"."projectStatuses" from "authenticated";

revoke trigger on table "public"."projectStatuses" from "authenticated";

revoke truncate on table "public"."projectStatuses" from "authenticated";

revoke update on table "public"."projectStatuses" from "authenticated";

revoke delete on table "public"."projectStatuses" from "service_role";

revoke insert on table "public"."projectStatuses" from "service_role";

revoke references on table "public"."projectStatuses" from "service_role";

revoke select on table "public"."projectStatuses" from "service_role";

revoke trigger on table "public"."projectStatuses" from "service_role";

revoke truncate on table "public"."projectStatuses" from "service_role";

revoke update on table "public"."projectStatuses" from "service_role";

revoke delete on table "public"."projects" from "anon";

revoke insert on table "public"."projects" from "anon";

revoke references on table "public"."projects" from "anon";

revoke select on table "public"."projects" from "anon";

revoke trigger on table "public"."projects" from "anon";

revoke truncate on table "public"."projects" from "anon";

revoke update on table "public"."projects" from "anon";

revoke delete on table "public"."projects" from "authenticated";

revoke insert on table "public"."projects" from "authenticated";

revoke references on table "public"."projects" from "authenticated";

revoke select on table "public"."projects" from "authenticated";

revoke trigger on table "public"."projects" from "authenticated";

revoke truncate on table "public"."projects" from "authenticated";

revoke update on table "public"."projects" from "authenticated";

revoke delete on table "public"."projects" from "service_role";

revoke insert on table "public"."projects" from "service_role";

revoke references on table "public"."projects" from "service_role";

revoke select on table "public"."projects" from "service_role";

revoke trigger on table "public"."projects" from "service_role";

revoke truncate on table "public"."projects" from "service_role";

revoke update on table "public"."projects" from "service_role";

revoke delete on table "public"."punchlist" from "anon";

revoke insert on table "public"."punchlist" from "anon";

revoke references on table "public"."punchlist" from "anon";

revoke select on table "public"."punchlist" from "anon";

revoke trigger on table "public"."punchlist" from "anon";

revoke truncate on table "public"."punchlist" from "anon";

revoke update on table "public"."punchlist" from "anon";

revoke delete on table "public"."punchlist" from "authenticated";

revoke insert on table "public"."punchlist" from "authenticated";

revoke references on table "public"."punchlist" from "authenticated";

revoke select on table "public"."punchlist" from "authenticated";

revoke trigger on table "public"."punchlist" from "authenticated";

revoke truncate on table "public"."punchlist" from "authenticated";

revoke update on table "public"."punchlist" from "authenticated";

revoke delete on table "public"."punchlist" from "service_role";

revoke insert on table "public"."punchlist" from "service_role";

revoke references on table "public"."punchlist" from "service_role";

revoke select on table "public"."punchlist" from "service_role";

revoke trigger on table "public"."punchlist" from "service_role";

revoke truncate on table "public"."punchlist" from "service_role";

revoke update on table "public"."punchlist" from "service_role";

revoke delete on table "public"."schedules" from "anon";

revoke insert on table "public"."schedules" from "anon";

revoke references on table "public"."schedules" from "anon";

revoke select on table "public"."schedules" from "anon";

revoke trigger on table "public"."schedules" from "anon";

revoke truncate on table "public"."schedules" from "anon";

revoke update on table "public"."schedules" from "anon";

revoke delete on table "public"."schedules" from "authenticated";

revoke insert on table "public"."schedules" from "authenticated";

revoke references on table "public"."schedules" from "authenticated";

revoke select on table "public"."schedules" from "authenticated";

revoke trigger on table "public"."schedules" from "authenticated";

revoke truncate on table "public"."schedules" from "authenticated";

revoke update on table "public"."schedules" from "authenticated";

revoke delete on table "public"."schedules" from "service_role";

revoke insert on table "public"."schedules" from "service_role";

revoke references on table "public"."schedules" from "service_role";

revoke select on table "public"."schedules" from "service_role";

revoke trigger on table "public"."schedules" from "service_role";

revoke truncate on table "public"."schedules" from "service_role";

revoke update on table "public"."schedules" from "service_role";

revoke delete on table "public"."subjects" from "anon";

revoke insert on table "public"."subjects" from "anon";

revoke references on table "public"."subjects" from "anon";

revoke select on table "public"."subjects" from "anon";

revoke trigger on table "public"."subjects" from "anon";

revoke truncate on table "public"."subjects" from "anon";

revoke update on table "public"."subjects" from "anon";

revoke delete on table "public"."subjects" from "authenticated";

revoke insert on table "public"."subjects" from "authenticated";

revoke references on table "public"."subjects" from "authenticated";

revoke select on table "public"."subjects" from "authenticated";

revoke trigger on table "public"."subjects" from "authenticated";

revoke truncate on table "public"."subjects" from "authenticated";

revoke update on table "public"."subjects" from "authenticated";

revoke delete on table "public"."subjects" from "service_role";

revoke insert on table "public"."subjects" from "service_role";

revoke references on table "public"."subjects" from "service_role";

revoke select on table "public"."subjects" from "service_role";

revoke trigger on table "public"."subjects" from "service_role";

revoke truncate on table "public"."subjects" from "service_role";

revoke update on table "public"."subjects" from "service_role";

revoke delete on table "public"."template_component_mapping" from "anon";

revoke insert on table "public"."template_component_mapping" from "anon";

revoke references on table "public"."template_component_mapping" from "anon";

revoke select on table "public"."template_component_mapping" from "anon";

revoke trigger on table "public"."template_component_mapping" from "anon";

revoke truncate on table "public"."template_component_mapping" from "anon";

revoke update on table "public"."template_component_mapping" from "anon";

revoke delete on table "public"."template_component_mapping" from "authenticated";

revoke insert on table "public"."template_component_mapping" from "authenticated";

revoke references on table "public"."template_component_mapping" from "authenticated";

revoke select on table "public"."template_component_mapping" from "authenticated";

revoke trigger on table "public"."template_component_mapping" from "authenticated";

revoke truncate on table "public"."template_component_mapping" from "authenticated";

revoke update on table "public"."template_component_mapping" from "authenticated";

revoke delete on table "public"."template_component_mapping" from "service_role";

revoke insert on table "public"."template_component_mapping" from "service_role";

revoke references on table "public"."template_component_mapping" from "service_role";

revoke select on table "public"."template_component_mapping" from "service_role";

revoke trigger on table "public"."template_component_mapping" from "service_role";

revoke truncate on table "public"."template_component_mapping" from "service_role";

revoke update on table "public"."template_component_mapping" from "service_role";

revoke delete on table "public"."tutorialConfigs" from "anon";

revoke insert on table "public"."tutorialConfigs" from "anon";

revoke references on table "public"."tutorialConfigs" from "anon";

revoke select on table "public"."tutorialConfigs" from "anon";

revoke trigger on table "public"."tutorialConfigs" from "anon";

revoke truncate on table "public"."tutorialConfigs" from "anon";

revoke update on table "public"."tutorialConfigs" from "anon";

revoke delete on table "public"."tutorialConfigs" from "authenticated";

revoke insert on table "public"."tutorialConfigs" from "authenticated";

revoke references on table "public"."tutorialConfigs" from "authenticated";

revoke select on table "public"."tutorialConfigs" from "authenticated";

revoke trigger on table "public"."tutorialConfigs" from "authenticated";

revoke truncate on table "public"."tutorialConfigs" from "authenticated";

revoke update on table "public"."tutorialConfigs" from "authenticated";

revoke delete on table "public"."tutorialConfigs" from "service_role";

revoke insert on table "public"."tutorialConfigs" from "service_role";

revoke references on table "public"."tutorialConfigs" from "service_role";

revoke select on table "public"."tutorialConfigs" from "service_role";

revoke trigger on table "public"."tutorialConfigs" from "service_role";

revoke truncate on table "public"."tutorialConfigs" from "service_role";

revoke update on table "public"."tutorialConfigs" from "service_role";

revoke delete on table "public"."webhooks" from "anon";

revoke insert on table "public"."webhooks" from "anon";

revoke references on table "public"."webhooks" from "anon";

revoke select on table "public"."webhooks" from "anon";

revoke trigger on table "public"."webhooks" from "anon";

revoke truncate on table "public"."webhooks" from "anon";

revoke update on table "public"."webhooks" from "anon";

revoke delete on table "public"."webhooks" from "authenticated";

revoke insert on table "public"."webhooks" from "authenticated";

revoke references on table "public"."webhooks" from "authenticated";

revoke select on table "public"."webhooks" from "authenticated";

revoke trigger on table "public"."webhooks" from "authenticated";

revoke truncate on table "public"."webhooks" from "authenticated";

revoke update on table "public"."webhooks" from "authenticated";

revoke delete on table "public"."webhooks" from "service_role";

revoke insert on table "public"."webhooks" from "service_role";

revoke references on table "public"."webhooks" from "service_role";

revoke select on table "public"."webhooks" from "service_role";

revoke trigger on table "public"."webhooks" from "service_role";

revoke truncate on table "public"."webhooks" from "service_role";

revoke update on table "public"."webhooks" from "service_role";

alter table "public"."feedback" drop constraint "feedback_priority_check";

alter table "public"."feedback" drop constraint "feedback_status_check";

alter table "public"."feedback" drop constraint "feedback_type_check";

create table "public"."projectItemTemplates" (
    "id" integer generated by default as identity not null,
    "createdAt" timestamp with time zone not null default now(),
    "type" character varying,
    "title" character varying,
    "message" text,
    "internal" boolean,
    "markCompleted" boolean,
    "enabled" boolean,
    "companyName" character varying,
    "createdBy" uuid default gen_random_uuid(),
    "updatedAt" timestamp with time zone,
    "orderIndex" integer
);


alter table "public"."projectItemTemplates" enable row level security;

alter table "public"."ai_agent_conversations" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."ai_agent_knowledge" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."ai_agent_messages" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."ai_agent_project_memory" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."ai_agent_usage" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."ai_generated_documents" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."ai_generations" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."cmsPages" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."documentTemplates" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."globalSettings" alter column "id" set default extensions.uuid_generate_v4();

CREATE UNIQUE INDEX "projectItemTemplates_pkey" ON public."projectItemTemplates" USING btree (id);

alter table "public"."projectItemTemplates" add constraint "projectItemTemplates_pkey" PRIMARY KEY using index "projectItemTemplates_pkey";

alter table "public"."feedback" add constraint "feedback_priority_check" CHECK (((priority)::text = ANY ((ARRAY['low'::character varying, 'medium'::character varying, 'high'::character varying, 'urgent'::character varying])::text[]))) not valid;

alter table "public"."feedback" validate constraint "feedback_priority_check";

alter table "public"."feedback" add constraint "feedback_status_check" CHECK (((status)::text = ANY ((ARRAY['new'::character varying, 'in_progress'::character varying, 'resolved'::character varying, 'closed'::character varying])::text[]))) not valid;

alter table "public"."feedback" validate constraint "feedback_status_check";

alter table "public"."feedback" add constraint "feedback_type_check" CHECK (((type)::text = ANY ((ARRAY['bug'::character varying, 'feature'::character varying, 'improvement'::character varying, 'design'::character varying, 'general'::character varying])::text[]))) not valid;

alter table "public"."feedback" validate constraint "feedback_type_check";

set check_function_bodies = off;

CREATE OR REPLACE FUNCTION public.assign_default_discussion_to_project()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$DECLARE
  defaultAuthorId UUID := 'd0bc127f-d816-4aeb-ac48-6ba4b0718491'; -- Replace with your admin user ID
  defaultCompanyName TEXT := 'CAPCO Admin'; -- Replace with your company name
  
  -- Internal variables
  finalAuthorId UUID;
  finalCompanyName TEXT;
  welcomeMessage TEXT;
BEGIN
  -- Use default author ID (you can change logic here if needed)
  finalAuthorId := defaultAuthorId;
  
  -- Use default company name
  finalCompanyName := defaultCompanyName;

  -- Build the welcome message with proper string concatenation
  welcomeMessage := 'Welcome to your new project! We''re excited to work with you on ' || 
                     COALESCE(NEW.title, 'your project') || 
                     '. Please make sure to upload all relevant documents and images to the <a class="text-primary dark:text-primary-dark" href="/project/' || 
                     COALESCE(NEW.id::text, 'your-project') || 
                     '?status=documents">documents section</a>, and submit them by clicking the [
Finished Uploading Documents / Request Review] button so we can review and develop a proposal';

  -- Insert default discussion comments for the new project
  INSERT INTO discussion (
    "projectId",
    "authorId",
    message,
    internal,
    "createdAt",
    "updatedAt",
    "markCompleted",
    "companyName"
  ) VALUES 
    -- 1. Welcome message for the client (Client Visible)
    (
      NEW.id,
      finalAuthorId,
      welcomeMessage,
      false, -- Client visible
      NOW(),
      NOW(),
      false, -- Not completed by default
      finalCompanyName
    );

  RETURN NEW;
END;$function$
;

CREATE OR REPLACE FUNCTION public.assign_file(file_id_param integer, assigned_to_param uuid, assigned_by_param uuid, notes_param text DEFAULT NULL::text)
 RETURNS json
 LANGUAGE plpgsql
AS $function$
DECLARE
  fileRecord RECORD;
BEGIN
  -- Get file details
  SELECT 
    f.*,
    f."checkedOutBy",
    f."checkedOutAt",
    f."assignedTo",
    f."assignedAt",
    f."checkoutNotes"
  INTO fileRecord 
  FROM files f 
  WHERE f.id = file_id_param;
  
  IF NOT FOUND THEN
    RETURN json_build_object('success', false, 'error', 'File not found');
  END IF;
  
  -- Assign the file
  UPDATE files 
  SET 
    "assignedTo" = assigned_to_param,
    "assignedAt" = NOW()
  WHERE id = file_id_param;
  
  -- Log the assignment
  INSERT INTO fileCheckoutHistory (fileId, userId, action, notes)
  VALUES (file_id_param, assigned_by_param, 'assign', notes_param);
  
  RETURN json_build_object('success', true, 'message', 'File assigned successfully');
END;
$function$
;

CREATE OR REPLACE FUNCTION public.auto_create_punchlist_items()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
BEGIN
    -- Only create punchlist items for new projects
    IF TG_OP = 'INSERT' THEN
        -- Call the function to create default punchlist items
        PERFORM create_default_punchlist_items(NEW.id);
    END IF;
    
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.calculate_ai_cost(p_model text, p_input_tokens integer, p_output_tokens integer)
 RETURNS numeric
 LANGUAGE plpgsql
AS $function$
DECLARE
  input_cost_per_1k DECIMAL(10, 6);
  output_cost_per_1k DECIMAL(10, 6);
BEGIN
  -- Claude 3.5 Sonnet pricing (as of 2024)
  -- Input: $3.00 per 1M tokens, Output: $15.00 per 1M tokens
  IF p_model LIKE 'claude-3-5-sonnet%' THEN
    input_cost_per_1k := 0.003;
    output_cost_per_1k := 0.015;
  -- Claude 3 Opus pricing
  ELSIF p_model LIKE 'claude-3-opus%' THEN
    input_cost_per_1k := 0.015;
    output_cost_per_1k := 0.075;
  -- Claude 3 Haiku pricing
  ELSIF p_model LIKE 'claude-3-haiku%' THEN
    input_cost_per_1k := 0.00025;
    output_cost_per_1k := 0.00125;
  ELSE
    -- Default to Sonnet pricing
    input_cost_per_1k := 0.003;
    output_cost_per_1k := 0.015;
  END IF;
  
  RETURN (p_input_tokens::DECIMAL / 1000.0 * input_cost_per_1k) + 
         (p_output_tokens::DECIMAL / 1000.0 * output_cost_per_1k);
END;
$function$
;

CREATE OR REPLACE FUNCTION public.calculate_outstanding_balance()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  UPDATE invoices 
  SET 
    paid_amount = (SELECT COALESCE(SUM(amount), 0) FROM payments WHERE invoice_id = NEW.invoice_id),
    outstanding_balance = total_amount - (SELECT COALESCE(SUM(amount), 0) FROM payments WHERE invoice_id = NEW.invoice_id),
    status = CASE 
      WHEN total_amount <= (SELECT COALESCE(SUM(amount), 0) FROM payments WHERE invoice_id = NEW.invoice_id) 
      THEN 'paid' 
      ELSE 'sent' 
    END
  WHERE id = NEW.invoice_id;
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.checkin_file(file_id_param integer, user_id_param uuid, notes_param text DEFAULT NULL::text)
 RETURNS json
 LANGUAGE plpgsql
AS $function$
DECLARE
  fileRecord RECORD;
BEGIN
  -- Get file details
  SELECT 
    f.*,
    f."checkedOutBy",
    f."checkedOutAt",
    f."assignedTo",
    f."assignedAt",
    f."checkoutNotes"
  INTO fileRecord 
  FROM files f 
  WHERE f.id = file_id_param;
  
  IF NOT FOUND THEN
    RETURN json_build_object('success', false, 'error', 'File not found');
  END IF;
  
  -- Check if user has the file checked out
  IF fileRecord."checkedOutBy" != user_id_param THEN
    RETURN json_build_object(
      'success', false, 
      'error', 'You do not have this file checked out'
    );
  END IF;
  
  -- Check in the file
  UPDATE files 
  SET 
    "checkedOutBy" = NULL,
    "checkedOutAt" = NULL,
    "checkoutNotes" = NULL
  WHERE id = file_id_param;
  
  -- Log the checkin
  INSERT INTO fileCheckoutHistory (fileId, userId, action, notes)
  VALUES (file_id_param, user_id_param, 'checkin', notes_param);
  
  RETURN json_build_object('success', true, 'message', 'File checked in successfully');
END;
$function$
;

CREATE OR REPLACE FUNCTION public.checkout_file(file_id_param integer, user_id_param uuid, notes_param text DEFAULT NULL::text)
 RETURNS json
 LANGUAGE plpgsql
AS $function$
DECLARE
  fileRecord RECORD;
  result JSON;
BEGIN
  -- Get file details
  SELECT 
    f.*,
    f."checkedOutBy",
    f."checkedOutAt",
    f."assignedTo",
    f."assignedAt",
    f."checkoutNotes"
  INTO fileRecord 
  FROM files f 
  WHERE f.id = file_id_param;
  
  IF NOT FOUND THEN
    RETURN json_build_object('success', false, 'error', 'File not found');
  END IF;
  
  -- Check if file is already checked out
  IF fileRecord."checkedOutBy" IS NOT NULL THEN
    RETURN json_build_object(
      'success', false, 
      'error', 'File is already checked out',
      'checkedOutBy', fileRecord."checkedOutBy",
      'checkedOutAt', fileRecord."checkedOutAt"
    );
  END IF;
  
  -- Check out the file
  UPDATE files 
  SET 
    "checkedOutBy" = user_id_param,
    "checkedOutAt" = NOW(),
    "checkoutNotes" = notes_param
  WHERE id = file_id_param;
  
  -- Log the checkout
  INSERT INTO fileCheckoutHistory (fileId, userId, action, notes)
  VALUES (file_id_param, user_id_param, 'checkout', notes_param);
  
  RETURN json_build_object('success', true, 'message', 'File checked out successfully');
END;
$function$
;

CREATE OR REPLACE FUNCTION public.create_default_punchlist_items(project_id_param integer)
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    project_author_id UUID;
    author_company_name TEXT;
    base_time TIMESTAMP WITH TIME ZONE;
BEGIN
    -- Get the project author's ID using camelCase column name
    SELECT "authorId" INTO project_author_id 
    FROM projects 
    WHERE id = project_id_param;
    
    -- Get the author's company name from profiles using camelCase column names
    SELECT COALESCE("companyName", "firstName" || ' ' || "lastName", 'Unknown User') 
    INTO author_company_name
    FROM profiles 
    WHERE id = project_author_id;
    
    -- If we couldn't find the author, exit
    IF project_author_id IS NULL THEN
        RAISE NOTICE 'Could not find author for project %', project_id_param;
        RETURN;
    END IF;

    -- Use current time as base, add seconds to ensure proper ordering
    base_time := NOW();

    -- Insert default punchlist items using camelCase column names
    INSERT INTO punchlist ("projectId", "authorId", message, internal, "markCompleted", "companyName", "createdAt")
    VALUES 
    (project_id_param, project_author_id, 'Receive CAD files from client / download from <a class="text-primary dark:text-primary-text" href="{{RAILWAY_PUBLIC_DOMAIN}}/project/{{PROJECT_ID}}?status=documents">Documents</a>', false, false, author_company_name, base_time + INTERVAL '1 second'),
    (project_id_param, project_author_id, 'Obtain fire hydrant flow test data', false, false, author_company_name, base_time + INTERVAL '2 seconds'),
    (project_id_param, project_author_id, 'Conduct design kickoff and review scope', false, false, author_company_name, base_time + INTERVAL '3 seconds'),
    (project_id_param, project_author_id, 'Coordinate with fire alarm designer', false, false, author_company_name, base_time + INTERVAL '4 seconds'),
    (project_id_param, project_author_id, 'Complete fire sprinkler layout design', false, false, author_company_name, base_time + INTERVAL '5 seconds'),
    (project_id_param, project_author_id, 'Perform hydraulic calculations', false, false, author_company_name, base_time + INTERVAL '6 seconds'),
    (project_id_param, project_author_id, 'Optimize pipe sizing for efficiency', false, false, author_company_name, base_time + INTERVAL '7 seconds'),
    (project_id_param, project_author_id, 'Add notes and leader callouts', false, false, author_company_name, base_time + INTERVAL '8 seconds'),  
    (project_id_param, project_author_id, 'Add details and general notes', false, false, author_company_name, base_time + INTERVAL '9 seconds'),
    (project_id_param, project_author_id, 'Finalize design and apply titleblock', false, false, author_company_name, base_time + INTERVAL '10 seconds'),
    (project_id_param, project_author_id, 'Print drawings to PDF for submittal / upload to <a class="text-primary dark:text-primary-text" href="{{RAILWAY_PUBLIC_DOMAIN}}/project/{{PROJECT_ID}}?status=deliverables">Deliverables</a>', false, false, author_company_name, base_time + INTERVAL '11 seconds');
    
    RAISE NOTICE 'Created default punchlist items for project % with author %', project_id_param, project_author_id;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.extend_project_due_date(project_id_param integer, hours_to_add integer)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  UPDATE projects 
  SET "dueDate" = COALESCE("dueDate", NOW()) + (hours_to_add || ' hours')::INTERVAL
  WHERE id = project_id_param;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_agent_knowledge(p_category text DEFAULT NULL::text, p_limit integer DEFAULT 20)
 RETURNS TABLE(id uuid, title text, content text, category text, tags text[], priority integer)
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  RETURN QUERY
  SELECT 
    k.id,
    k.title,
    k.content,
    k.category,
    k.tags,
    k.priority
  FROM ai_agent_knowledge k
  WHERE k."isActive" = true
    AND (p_category IS NULL OR k.category = p_category)
  ORDER BY k.priority DESC, k."createdAt" DESC
  LIMIT p_limit;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_file_checkout_status(file_id_param integer)
 RETURNS json
 LANGUAGE plpgsql
AS $function$
DECLARE
  fileRecord RECORD;
  checkoutUser RECORD;
  assignedUser RECORD;
BEGIN
  -- Get file with user details
  SELECT 
    f.*,
    cu.email as checkedOutByEmail,
    cu.raw_user_meta_data->>'companyName' as checkedOutByName,
    au.email as assignedToEmail,
    au.raw_user_meta_data->>'companyName' as assignedToName
  INTO fileRecord
  FROM files f
  LEFT JOIN auth.users cu ON f.checkedOutBy = cu.id
  LEFT JOIN auth.users au ON f.assignedTo = au.id
  WHERE f.id = file_id_param;
  
  IF NOT FOUND THEN
    RETURN json_build_object('success', false, 'error', 'File not found');
  END IF;
  
  RETURN json_build_object(
    'success', true,
    'fileId', fileRecord.id,
    'checkedOut', fileRecord.checkedOutBy IS NOT NULL,
    'checkedOutBy', fileRecord.checkedOutBy,
    'checkedOutByName', fileRecord.checkedOutByName,
    'checkedOutByEmail', fileRecord.checkedOutByEmail,
    'checkedOutAt', fileRecord.checkedOutAt,
    'checkoutNotes', fileRecord.checkoutNotes,
    'assignedTo', fileRecord.assignedTo,
    'assignedToName', fileRecord.assignedToName,
    'assignedToEmail', fileRecord.assignedToEmail,
    'assignedAt', fileRecord.assignedAt
  );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_new_user()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
  _firstName text;
  _lastName text;
  _companyName text;
  _avatarUrl text;
BEGIN
  -- Extract first name (try multiple metadata fields for different auth providers)
  _firstName := COALESCE(
    NULLIF(NEW.raw_user_meta_data->>'firstName', ''),
    NULLIF(NEW.raw_user_meta_data->>'first_name', ''),
    NULLIF(NEW.raw_user_meta_data->>'given_name', ''),  -- Google OAuth
    ''
  );
  
  -- Extract last name
  _lastName := COALESCE(
    NULLIF(NEW.raw_user_meta_data->>'lastName', ''),
    NULLIF(NEW.raw_user_meta_data->>'last_name', ''),
    NULLIF(NEW.raw_user_meta_data->>'family_name', ''),  -- Google OAuth
    ''
  );
  
  -- Extract company name (fallback to full name or email)
  _companyName := COALESCE(
    NULLIF(NEW.raw_user_meta_data->>'companyName', ''),
    NULLIF(NEW.raw_user_meta_data->>'company_name', ''),
    NULLIF(NEW.raw_user_meta_data->>'name', ''),  -- Google OAuth full name
    NULLIF(NEW.raw_user_meta_data->>'full_name', ''),
    split_part(NEW.email, '@', 1)  -- Fallback to email username
  );
  
  -- Extract avatar URL (try multiple fields)
  _avatarUrl := COALESCE(
    NULLIF(NEW.raw_user_meta_data->>'avatarUrl', ''),
    NULLIF(NEW.raw_user_meta_data->>'avatar_url', ''),
    NULLIF(NEW.raw_user_meta_data->>'picture', ''),  -- Google OAuth
    NULL
  );

  -- Insert new profile
  INSERT INTO public.profiles (
    id, 
    email,
    role, 
    "companyName",
    "firstName",
    "lastName",
    "avatarUrl",
    "createdAt",
    "updatedAt"
  )
  VALUES (
    NEW.id, 
    NEW.email,
    'Client',  -- Default role for new users
    _companyName,
    _firstName,
    _lastName,
    _avatarUrl,
    NOW(),
    NOW()
  )
  ON CONFLICT (id) DO NOTHING;  -- Don't error if profile already exists
  
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.is_admin_or_staff()
 RETURNS boolean
 LANGUAGE sql
 STABLE SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
  SELECT EXISTS (
    SELECT 1 FROM profiles
    WHERE id = auth.uid() 
    AND role IN ('Admin', 'Staff')
  );
$function$
;

CREATE OR REPLACE FUNCTION public.reset_project_due_date(project_id_param integer)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  UPDATE projects 
  SET "dueDate" = NOW() + INTERVAL '48 hours'
  WHERE id = project_id_param;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.set_project_due_date_on_insert()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  -- Set dueDate to current time + 48 hours for new projects
  NEW."dueDate" = NOW() + INTERVAL '48 hours';
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.set_project_due_date_on_status_change()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  -- Set due date when project status changes
  IF NEW.status IS DISTINCT FROM OLD.status THEN
    -- Set due date to 30 days from now for new projects
    IF NEW.status = 0 THEN
      NEW."dueDate" := NOW() + INTERVAL '30 days';
    -- Set to 14 days for projects under review
    ELSIF NEW.status = 1 THEN
      NEW."dueDate" := NOW() + INTERVAL '14 days';
    END IF;
  END IF;
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.to_camel_case(snake_case text)
 RETURNS text
 LANGUAGE plpgsql
AS $function$
BEGIN
    RETURN regexp_replace(
        regexp_replace(
            lower(snake_case), 
            '_([a-z])', 
            '\1'
        ),
        '([a-z])([a-z]*)', 
        CASE WHEN snake_case ~ '^[A-Z]' 
            THEN '\U\1\L\2' 
            ELSE '\1\2' 
        END
    );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_ai_knowledge_updated_at()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW."updatedAt" = NOW();
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public."update_cms_pages_updatedAt"()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;$function$
;

CREATE OR REPLACE FUNCTION public.update_contact_submissions_updatedat()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW.updatedAt = NOW();
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_filecheckouts_timestamp()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW."updatedAt" = NOW();
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_missing_due_dates()
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  UPDATE projects 
  SET "dueDate" = "createdAt" + INTERVAL '48 hours'
  WHERE "dueDate" IS NULL AND "createdAt" IS NOT NULL;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_project_punchlist_counts()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Update the project's punchlist counts
    UPDATE projects
    SET 
        "punchlistCount" = (
            SELECT COUNT(*)
            FROM punchlist
            WHERE "projectId" = COALESCE(NEW."projectId", OLD."projectId")
        ),
        "punchlistComplete" = (
            SELECT COUNT(*)
            FROM punchlist
            WHERE "projectId" = COALESCE(NEW."projectId", OLD."projectId")
              AND "markCompleted" = true
        )
    WHERE id = COALESCE(NEW."projectId", OLD."projectId");
    
    RETURN COALESCE(NEW, OLD);
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_punchlist_count()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
BEGIN
    -- Handle INSERT, UPDATE, and DELETE operations
    IF TG_OP = 'INSERT' THEN
        -- New punchlist item added - increment count if not completed
        IF NEW."markCompleted" IS NULL OR NOT NEW."markCompleted" THEN
            UPDATE projects 
            SET "punchlistCount" = COALESCE("punchlistCount", 0) + 1
            WHERE id = NEW."projectId";
        END IF;
        RETURN NEW;
        
    ELSIF TG_OP = 'UPDATE' THEN
        -- Punchlist item updated - adjust count based on markCompleted changes
        IF (OLD."markCompleted" IS NULL OR NOT OLD."markCompleted") != (NEW."markCompleted" IS NULL OR NOT NEW."markCompleted") THEN
            IF NEW."markCompleted" IS NOT NULL AND NEW."markCompleted" THEN
                -- Marked as completed - decrement count
                UPDATE projects 
                SET "punchlistCount" = GREATEST(COALESCE("punchlistCount", 0) - 1, 0)
                WHERE id = NEW."projectId";
            ELSE
                -- Marked as incomplete (including NULL) - increment count
                UPDATE projects 
                SET "punchlistCount" = COALESCE("punchlistCount", 0) + 1
                WHERE id = NEW."projectId";
            END IF;
        END IF;
        RETURN NEW;
        
    ELSIF TG_OP = 'DELETE' THEN
        -- Punchlist item deleted - decrement count if it was incomplete
        IF OLD."markCompleted" IS NULL OR NOT OLD."markCompleted" THEN
            UPDATE projects 
            SET "punchlistCount" = GREATEST(COALESCE("punchlistCount", 0) - 1, 0)
            WHERE id = OLD."projectId";
        END IF;
        RETURN OLD;
    END IF;
    
    RETURN NULL;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_single_project_due_date(project_id_param integer)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  UPDATE projects 
  SET "dueDate" = "createdAt" + INTERVAL '48 hours'
  WHERE id = project_id_param AND "createdAt" IS NOT NULL;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_updated_at_column()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  NEW."updatedAt" = NOW();
  RETURN NEW;
END;
$function$
;


CREATE TRIGGER on_auth_user_created AFTER INSERT ON auth.users FOR EACH ROW EXECUTE FUNCTION handle_new_user();


  create policy "AI chat images are publicly viewable"
  on "storage"."objects"
  as permissive
  for select
  to public
using ((bucket_id = 'ai-chat-images'::text));



  create policy "Anyone can delete contact files"
  on "storage"."objects"
  as permissive
  for delete
  to public
using ((bucket_id = 'contact-files'::text));



  create policy "Anyone can update contact files"
  on "storage"."objects"
  as permissive
  for update
  to public
using ((bucket_id = 'contact-files'::text));



  create policy "Anyone can upload contact files"
  on "storage"."objects"
  as permissive
  for insert
  to public
with check ((bucket_id = 'contact-files'::text));



  create policy "Authenticated users can upload AI chat images"
  on "storage"."objects"
  as permissive
  for insert
  to public
with check (((bucket_id = 'ai-chat-images'::text) AND (auth.role() = 'authenticated'::text)));



  create policy "Authenticated users can upload avatars"
  on "storage"."objects"
  as permissive
  for insert
  to public
with check (((bucket_id = 'project-media'::text) AND (name ~~ 'avatars/%'::text) AND (auth.role() = 'authenticated'::text)));



  create policy "Contact files are publicly accessible"
  on "storage"."objects"
  as permissive
  for select
  to public
using ((bucket_id = 'contact-files'::text));



  create policy "Public avatar access"
  on "storage"."objects"
  as permissive
  for select
  to public
using (((bucket_id = 'project-media'::text) AND (name ~~ 'avatars/%'::text)));



  create policy "Public read access for avatars"
  on "storage"."objects"
  as permissive
  for select
  to public
using ((bucket_id = 'avatars'::text));



  create policy "Users can delete own files"
  on "storage"."objects"
  as permissive
  for delete
  to public
using (((auth.uid())::text = (storage.foldername(name))[1]));



  create policy "Users can delete their own AI chat images"
  on "storage"."objects"
  as permissive
  for delete
  to public
using (((bucket_id = 'ai-chat-images'::text) AND (auth.role() = 'authenticated'::text) AND ((storage.foldername(name))[2] = (auth.uid())::text)));



  create policy "Users can update their own AI chat images"
  on "storage"."objects"
  as permissive
  for update
  to public
using (((bucket_id = 'ai-chat-images'::text) AND (auth.role() = 'authenticated'::text) AND ((storage.foldername(name))[2] = (auth.uid())::text)));



  create policy "Users can update their own avatars"
  on "storage"."objects"
  as permissive
  for update
  to public
using (((bucket_id = 'project-media'::text) AND (name ~~ 'avatars/%'::text) AND (auth.role() = 'authenticated'::text) AND ((name ~~ (('avatars/'::text || (auth.uid())::text) || '.%'::text)) OR (name ~~ (('avatars/'::text || (auth.uid())::text) || '/%'::text)))));



  create policy "Users can upload files"
  on "storage"."objects"
  as permissive
  for insert
  to public
with check (((auth.uid())::text = (storage.foldername(name))[1]));



  create policy "Users can view own files"
  on "storage"."objects"
  as permissive
  for select
  to public
using (((auth.uid())::text = (storage.foldername(name))[1]));



  create policy "project_media_delete"
  on "storage"."objects"
  as permissive
  for delete
  to public
using (((bucket_id = 'project-media'::text) AND (auth.role() = 'authenticated'::text)));



  create policy "project_media_download"
  on "storage"."objects"
  as permissive
  for select
  to public
using (((bucket_id = 'project-media'::text) AND (auth.role() = 'authenticated'::text)));



  create policy "project_media_update"
  on "storage"."objects"
  as permissive
  for update
  to public
using (((bucket_id = 'project-media'::text) AND (auth.role() = 'authenticated'::text)));



  create policy "project_media_upload"
  on "storage"."objects"
  as permissive
  for insert
  to public
with check (((bucket_id = 'project-media'::text) AND (auth.role() = 'authenticated'::text)));


-- Storage triggers commented out as they reference built-in storage functions
-- that are already present in the local Supabase instance
-- CREATE TRIGGER enforce_bucket_name_length_trigger BEFORE INSERT OR UPDATE OF name ON storage.buckets FOR EACH ROW EXECUTE FUNCTION storage.enforce_bucket_name_length();
-- CREATE TRIGGER objects_delete_delete_prefix AFTER DELETE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger();
-- CREATE TRIGGER objects_insert_create_prefix BEFORE INSERT ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.objects_insert_prefix_trigger();
-- CREATE TRIGGER objects_update_create_prefix BEFORE UPDATE ON storage.objects FOR EACH ROW WHEN (((new.name <> old.name) OR (new.bucket_id <> old.bucket_id))) EXECUTE FUNCTION storage.objects_update_prefix_trigger();
-- CREATE TRIGGER update_objects_updated_at BEFORE UPDATE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.update_updated_at_column();
-- CREATE TRIGGER prefixes_create_hierarchy BEFORE INSERT ON storage.prefixes FOR EACH ROW WHEN ((pg_trigger_depth() < 1)) EXECUTE FUNCTION storage.prefixes_insert_trigger();
-- CREATE TRIGGER prefixes_delete_hierarchy AFTER DELETE ON storage.prefixes FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger();


