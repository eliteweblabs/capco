{
  "name": "calcom-web-app",
  "services": [
    {
      "name": "calcom-db",
      "image": "postgres:15-alpine",
      "environment": {
        "POSTGRES_PASSWORD": "${{CALCOM_DB_PASSWORD}}",
        "POSTGRES_USER": "calcom",
        "POSTGRES_DB": "calcom"
      }
    },
    {
      "name": "calcom-app",
      "build": {
        "builder": "NIXPACKS"
      },
      "source": {
        "repo": "calcom/cal.com",
        "branch": "main"
      },
      "environment": {
        "NODE_ENV": "production",
        "DATABASE_URL": "postgres://calcom:${{CALCOM_DB_PASSWORD}}@calcom-db:5432/calcom",
        "NEXTAUTH_URL": "https://${{RAILWAY_PUBLIC_DOMAIN}}",
        "NEXTAUTH_SECRET": "${{CALCOM_NEXTAUTH_SECRET}}",
        "CALENDSO_ENCRYPTION_KEY": "${{CALCOM_ENCRYPTION_KEY}}",
        "NEXT_PUBLIC_WEBAPP_URL": "https://${{RAILWAY_PUBLIC_DOMAIN}}",
        "NEXT_PUBLIC_WEBSITE_URL": "https://${{RAILWAY_PUBLIC_DOMAIN}}",
        "EMAIL_SERVER_HOST": "smtp.resend.com",
        "EMAIL_SERVER_PORT": "587",
        "EMAIL_SERVER_USER": "resend",
        "EMAIL_SERVER_PASSWORD": "${{RESEND_API_KEY}}",
        "EMAIL_FROM": "${{EMAIL_FROM}}",
        "EMAIL_FROM_NAME": "${{EMAIL_FROM_NAME}}"
      },
      "dependsOn": ["calcom-db"],
      "deploy": {
        "startCommand": "npm run start"
      }
    }
  ]
}
